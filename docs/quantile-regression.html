<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter16 Quantile Regression | Quantitative Agricultural Economics</title>
  <meta name="description" content="Chapter16 Quantile Regression | Quantitative Agricultural Economics" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter16 Quantile Regression | Quantitative Agricultural Economics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter16 Quantile Regression | Quantitative Agricultural Economics" />
  
  
  

<meta name="author" content="Raymond L. Tremblay" />


<meta name="date" content="2025-04-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-regression.html"/>
<link rel="next" href="introduction-to-generalized-linear-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">QAE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Daily Activities</a></li>
<li class="chapter" data-level="2" data-path="introduction-to-r-and-posit-rstudio.html"><a href="introduction-to-r-and-posit-rstudio.html"><i class="fa fa-check"></i><b>2</b> Introduction to R and POSIT (RStudio)</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r-and-posit-rstudio.html"><a href="introduction-to-r-and-posit-rstudio.html#what-is-r"><i class="fa fa-check"></i><b>2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r-and-posit-rstudio.html"><a href="introduction-to-r-and-posit-rstudio.html#what-is-rstudio"><i class="fa fa-check"></i><b>2.2</b> What is RStudio?</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r-and-posit-rstudio.html"><a href="introduction-to-r-and-posit-rstudio.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>2.3</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r-and-posit-rstudio.html"><a href="introduction-to-r-and-posit-rstudio.html#getting-started-with-rstudio"><i class="fa fa-check"></i><b>2.4</b> Getting started with RStudio</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r-and-posit-rstudio.html"><a href="introduction-to-r-and-posit-rstudio.html#what-is-rmarkdown"><i class="fa fa-check"></i><b>2.5</b> What is RMarkdown?</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r-and-posit-rstudio.html"><a href="introduction-to-r-and-posit-rstudio.html#creating-an-rstudio-project"><i class="fa fa-check"></i><b>2.6</b> Creating an RStudio project</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r-and-posit-rstudio.html"><a href="introduction-to-r-and-posit-rstudio.html#getting-help-with-r"><i class="fa fa-check"></i><b>2.7</b> Getting help with R</a></li>
<li class="chapter" data-level="2.8" data-path="introduction-to-r-and-posit-rstudio.html"><a href="introduction-to-r-and-posit-rstudio.html#conclusion"><i class="fa fa-check"></i><b>2.8</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="packages-and-functions-in-r.html"><a href="packages-and-functions-in-r.html"><i class="fa fa-check"></i><b>3</b> Packages and Functions in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="packages-and-functions-in-r.html"><a href="packages-and-functions-in-r.html#what-is-an-r-package"><i class="fa fa-check"></i><b>3.1</b> What is an R package?</a></li>
<li class="chapter" data-level="3.2" data-path="packages-and-functions-in-r.html"><a href="packages-and-functions-in-r.html#understanding-packages-in-r"><i class="fa fa-check"></i><b>3.2</b> Understanding packages in R</a></li>
<li class="chapter" data-level="3.3" data-path="packages-and-functions-in-r.html"><a href="packages-and-functions-in-r.html#installing-and-loading-packages"><i class="fa fa-check"></i><b>3.3</b> Installing and loading packages</a></li>
<li class="chapter" data-level="3.4" data-path="packages-and-functions-in-r.html"><a href="packages-and-functions-in-r.html#surfing-the-web-for-packages-and-functions"><i class="fa fa-check"></i><b>3.4</b> Surfing the web for packages and functions</a></li>
<li class="chapter" data-level="3.5" data-path="packages-and-functions-in-r.html"><a href="packages-and-functions-in-r.html#installing-packages-from-github"><i class="fa fa-check"></i><b>3.5</b> Installing packages from github</a></li>
<li class="chapter" data-level="3.6" data-path="packages-and-functions-in-r.html"><a href="packages-and-functions-in-r.html#installing-packages-from-bioconductor"><i class="fa fa-check"></i><b>3.6</b> Installing packages from Bioconductor</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-upload.html"><a href="data-upload.html"><i class="fa fa-check"></i><b>4</b> Data Upload</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-upload.html"><a href="data-upload.html#adding-data-directly-to-the-document"><i class="fa fa-check"></i><b>4.1</b> Adding data directly to the document</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data-upload.html"><a href="data-upload.html#using-the-function-tibble-in-the-package-tibble"><i class="fa fa-check"></i><b>4.1.1</b> Using the function <strong>tibble</strong> in the package <strong>tibble</strong></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-upload.html"><a href="data-upload.html#loading-data-from-a-file"><i class="fa fa-check"></i><b>4.2</b> Loading data from a file</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-upload.html"><a href="data-upload.html#csv-file-uplaod"><i class="fa fa-check"></i><b>4.2.1</b> .csv file uplaod</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-upload.html"><a href="data-upload.html#excel-file-upload"><i class="fa fa-check"></i><b>4.2.2</b> Excel file upload</a></li>
<li class="chapter" data-level="4.2.3" data-path="data-upload.html"><a href="data-upload.html#txt-file"><i class="fa fa-check"></i><b>4.2.3</b> .txt file</a></li>
<li class="chapter" data-level="4.2.4" data-path="data-upload.html"><a href="data-upload.html#spss-file"><i class="fa fa-check"></i><b>4.2.4</b> .spss file</a></li>
<li class="chapter" data-level="4.2.5" data-path="data-upload.html"><a href="data-upload.html#read-a-stata-file"><i class="fa fa-check"></i><b>4.2.5</b> read a Stata file</a></li>
<li class="chapter" data-level="4.2.6" data-path="data-upload.html"><a href="data-upload.html#read-a-sas-file"><i class="fa fa-check"></i><b>4.2.6</b> Read a SAS file</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-upload.html"><a href="data-upload.html#loading-data-from-the-web"><i class="fa fa-check"></i><b>4.3</b> Loading data from the web</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>5</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#cleaning-column-names"><i class="fa fa-check"></i><b>5.1</b> Cleaning column names</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#cleaning-the-names-of-the-variables-with-janitor"><i class="fa fa-check"></i><b>5.1.1</b> Cleaning the names of the variables with <strong>janitor</strong></a></li>
<li class="chapter" data-level="5.1.2" data-path="data-wrangling.html"><a href="data-wrangling.html#now-let-us-clean-the-names-of-the-variables"><i class="fa fa-check"></i><b>5.1.2</b> Now let us clean the names of the variables</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling.html"><a href="data-wrangling.html#changing-the-names-to-variables"><i class="fa fa-check"></i><b>5.2</b> Changing the names to variables</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling.html"><a href="data-wrangling.html#deleting-variables"><i class="fa fa-check"></i><b>5.3</b> Deleting variables</a></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling.html"><a href="data-wrangling.html#changing-names-of-levelsfactors"><i class="fa fa-check"></i><b>5.4</b> Changing names of levels/factors</a></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling.html"><a href="data-wrangling.html#finding-missing-values"><i class="fa fa-check"></i><b>5.5</b> Finding missing values</a></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling.html"><a href="data-wrangling.html#section"><i class="fa fa-check"></i><b>5.6</b> </a></li>
<li class="chapter" data-level="5.7" data-path="data-wrangling.html"><a href="data-wrangling.html#exclude-na-values-from-a-specific-variable-with-drop_na"><i class="fa fa-check"></i><b>5.7</b> Exclude NA values from a specific variable with <strong>drop_na</strong></a></li>
<li class="chapter" data-level="5.8" data-path="data-wrangling.html"><a href="data-wrangling.html#subsetting-data-set"><i class="fa fa-check"></i><b>5.8</b> Subsetting data set</a></li>
<li class="chapter" data-level="5.9" data-path="data-wrangling.html"><a href="data-wrangling.html#titanic-data-set"><i class="fa fa-check"></i><b>5.9</b> Titanic data set</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="data-wrangling.html"><a href="data-wrangling.html#arrange-rows-based-on-a-variable"><i class="fa fa-check"></i><b>5.9.1</b> Arrange rows based on a variable</a></li>
<li class="chapter" data-level="5.9.2" data-path="data-wrangling.html"><a href="data-wrangling.html#mutate-calculate-new-variables-based-on-existing-variables"><i class="fa fa-check"></i><b>5.9.2</b> Mutate: Calculate new variables based on existing variables</a></li>
<li class="chapter" data-level="5.9.3" data-path="data-wrangling.html"><a href="data-wrangling.html#group-data-by-a-variable"><i class="fa fa-check"></i><b>5.9.3</b> Group data by a variable</a></li>
<li class="chapter" data-level="5.9.4" data-path="data-wrangling.html"><a href="data-wrangling.html#group-by-multiple-variables."><i class="fa fa-check"></i><b>5.9.4</b> Group by multiple variables.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html"><i class="fa fa-check"></i><b>6</b> Understanding your file data strutcture</a>
<ul>
<li class="chapter" data-level="6.1" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html#introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html#functions-to-evaluate-your-data"><i class="fa fa-check"></i><b>6.2</b> Functions to evaluate your data</a></li>
<li class="chapter" data-level="6.3" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html#example"><i class="fa fa-check"></i><b>6.3</b> Example</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html#dimensions-of-the-data"><i class="fa fa-check"></i><b>6.3.1</b> Dimensions of the data</a></li>
<li class="chapter" data-level="6.3.2" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html#structure-of-the-data"><i class="fa fa-check"></i><b>6.3.2</b> Structure of the data</a></li>
<li class="chapter" data-level="6.3.3" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html#recoding-variables"><i class="fa fa-check"></i><b>6.3.3</b> Recoding variables</a></li>
<li class="chapter" data-level="6.3.4" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html#levels-of-the-variables"><i class="fa fa-check"></i><b>6.3.4</b> Levels of the variables</a></li>
<li class="chapter" data-level="6.3.5" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html#summary-of-the-data"><i class="fa fa-check"></i><b>6.3.5</b> Summary of the data</a></li>
<li class="chapter" data-level="6.3.6" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html#first-and-last-rows-of-the-data"><i class="fa fa-check"></i><b>6.3.6</b> First and last rows of the data</a></li>
<li class="chapter" data-level="6.3.7" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html#unique-values-of-the-variables"><i class="fa fa-check"></i><b>6.3.7</b> Unique values of the variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html"><i class="fa fa-check"></i><b>7</b> Tests of Normality and Equality of Variance</a>
<ul>
<li class="chapter" data-level="7.1" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#shapiro-wilk-normality-test"><i class="fa fa-check"></i><b>7.1</b> Shapiro-Wilk normality test</a></li>
<li class="chapter" data-level="7.2" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#the-shapiro-francia-normality-test"><i class="fa fa-check"></i><b>7.2</b> The shapiro-Francia normality test</a></li>
<li class="chapter" data-level="7.3" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#anderson-darling-normality-test"><i class="fa fa-check"></i><b>7.3</b> Anderson-Darling normality test</a></li>
<li class="chapter" data-level="7.4" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#cramer-von-mises-test-of-normality"><i class="fa fa-check"></i><b>7.4</b> Cramer-von Mises test of normality</a></li>
<li class="chapter" data-level="7.5" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#lilliefors-test-of-normality"><i class="fa fa-check"></i><b>7.5</b> Lilliefors test of normality</a></li>
<li class="chapter" data-level="7.6" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#visualizing-the-data"><i class="fa fa-check"></i><b>7.6</b> Visualizing the data</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#qq-plot"><i class="fa fa-check"></i><b>7.6.1</b> qq-plot</a></li>
<li class="chapter" data-level="7.6.2" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#histogram"><i class="fa fa-check"></i><b>7.6.2</b> Histogram</a></li>
<li class="chapter" data-level="7.6.3" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#density-plot"><i class="fa fa-check"></i><b>7.6.3</b> Density plot</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#remove-the-outlier-from-the-day1-hygiene-score"><i class="fa fa-check"></i><b>7.7</b> Remove the outlier from the day1 hygiene score</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#what-is-the-variance"><i class="fa fa-check"></i><b>7.7.1</b> What is the variance?</a></li>
<li class="chapter" data-level="7.7.2" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#what-is-the-standard-deviation"><i class="fa fa-check"></i><b>7.7.2</b> What is the standard deviation?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="what-is-the-mode.html"><a href="what-is-the-mode.html"><i class="fa fa-check"></i><b>8</b> What is the mode?</a>
<ul>
<li class="chapter" data-level="8.1" data-path="what-is-the-mode.html"><a href="what-is-the-mode.html#test-of-normality-shapiro-wilks-test"><i class="fa fa-check"></i><b>8.1</b> Test of normality, Shapiro Wilks Test</a></li>
<li class="chapter" data-level="8.2" data-path="what-is-the-mode.html"><a href="what-is-the-mode.html#tests-of-equality-of-variances"><i class="fa fa-check"></i><b>8.2</b> Tests of Equality of variances</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="what-is-the-mode.html"><a href="what-is-the-mode.html#the-f-test-of-equality-of-variance"><i class="fa fa-check"></i><b>8.2.1</b> The F-test of equality of variance</a></li>
<li class="chapter" data-level="8.2.2" data-path="what-is-the-mode.html"><a href="what-is-the-mode.html#bartletts-test-of-equality-of-variance"><i class="fa fa-check"></i><b>8.2.2</b> Bartlett’s test of equality of variance</a></li>
<li class="chapter" data-level="8.2.3" data-path="what-is-the-mode.html"><a href="what-is-the-mode.html#brown-forsythe-test-of-equality-of-variance"><i class="fa fa-check"></i><b>8.2.3</b> Brown-Forsythe test of equality of variance</a></li>
<li class="chapter" data-level="8.2.4" data-path="what-is-the-mode.html"><a href="what-is-the-mode.html#levenes-test-testing-for-assumption-of-normality-among-groups"><i class="fa fa-check"></i><b>8.2.4</b> Levene’s Test: testing for assumption of normality among groups</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html"><i class="fa fa-check"></i><b>9</b> Non-parametric tests</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>9.0.1</b> Wilcoxon signed-rank test</a></li>
<li class="chapter" data-level="9.0.2" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#mann-whitney-u-test"><i class="fa fa-check"></i><b>9.0.2</b> Mann-Whitney U test</a></li>
<li class="chapter" data-level="9.0.3" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#kruskal-wallis-test"><i class="fa fa-check"></i><b>9.0.3</b> Kruskal-Wallis test</a></li>
<li class="chapter" data-level="9.0.4" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#friedman-test"><i class="fa fa-check"></i><b>9.0.4</b> Friedman test</a></li>
<li class="chapter" data-level="9.0.5" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#spearmans-rank-correlation"><i class="fa fa-check"></i><b>9.0.5</b> Spearman’s rank correlation</a></li>
<li class="chapter" data-level="9.0.6" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#kendalls-tau"><i class="fa fa-check"></i><b>9.0.6</b> Kendall’s tau</a></li>
<li class="chapter" data-level="9.1" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#spearman-vs-kendall-correlations-comparison"><i class="fa fa-check"></i><b>9.1</b> Spearman vs Kendall correlations comparison</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#altenative-to-non-parametric-tests"><i class="fa fa-check"></i><b>9.1.1</b> Altenative to non-parametric tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="scatter-plots.html"><a href="scatter-plots.html"><i class="fa fa-check"></i><b>10</b> Scatter Plots</a>
<ul>
<li class="chapter" data-level="10.1" data-path="scatter-plots.html"><a href="scatter-plots.html#basic-scatter-plots"><i class="fa fa-check"></i><b>10.1</b> Basic scatter plots</a></li>
<li class="chapter" data-level="10.2" data-path="scatter-plots.html"><a href="scatter-plots.html#the-lm-function"><i class="fa fa-check"></i><b>10.2</b> the lm() function</a></li>
<li class="chapter" data-level="10.3" data-path="scatter-plots.html"><a href="scatter-plots.html#visualization-of-the-regression"><i class="fa fa-check"></i><b>10.3</b> Visualization of the regression</a></li>
<li class="chapter" data-level="10.4" data-path="scatter-plots.html"><a href="scatter-plots.html#the-impact-of-outliers"><i class="fa fa-check"></i><b>10.4</b> The impact of outliers</a></li>
<li class="chapter" data-level="10.5" data-path="scatter-plots.html"><a href="scatter-plots.html#selling-music-records"><i class="fa fa-check"></i><b>10.5</b> Selling music records</a></li>
<li class="chapter" data-level="10.6" data-path="scatter-plots.html"><a href="scatter-plots.html#linear-regression-assumptions"><i class="fa fa-check"></i><b>10.6</b> Linear Regression Assumptions</a></li>
<li class="chapter" data-level="10.7" data-path="scatter-plots.html"><a href="scatter-plots.html#cooks-distance"><i class="fa fa-check"></i><b>10.7</b> Cook’s Distance</a></li>
<li class="chapter" data-level="10.8" data-path="scatter-plots.html"><a href="scatter-plots.html#steps-to-do-a-linear-regression-analysis"><i class="fa fa-check"></i><b>10.8</b> Steps to do a linear regression analysis</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="scatter-plots.html"><a href="scatter-plots.html#step-1"><i class="fa fa-check"></i><b>10.8.1</b> Step 1</a></li>
<li class="chapter" data-level="10.8.2" data-path="scatter-plots.html"><a href="scatter-plots.html#step-2"><i class="fa fa-check"></i><b>10.8.2</b> Step 2</a></li>
<li class="chapter" data-level="10.8.3" data-path="scatter-plots.html"><a href="scatter-plots.html#step-3"><i class="fa fa-check"></i><b>10.8.3</b> Step 3</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="scatter-plots.html"><a href="scatter-plots.html#alternative-to-graph-the-residuals"><i class="fa fa-check"></i><b>10.9</b> Alternative to Graph the Residuals</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="scatter-plots.html"><a href="scatter-plots.html#plot-the-residuals"><i class="fa fa-check"></i><b>10.9.1</b> Plot the residuals</a></li>
<li class="chapter" data-level="10.9.2" data-path="scatter-plots.html"><a href="scatter-plots.html#exercise-1"><i class="fa fa-check"></i><b>10.9.2</b> Exercise 1</a></li>
<li class="chapter" data-level="10.9.3" data-path="scatter-plots.html"><a href="scatter-plots.html#exercise-2"><i class="fa fa-check"></i><b>10.9.3</b> Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="scatter-plots.html"><a href="scatter-plots.html#scatter-plots-with-jitter"><i class="fa fa-check"></i><b>10.10</b> Scatter plots with jitter</a></li>
<li class="chapter" data-level="10.11" data-path="scatter-plots.html"><a href="scatter-plots.html#scatter-plots-with-marginal-histograms"><i class="fa fa-check"></i><b>10.11</b> Scatter plots with marginal histograms</a></li>
<li class="chapter" data-level="10.12" data-path="scatter-plots.html"><a href="scatter-plots.html#scatter-plots-for-multiple-variables"><i class="fa fa-check"></i><b>10.12</b> Scatter plots for multiple variables</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ring-chart-alternative-to-the-pie-chart.html"><a href="ring-chart-alternative-to-the-pie-chart.html"><i class="fa fa-check"></i><b>11</b> Ring chart (alternative to the pie chart)</a>
<ul>
<li class="chapter" data-level="11.0.1" data-path="ring-chart-alternative-to-the-pie-chart.html"><a href="ring-chart-alternative-to-the-pie-chart.html#adding-values"><i class="fa fa-check"></i><b>11.0.1</b> Adding values</a></li>
<li class="chapter" data-level="11.0.2" data-path="ring-chart-alternative-to-the-pie-chart.html"><a href="ring-chart-alternative-to-the-pie-chart.html#example-of-why-pie-chart-should-not-be-used"><i class="fa fa-check"></i><b>11.0.2</b> Example of why PIE chart should NOT be used</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html"><i class="fa fa-check"></i><b>12</b> Histograms/Density Plots</a>
<ul>
<li class="chapter" data-level="12.1" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#histograms-with-geom_histogram"><i class="fa fa-check"></i><b>12.1</b> Histograms with geom_histogram</a></li>
<li class="chapter" data-level="12.2" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#changing-bin-sizes-with-binwidth"><i class="fa fa-check"></i><b>12.2</b> Changing bin sizes with <em>binwidth</em></a></li>
<li class="chapter" data-level="12.3" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#numbers-of-hospital-beds-per-1000-inhabitants-in-different-countries"><i class="fa fa-check"></i><b>12.3</b> Numbers of hospital beds per 1000 inhabitants in different countries</a></li>
<li class="chapter" data-level="12.4" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#modifying-continuous-scales-with-scale_y_continuous-and-scale_x_continuous"><i class="fa fa-check"></i><b>12.4</b> Modifying continuous scales with scale_y_continuous and scale_x_continuous</a></li>
<li class="chapter" data-level="12.5" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#frequency-and-color-intensity-overlap"><i class="fa fa-check"></i><b>12.5</b> Frequency and color intensity overlap</a></li>
<li class="chapter" data-level="12.6" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#position-the-bars-next-to-each-other-with-the-dodge-function"><i class="fa fa-check"></i><b>12.6</b> Position the bars next to each other with the <strong>dodge</strong> function</a></li>
<li class="chapter" data-level="12.7" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#group-graphics-with-facet_wrap"><i class="fa fa-check"></i><b>12.7</b> Group graphics with <strong>Facet_wrap</strong></a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#change-chart-colors-manually"><i class="fa fa-check"></i><b>12.7.1</b> Change chart colors manually</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#geom_histogram-options-and-parameters"><i class="fa fa-check"></i><b>12.8</b> <strong>geom_histogram</strong> Options and Parameters:</a></li>
<li class="chapter" data-level="12.9" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#densityplots"><i class="fa fa-check"></i><b>12.9</b> DensityPlots</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#area-density-and-line-histogram-plots-with-geom_dotplot-geom_density-and-geom-freqpoly"><i class="fa fa-check"></i><b>12.9.1</b> Area, density and line histogram plots with <strong>geom_dotplot</strong>, <strong>geom_density</strong> and <strong>geom-freqpoly</strong></a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#area-chart-with-geom_area"><i class="fa fa-check"></i><b>12.10</b> Area chart with <strong>geom_area</strong></a>
<ul>
<li class="chapter" data-level="12.10.1" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#area-chart-section"><i class="fa fa-check"></i><b>12.10.1</b> Area Chart Section</a></li>
<li class="chapter" data-level="12.10.2" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#linetype-types"><i class="fa fa-check"></i><b>12.10.2</b> <strong>linetype</strong> types</a></li>
</ul></li>
<li class="chapter" data-level="12.11" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#geom_area-with-multiple-groups"><i class="fa fa-check"></i><b>12.11</b> geom_area with multiple groups</a></li>
<li class="chapter" data-level="12.12" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#the-density-function-aesy..density.."><i class="fa fa-check"></i><b>12.12</b> The density function <strong>aes(y=..density..)</strong></a>
<ul>
<li class="chapter" data-level="12.12.1" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#geom_area-options-and-parameters"><i class="fa fa-check"></i><b>12.12.1</b> <strong>geom_area</strong> Options and Parameters:</a></li>
</ul></li>
<li class="chapter" data-level="12.13" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#density-plot-with-geom_density"><i class="fa fa-check"></i><b>12.13</b> Density plot with <strong>geom_density</strong></a>
<ul>
<li class="chapter" data-level="12.13.1" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#what-is-a-kernel"><i class="fa fa-check"></i><b>12.13.1</b> What is a kernel?</a></li>
</ul></li>
<li class="chapter" data-level="12.14" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#geom_density-and-simulated-data"><i class="fa fa-check"></i><b>12.14</b> geom_density and simulated data</a>
<ul>
<li class="chapter" data-level="12.14.1" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#geom_density-options-and-parameters"><i class="fa fa-check"></i><b>12.14.1</b> <strong>geom_density</strong> Options and Parameters:</a></li>
</ul></li>
<li class="chapter" data-level="12.15" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#polygon-frequency-graph-with-geom_freqpoly"><i class="fa fa-check"></i><b>12.15</b> Polygon frequency graph with <strong>geom_freqpoly</strong></a>
<ul>
<li class="chapter" data-level="12.15.1" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#opciones-y-parametros-de-geom_freqpoly"><i class="fa fa-check"></i><b>12.15.1</b> Opciones y Parametros de <strong>geom_freqpoly</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="boxplots.html"><a href="boxplots.html"><i class="fa fa-check"></i><b>13</b> Boxplots</a>
<ul>
<li class="chapter" data-level="13.1" data-path="boxplots.html"><a href="boxplots.html#boxplot-with-geom_boxplot"><i class="fa fa-check"></i><b>13.1</b> Boxplot with geom_boxplot</a></li>
<li class="chapter" data-level="13.2" data-path="boxplots.html"><a href="boxplots.html#teoretical-boxplot"><i class="fa fa-check"></i><b>13.2</b> Teoretical boxplot</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="boxplots.html"><a href="boxplots.html#change-the-width-of-the-boxes"><i class="fa fa-check"></i><b>13.2.1</b> Change the width of the boxes</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="boxplots.html"><a href="boxplots.html#geom_boxplot-options-and-parameters"><i class="fa fa-check"></i><b>13.3</b> <strong>geom_boxplot</strong> Options and Parameters:</a></li>
<li class="chapter" data-level="13.4" data-path="boxplots.html"><a href="boxplots.html#violin-diagram-with-geom_violin"><i class="fa fa-check"></i><b>13.4</b> Violin diagram with <strong>geom_violin</strong></a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="boxplots.html"><a href="boxplots.html#geom_violin-with-multiple-groups"><i class="fa fa-check"></i><b>13.4.1</b> <strong>Geom_violin</strong> with multiple groups</a></li>
<li class="chapter" data-level="13.4.2" data-path="boxplots.html"><a href="boxplots.html#geom_violin-used-with-geom_point-and-geom_jitter"><i class="fa fa-check"></i><b>13.4.2</b> <strong>Geom_violin</strong> used with <strong>geom_point</strong> and <strong>geom_jitter</strong></a></li>
<li class="chapter" data-level="13.4.3" data-path="boxplots.html"><a href="boxplots.html#geom_jitter-and-geom-overlap"><i class="fa fa-check"></i><b>13.4.3</b> geom_jitter and <strong>geom</strong> overlap</a></li>
<li class="chapter" data-level="13.4.4" data-path="boxplots.html"><a href="boxplots.html#quartiles-and-geom_violin"><i class="fa fa-check"></i><b>13.4.4</b> Quartiles and geom_violin</a></li>
<li class="chapter" data-level="13.4.5" data-path="boxplots.html"><a href="boxplots.html#adding-color-to-the-outline-of-the-violin"><i class="fa fa-check"></i><b>13.4.5</b> Adding color to the outline of the violin</a></li>
<li class="chapter" data-level="13.4.6" data-path="boxplots.html"><a href="boxplots.html#geom_violin-by-category-or-factor"><i class="fa fa-check"></i><b>13.4.6</b> geom_violin by category or factor</a></li>
<li class="chapter" data-level="13.4.7" data-path="boxplots.html"><a href="boxplots.html#geom_violin-in-proportion-to-sample-size"><i class="fa fa-check"></i><b>13.4.7</b> Geom_violin in proportion to sample size</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="boxplots.html"><a href="boxplots.html#geom_violin-not-in-proportion-to-sample-size"><i class="fa fa-check"></i><b>13.5</b> geom_violin not in proportion to sample size</a></li>
<li class="chapter" data-level="13.6" data-path="boxplots.html"><a href="boxplots.html#geom_violin-and-orientation-change"><i class="fa fa-check"></i><b>13.6</b> geom_violin and orientation change</a></li>
<li class="chapter" data-level="13.7" data-path="boxplots.html"><a href="boxplots.html#geom_violin-options-and-parameters"><i class="fa fa-check"></i><b>13.7</b> <strong>geom_violin</strong> Options and Parameters:</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="other-visualizations.html"><a href="other-visualizations.html"><i class="fa fa-check"></i><b>14</b> Other visualizations</a>
<ul>
<li class="chapter" data-level="14.1" data-path="other-visualizations.html"><a href="other-visualizations.html#barplot"><i class="fa fa-check"></i><b>14.1</b> Barplot</a></li>
<li class="chapter" data-level="14.2" data-path="other-visualizations.html"><a href="other-visualizations.html#line-chart"><i class="fa fa-check"></i><b>14.2</b> Line chart</a></li>
<li class="chapter" data-level="14.3" data-path="other-visualizations.html"><a href="other-visualizations.html#heat-map"><i class="fa fa-check"></i><b>14.3</b> Heat map</a></li>
<li class="chapter" data-level="14.4" data-path="other-visualizations.html"><a href="other-visualizations.html#plot-of-mean-and-confidence-intervals"><i class="fa fa-check"></i><b>14.4</b> Plot of mean and confidence intervals</a></li>
<li class="chapter" data-level="14.5" data-path="other-visualizations.html"><a href="other-visualizations.html#major-error-caution"><i class="fa fa-check"></i><b>14.5</b> MAJOR error: CAUTION</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>15</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="15.1" data-path="linear-regression.html"><a href="linear-regression.html#model-of-linear-regression"><i class="fa fa-check"></i><b>15.1</b> Model of linear regression</a></li>
<li class="chapter" data-level="15.2" data-path="linear-regression.html"><a href="linear-regression.html#selling-music-records-1"><i class="fa fa-check"></i><b>15.2</b> Selling music records</a></li>
<li class="chapter" data-level="15.3" data-path="linear-regression.html"><a href="linear-regression.html#cooks-distance-1"><i class="fa fa-check"></i><b>15.3</b> Cook’s Distance</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="quantile-regression.html"><a href="quantile-regression.html"><i class="fa fa-check"></i><b>16</b> Quantile Regression</a>
<ul>
<li class="chapter" data-level="16.1" data-path="quantile-regression.html"><a href="quantile-regression.html#overview"><i class="fa fa-check"></i><b>16.1</b> Overview</a></li>
<li class="chapter" data-level="16.2" data-path="quantile-regression.html"><a href="quantile-regression.html#the-model"><i class="fa fa-check"></i><b>16.2</b> The model</a></li>
<li class="chapter" data-level="16.3" data-path="quantile-regression.html"><a href="quantile-regression.html#the-assumptions-of-quantile-regression"><i class="fa fa-check"></i><b>16.3</b> The assumptions of quantile regression</a></li>
<li class="chapter" data-level="16.4" data-path="quantile-regression.html"><a href="quantile-regression.html#visualization"><i class="fa fa-check"></i><b>16.4</b> Visualization</a></li>
<li class="chapter" data-level="16.5" data-path="quantile-regression.html"><a href="quantile-regression.html#example-quantile-regression-in-r"><i class="fa fa-check"></i><b>16.5</b> Example: Quantile regression in R</a></li>
<li class="chapter" data-level="16.6" data-path="quantile-regression.html"><a href="quantile-regression.html#the-quantile-regression-model-rq"><i class="fa fa-check"></i><b>16.6</b> The quantile regression model, <code>rq()</code></a></li>
<li class="chapter" data-level="16.7" data-path="quantile-regression.html"><a href="quantile-regression.html#nlrq-function"><i class="fa fa-check"></i><b>16.7</b> nlrq() function</a></li>
<li class="chapter" data-level="16.8" data-path="quantile-regression.html"><a href="quantile-regression.html#multivariate-quantile-regression"><i class="fa fa-check"></i><b>16.8</b> Multivariate quantile regression</a></li>
<li class="chapter" data-level="16.9" data-path="quantile-regression.html"><a href="quantile-regression.html#conclusion-1"><i class="fa fa-check"></i><b>16.9</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="introduction-to-generalized-linear-models.html"><a href="introduction-to-generalized-linear-models.html"><i class="fa fa-check"></i><b>17</b> Introduction to Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="17.1" data-path="introduction-to-generalized-linear-models.html"><a href="introduction-to-generalized-linear-models.html#generalized-linear-models-and-distributions"><i class="fa fa-check"></i><b>17.1</b> Generalized Linear models and distributions</a></li>
<li class="chapter" data-level="17.2" data-path="introduction-to-generalized-linear-models.html"><a href="introduction-to-generalized-linear-models.html#when-the-dependent-variable-is-not-linear"><i class="fa fa-check"></i><b>17.2</b> When the dependent variable is not linear</a></li>
<li class="chapter" data-level="17.3" data-path="introduction-to-generalized-linear-models.html"><a href="introduction-to-generalized-linear-models.html#link-available"><i class="fa fa-check"></i><b>17.3</b> Link available</a></li>
<li class="chapter" data-level="17.4" data-path="introduction-to-generalized-linear-models.html"><a href="introduction-to-generalized-linear-models.html#the-assumptions"><i class="fa fa-check"></i><b>17.4</b> The assumptions</a></li>
<li class="chapter" data-level="17.5" data-path="introduction-to-generalized-linear-models.html"><a href="introduction-to-generalized-linear-models.html#the-advantages-of-glm"><i class="fa fa-check"></i><b>17.5</b> The advantages of GLM</a></li>
<li class="chapter" data-level="17.6" data-path="introduction-to-generalized-linear-models.html"><a href="introduction-to-generalized-linear-models.html#binomial-or-bernoulli-models"><i class="fa fa-check"></i><b>17.6</b> Binomial or Bernoulli models</a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="introduction-to-generalized-linear-models.html"><a href="introduction-to-generalized-linear-models.html#gamma-distribution"><i class="fa fa-check"></i><b>17.6.1</b> Gamma Distribution</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="introduction-to-generalized-linear-models.html"><a href="introduction-to-generalized-linear-models.html#the-basic-parameters-of-the-gamma."><i class="fa fa-check"></i><b>17.7</b> The basic parameters of the gamma.</a>
<ul>
<li class="chapter" data-level="17.7.1" data-path="introduction-to-generalized-linear-models.html"><a href="introduction-to-generalized-linear-models.html#the-inverse-gaussian-distribution"><i class="fa fa-check"></i><b>17.7.1</b> The Inverse Gaussian distribution</a></li>
</ul></li>
<li class="chapter" data-level="17.8" data-path="introduction-to-generalized-linear-models.html"><a href="introduction-to-generalized-linear-models.html#evaluating-distributions"><i class="fa fa-check"></i><b>17.8</b> Evaluating distributions</a></li>
<li class="chapter" data-level="17.9" data-path="introduction-to-generalized-linear-models.html"><a href="introduction-to-generalized-linear-models.html#poisson-regression"><i class="fa fa-check"></i><b>17.9</b> Poisson regression</a></li>
<li class="chapter" data-level="17.10" data-path="introduction-to-generalized-linear-models.html"><a href="introduction-to-generalized-linear-models.html#negative-binomial-regression"><i class="fa fa-check"></i><b>17.10</b> Negative binomial regression</a>
<ul>
<li class="chapter" data-level="17.10.1" data-path="introduction-to-generalized-linear-models.html"><a href="introduction-to-generalized-linear-models.html#comparing-dispersion-models"><i class="fa fa-check"></i><b>17.10.1</b> Comparing dispersion models</a></li>
<li class="chapter" data-level="17.10.2" data-path="introduction-to-generalized-linear-models.html"><a href="introduction-to-generalized-linear-models.html#alternative-approach-to-compare-the-poisson-and-the-negative-binomial-model."><i class="fa fa-check"></i><b>17.10.2</b> Alternative approach to compare the Poisson and the negative binomial model.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="binomial_regression.html"><a href="binomial_regression.html"><i class="fa fa-check"></i><b>18</b> Binomial_Regression</a>
<ul>
<li class="chapter" data-level="18.1" data-path="binomial_regression.html"><a href="binomial_regression.html#binomial-regression"><i class="fa fa-check"></i><b>18.1</b> Binomial regression</a></li>
<li class="chapter" data-level="18.2" data-path="binomial_regression.html"><a href="binomial_regression.html#creating-the-binomial-model"><i class="fa fa-check"></i><b>18.2</b> Creating the binomial model</a></li>
<li class="chapter" data-level="18.3" data-path="binomial_regression.html"><a href="binomial_regression.html#second-example-of-logistic-regression"><i class="fa fa-check"></i><b>18.3</b> Second example of logistic regression</a></li>
<li class="chapter" data-level="18.4" data-path="binomial_regression.html"><a href="binomial_regression.html#the-logit-link"><i class="fa fa-check"></i><b>18.4</b> The logit link</a></li>
<li class="chapter" data-level="18.5" data-path="binomial_regression.html"><a href="binomial_regression.html#the-probit-link"><i class="fa fa-check"></i><b>18.5</b> The probit link</a></li>
<li class="chapter" data-level="18.6" data-path="binomial_regression.html"><a href="binomial_regression.html#evaluating-assumptions-of-the-binomial-model"><i class="fa fa-check"></i><b>18.6</b> Evaluating assumptions of the binomial model</a></li>
<li class="chapter" data-level="18.7" data-path="binomial_regression.html"><a href="binomial_regression.html#overdispersion"><i class="fa fa-check"></i><b>18.7</b> Overdispersion</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="poisson-regression-1.html"><a href="poisson-regression-1.html"><i class="fa fa-check"></i><b>19</b> Poisson Regression</a>
<ul>
<li class="chapter" data-level="19.1" data-path="poisson-regression-1.html"><a href="poisson-regression-1.html#visualize-the-data"><i class="fa fa-check"></i><b>19.1</b> Visualize the data</a></li>
<li class="chapter" data-level="19.2" data-path="poisson-regression-1.html"><a href="poisson-regression-1.html#creating-a-poisson-model"><i class="fa fa-check"></i><b>19.2</b> Creating a Poisson model</a></li>
<li class="chapter" data-level="19.3" data-path="poisson-regression-1.html"><a href="poisson-regression-1.html#overdispersion-in-a-poisson-model"><i class="fa fa-check"></i><b>19.3</b> Overdispersion in a Poisson model</a></li>
<li class="chapter" data-level="19.4" data-path="poisson-regression-1.html"><a href="poisson-regression-1.html#negative-binomial-regression-1"><i class="fa fa-check"></i><b>19.4</b> Negative binomial regression</a></li>
<li class="chapter" data-level="19.5" data-path="poisson-regression-1.html"><a href="poisson-regression-1.html#visualization-of-the-negative-binomial-model"><i class="fa fa-check"></i><b>19.5</b> Visualization of the negative binomial model</a></li>
<li class="chapter" data-level="19.6" data-path="poisson-regression-1.html"><a href="poisson-regression-1.html#creating-the-negative-binomial-model"><i class="fa fa-check"></i><b>19.6</b> Creating the negative binomial model</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="poisson-regression-1.html"><a href="poisson-regression-1.html#comparing-dispersion-models-1"><i class="fa fa-check"></i><b>19.6.1</b> Comparing dispersion models</a></li>
<li class="chapter" data-level="19.6.2" data-path="poisson-regression-1.html"><a href="poisson-regression-1.html#alternative-approach-to-compare-the-poisson-and-the-negative-binomial-model.-1"><i class="fa fa-check"></i><b>19.6.2</b> Alternative approach to compare the Poisson and the negative binomial model.</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="poisson-regression-1.html"><a href="poisson-regression-1.html#overlaying-the-poisson-and-the-negative-binomial-models"><i class="fa fa-check"></i><b>19.7</b> Overlaying the Poisson and the Negative binomial models</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="multinomial-logit-analysis.html"><a href="multinomial-logit-analysis.html"><i class="fa fa-check"></i><b>20</b> Multinomial logit analysis</a>
<ul>
<li class="chapter" data-level="20.0.1" data-path="multinomial-logit-analysis.html"><a href="multinomial-logit-analysis.html#load-libraries"><i class="fa fa-check"></i><b>20.0.1</b> Load libraries</a></li>
<li class="chapter" data-level="20.0.2" data-path="multinomial-logit-analysis.html"><a href="multinomial-logit-analysis.html#data"><i class="fa fa-check"></i><b>20.0.2</b> Data</a></li>
<li class="chapter" data-level="20.0.3" data-path="multinomial-logit-analysis.html"><a href="multinomial-logit-analysis.html#model"><i class="fa fa-check"></i><b>20.0.3</b> Model</a></li>
<li class="chapter" data-level="20.0.4" data-path="multinomial-logit-analysis.html"><a href="multinomial-logit-analysis.html#assumptions"><i class="fa fa-check"></i><b>20.0.4</b> Assumptions</a></li>
<li class="chapter" data-level="20.0.5" data-path="multinomial-logit-analysis.html"><a href="multinomial-logit-analysis.html#post-estimation-analysis"><i class="fa fa-check"></i><b>20.0.5</b> Post estimation analysis</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="beta-regression.html"><a href="beta-regression.html"><i class="fa fa-check"></i><b>21</b> Beta Regression</a>
<ul>
<li class="chapter" data-level="21.1" data-path="beta-regression.html"><a href="beta-regression.html#what-is-a-beta-regression"><i class="fa fa-check"></i><b>21.1</b> What is a beta regression?</a></li>
<li class="chapter" data-level="21.2" data-path="beta-regression.html"><a href="beta-regression.html#what-is-the-problem-with-the-data"><i class="fa fa-check"></i><b>21.2</b> What is the problem with the data?</a></li>
<li class="chapter" data-level="21.3" data-path="beta-regression.html"><a href="beta-regression.html#first-step-what-is-a-beta-distribution"><i class="fa fa-check"></i><b>21.3</b> First step, what is a beta distribution?</a></li>
<li class="chapter" data-level="21.4" data-path="beta-regression.html"><a href="beta-regression.html#wikipedia"><i class="fa fa-check"></i><b>21.4</b> Wikipedia</a></li>
<li class="chapter" data-level="21.5" data-path="beta-regression.html"><a href="beta-regression.html#proportion-of-smokers-in-different-countries"><i class="fa fa-check"></i><b>21.5</b> Proportion of smokers in different countries</a></li>
<li class="chapter" data-level="21.6" data-path="beta-regression.html"><a href="beta-regression.html#convert-the-mean-and-variance-into-shape-alpha-and-beta"><i class="fa fa-check"></i><b>21.6</b> Convert the mean and variance into shape <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span></a></li>
<li class="chapter" data-level="21.7" data-path="beta-regression.html"><a href="beta-regression.html#visualization-of-the-distribution-with-ci."><i class="fa fa-check"></i><b>21.7</b> Visualization of the distribution with CI.</a></li>
<li class="chapter" data-level="21.8" data-path="beta-regression.html"><a href="beta-regression.html#regression-model"><i class="fa fa-check"></i><b>21.8</b> Regression model</a></li>
<li class="chapter" data-level="21.9" data-path="beta-regression.html"><a href="beta-regression.html#regresión-beta-proporción-de-frutos-por-cantidad-de-flores"><i class="fa fa-check"></i><b>21.9</b> Regresión beta, proporción de frutos por cantidad de flores</a></li>
<li class="chapter" data-level="21.10" data-path="beta-regression.html"><a href="beta-regression.html#visualize-the-beta-regression"><i class="fa fa-check"></i><b>21.10</b> Visualize the beta regression</a></li>
<li class="chapter" data-level="21.11" data-path="beta-regression.html"><a href="beta-regression.html#compare-the-traditional-linear-model-versus-a-beta-model"><i class="fa fa-check"></i><b>21.11</b> Compare the traditional linear model versus a beta model</a></li>
<li class="chapter" data-level="21.12" data-path="beta-regression.html"><a href="beta-regression.html#distribution-of-specific-values"><i class="fa fa-check"></i><b>21.12</b> Distribution of specific values</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="auto-regressive-vectorial-analysis.html"><a href="auto-regressive-vectorial-analysis.html"><i class="fa fa-check"></i><b>22</b> Auto Regressive Vectorial Analysis</a></li>
<li class="chapter" data-level="23" data-path="chi-square-testcontingency-tables.html"><a href="chi-square-testcontingency-tables.html"><i class="fa fa-check"></i><b>23</b> Chi-square test/Contingency tables</a>
<ul>
<li class="chapter" data-level="23.1" data-path="chi-square-testcontingency-tables.html"><a href="chi-square-testcontingency-tables.html#count-data"><i class="fa fa-check"></i><b>23.1</b> Count data</a></li>
<li class="chapter" data-level="23.2" data-path="chi-square-testcontingency-tables.html"><a href="chi-square-testcontingency-tables.html#chi-square-test"><i class="fa fa-check"></i><b>23.2</b> Chi-square test</a></li>
<li class="chapter" data-level="23.3" data-path="chi-square-testcontingency-tables.html"><a href="chi-square-testcontingency-tables.html#contingency-tables"><i class="fa fa-check"></i><b>23.3</b> Contingency tables</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative Agricultural Economics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="quantile-regression" class="section level1 hasAnchor" number="16">
<h1><span class="header-section-number">Chapter16</span> Quantile Regression<a href="quantile-regression.html#quantile-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Quantile regression is a specialized regression technique that estimates the conditional median or other quantiles of a response variable. It is particularly useful when the response variable is not normally distributed or when the relationship between the response variable and the predictor variables is not linear or there is heteroscedasticity.</p>
<p>Quantile regression was first developed by Koenker and Bassett (1978) and Bassett and Koenker (1978) and has since been widely used in a variety of fields, including economics, finance, and epidemiology. This approach is particularly useful when the conditional distribution of the response variable is asymmetric or when the relationship between the response variable and the predictor variables varies across different quantiles. In other words it is a robust regression technique that is not sensitive to outliers and can provide a more complete picture of the relationship between the response variable and the predictor variables.</p>
<p>In this chapter, we will provide an overview of quantile regression, discuss its advantages and disadvantages, and demonstrate how to perform quantile regression in R using the <code>quantreg</code> package.</p>
<div id="overview" class="section level2 hasAnchor" number="16.1">
<h2><span class="header-section-number">16.1</span> Overview<a href="quantile-regression.html#overview" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Quantile regression is a regression technique that estimates the conditional quantiles of a response variable given a set of predictor variables. Unlike ordinary least squares (OLS) regression, which estimates the conditional mean of the response variable, quantile regression estimates the conditional quantiles, such as the median, 25th percentile, or 75th percentile. By estimating the conditional quantiles, quantile regression provides a more complete picture of the relationship between the response variable and the predictor variables, allowing for a more nuanced analysis of the data.</p>
</div>
<div id="the-model" class="section level2 hasAnchor" number="16.2">
<h2><span class="header-section-number">16.2</span> The model<a href="quantile-regression.html#the-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The quantile regression model can be written as:</p>
<p><span class="math display">\[Q_{\tau}(Y|X) = X\beta_{\tau}\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(Q_{\tau}(Y|X)\)</span> is the <span class="math inline">\(\tau\)</span>-th quantile of the response variable <span class="math inline">\(Y\)</span> given the predictor variables <span class="math inline">\(X\)</span>,</li>
<li><span class="math inline">\(\beta_{\tau}\)</span> is the vector of coefficients for the predictor variables,</li>
<li><span class="math inline">\(\tau\)</span> is the quantile level, which ranges from 0 to 1.</li>
</ul>
<p>The goal of quantile regression is to estimate the coefficients <span class="math inline">\(\beta_{\tau}\)</span> that minimize the sum of the absolute deviations between the observed values of the response variable and the estimated quantiles.</p>
<p>Quantile regression can be performed for multiple quantile levels, allowing for a more comprehensive analysis of the relationship between the response variable and the predictor variables.</p>
</div>
<div id="the-assumptions-of-quantile-regression" class="section level2 hasAnchor" number="16.3">
<h2><span class="header-section-number">16.3</span> The assumptions of quantile regression<a href="quantile-regression.html#the-assumptions-of-quantile-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Quantile regression does not make the same assumptions as OLS regression, such as linearity, homoscedasticity, and normality of residuals. Instead, quantile regression estimates the conditional quantiles of the response variable directly, making it more robust to violations of these assumptions.</p>
<p>However, quantile regression does assume that the errors are independent and identically distributed (i.i.d.), which is a common assumption in regression analysis.</p>
</div>
<div id="visualization" class="section level2 hasAnchor" number="16.4">
<h2><span class="header-section-number">16.4</span> Visualization<a href="quantile-regression.html#visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To visualize the results of quantile regression, we can create quantile regression plots, which show the estimated quantiles of the response variable as a function of the predictor variables. These plots provide a visual representation of the relationship between the response variable and the predictor variables at different quantile levels.</p>
<p>In the following example, we will demonstrate how to perform quantile regression in R using the <code>quantreg</code> package and create quantile regression plots to visualize the results.</p>
</div>
<div id="example-quantile-regression-in-r" class="section level2 hasAnchor" number="16.5">
<h2><span class="header-section-number">16.5</span> Example: Quantile regression in R<a href="quantile-regression.html#example-quantile-regression-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this example, we will use the <code>quantreg</code> package to perform quantile regression on the <code>mtcars</code> dataset, which contains information about various car models. We will estimate the conditional quantiles of the miles per gallon (mpg) variable given the weight (wt) variable.</p>
<p>First, we will load the <code>quantreg</code> package and the <code>mtcars</code> dataset:</p>
<p><a href="https://ggplot2.tidyverse.org/reference/geom_quantile.html" class="uri">https://ggplot2.tidyverse.org/reference/geom_quantile.html</a></p>
<p>Usamos un conjunto de datos de ejemplo llamado mtcars, que contiene información sobre diferentes modelos de automóviles. En particular, nos interesa la relación entre el desplasamiento (displ) del motor en litros y la cantidad de milas por galon . Para visualizar esta relación, ajustaremos un modelo de regresión cuantílica y trazaremos las estimaciones de los cuantiles condicionales de mpg en función de wt. El data frame mpg contiene se encuentra el el paquete ggplot2 las siguientes variables:</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="quantile-regression.html#cb414-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb414-2"><a href="quantile-regression.html#cb414-2" tabindex="-1"></a><span class="fu">library</span>(quantreg)</span></code></pre></div>
<pre><code>## Loading required package: SparseM</code></pre>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="quantile-regression.html#cb416-1" tabindex="-1"></a><span class="fu">data</span>(mpg)</span>
<span id="cb416-2"><a href="quantile-regression.html#cb416-2" tabindex="-1"></a></span>
<span id="cb416-3"><a href="quantile-regression.html#cb416-3" tabindex="-1"></a></span>
<span id="cb416-4"><a href="quantile-regression.html#cb416-4" tabindex="-1"></a></span>
<span id="cb416-5"><a href="quantile-regression.html#cb416-5" tabindex="-1"></a><span class="fu">head</span>(mpg) <span class="co">#visualizar las primeras filas del data frame</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 11
##   manufacturer model displ  year   cyl trans      drv     cty   hwy fl    class 
##   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; 
## 1 audi         a4      1.8  1999     4 auto(l5)   f        18    29 p     compa…
## 2 audi         a4      1.8  1999     4 manual(m5) f        21    29 p     compa…
## 3 audi         a4      2    2008     4 manual(m6) f        20    31 p     compa…
## 4 audi         a4      2    2008     4 auto(av)   f        21    30 p     compa…
## 5 audi         a4      2.8  1999     6 auto(l5)   f        16    26 p     compa…
## 6 audi         a4      2.8  1999     6 manual(m5) f        18    26 p     compa…</code></pre>
<p>Note that the pattern of dispersion increases as the engine displacement increases. This suggests that the relationship between engine displacement and miles per gallon is not linear and that the variance of mpg increases with engine displacement. To capture this non-linear relationship and heteroscedasticity, we will fit a quantile regression model and plot the conditional quantile estimates of mpg as a function of wt.</p>
<p>The linear regression (in red) is added to the plot with its confidence interval (shaded grey) and the quantiles of the quantile regression (in blue). Note that the quantile regression captures the non-linear relationship between displ and mpg and the heteroscedasticity in the errors, while the linear regression does not.</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="quantile-regression.html#cb418-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> <span class="dv">1</span><span class="sc">/</span>hwy)) <span class="sc">+</span></span>
<span id="cb418-2"><a href="quantile-regression.html#cb418-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb418-3"><a href="quantile-regression.html#cb418-3" tabindex="-1"></a>  <span class="fu">geom_quantile</span>()<span class="sc">+</span></span>
<span id="cb418-4"><a href="quantile-regression.html#cb418-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## Smoothing formula not specified. Using: y ~ x
## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="Quantitative-Agricultural-Economics_files/figure-html/qr_2-1.png" width="672" /></p>
<p>Adding quantiles to the plot</p>
<p>In this figure we add only the quantile 0.5, which corresponds to the median of the conditional distribution of mpg given wt.</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="quantile-regression.html#cb420-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> <span class="dv">1</span><span class="sc">/</span>hwy)) <span class="sc">+</span></span>
<span id="cb420-2"><a href="quantile-regression.html#cb420-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb420-3"><a href="quantile-regression.html#cb420-3" tabindex="-1"></a>  <span class="fu">geom_quantile</span>(<span class="at">quantiles =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<pre><code>## Smoothing formula not specified. Using: y ~ x</code></pre>
<p><img src="Quantitative-Agricultural-Economics_files/figure-html/qr_3-1.png" width="672" /></p>
<p>Adding multiples quantiles</p>
<p>Using multiple quantiles one clearly see the relationship between the predictor and the response variable and the quantiles are not equally dispersed. The median quantile is in blue, while the 25th and 75th are in red. Note that the quantiles are not equally dispersed around the median, which suggests that the relationship between displ and mpg is not linear and that the variance of mpg increases with displ.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="quantile-regression.html#cb422-1" tabindex="-1"></a>q5 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="at">by=</span><span class="fl">0.05</span>) <span class="co">#quantile levels in steps of 5. </span></span>
<span id="cb422-2"><a href="quantile-regression.html#cb422-2" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> <span class="dv">1</span><span class="sc">/</span>hwy)) <span class="sc">+</span></span>
<span id="cb422-3"><a href="quantile-regression.html#cb422-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb422-4"><a href="quantile-regression.html#cb422-4" tabindex="-1"></a>  <span class="fu">geom_quantile</span>(<span class="at">quantiles =</span> q5, <span class="at">colour =</span> <span class="st">&quot;grey&quot;</span>)<span class="sc">+</span></span>
<span id="cb422-5"><a href="quantile-regression.html#cb422-5" tabindex="-1"></a>  <span class="fu">geom_quantile</span>(<span class="at">quantiles =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb422-6"><a href="quantile-regression.html#cb422-6" tabindex="-1"></a>  <span class="fu">geom_quantile</span>(<span class="at">quantiles =</span> <span class="fl">0.25</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb422-7"><a href="quantile-regression.html#cb422-7" tabindex="-1"></a>  <span class="fu">geom_quantile</span>(<span class="at">quantiles =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="Quantitative-Agricultural-Economics_files/figure-html/qr_4-1.png" width="672" /></p>
</div>
<div id="the-quantile-regression-model-rq" class="section level2 hasAnchor" number="16.6">
<h2><span class="header-section-number">16.6</span> The quantile regression model, <code>rq()</code><a href="quantile-regression.html#the-quantile-regression-model-rq" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To ajust a quantile regression model, we use the <code>rq()</code> function from the <code>quantreg</code> package. The <code>rq()</code> function takes two main arguments: the formula that specifies the model and the data frame that contains the data. In this case, we will fit a quantile regression model to estimate the median of mpg given wt.</p>
<p>tau = 0.5 specifies the quantile we want to estimate, in this case, the median of the conditional distribution of mpg given wt.</p>
<p>The interpretation of the quantile regression model is similar to that of a linear regression model, but instead of estimating the conditional mean of the response variable, we estimate the specified conditional quantile.</p>
<p>In this case, the quantile regression model estimates the median of mpg given wt has a coefficient of 0.0076, which suggests that for every one-unit increase in displ, the median of 1/hwy increases by 0.0076. The p-value associated with the coefficient is less than 0.05, indicating that the coefficient is significantly different from zero.</p>
<p>The summary of the quantile regression model also provides the standard error, t-value, and p-value for the coefficient, as well as the residual standard error and the number of observations used in the model.</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="quantile-regression.html#cb423-1" tabindex="-1"></a><span class="co"># djusting a quantile regression model</span></span>
<span id="cb423-2"><a href="quantile-regression.html#cb423-2" tabindex="-1"></a></span>
<span id="cb423-3"><a href="quantile-regression.html#cb423-3" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">rq</span>(<span class="dv">1</span><span class="sc">/</span>hwy <span class="sc">~</span> displ, <span class="at">data =</span> mpg, <span class="at">tau =</span> <span class="fl">0.5</span>)</span>
<span id="cb423-4"><a href="quantile-regression.html#cb423-4" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## Warning in rq.fit.br(x, y, tau = tau, ci = TRUE, ...): Solution may be
## nonunique</code></pre>
<pre><code>## 
## Call: rq(formula = 1/hwy ~ displ, tau = 0.5, data = mpg)
## 
## tau: [1] 0.5
## 
## Coefficients:
##             coefficients lower bd upper bd
## (Intercept) 0.01927      0.01610  0.02099 
## displ       0.00761      0.00664  0.00874</code></pre>
<hr />
</div>
<div id="nlrq-function" class="section level2 hasAnchor" number="16.7">
<h2><span class="header-section-number">16.7</span> nlrq() function<a href="quantile-regression.html#nlrq-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To model with this function, you need to install the <code>quantreg</code> package and load it into the R session.</p>
<p>nlrq() is a function that fits a non-linear quantile regression model. This function takes two main arguments: the formula that specifies the model and the data frame that contains the data. In this case, we will fit a non-linear quantile regression model to estimate the median of mpg given wt. the advantage is that we can calcylate the quantiles of the conditional distribution of mpg given wt for a series of x values and visualize bteer the dispersion.</p>
<p>Nice pattern, but not realistic of a biological data set.</p>
<p>SSlogis = Self-Starting Nls Logistic Model</p>
<p>This is used to fit a logistic curve to data. The curve is defined as:</p>
<p><span class="math display">\[f(x) = \frac{Asym}{1 + exp((x-mid)/scal)}\]</span></p>
<p>where:</p>
<ul>
<li>Asym is the asymptote of the curve,</li>
<li>mid is the x-value at the inflection point of the curve,</li>
<li>scal is a scaling parameter that determines the steepness of the curve.</li>
</ul>
<p>In this example, we will use the SSlogis function to generate a logistic curve with Asym = 10, mid = 12, and scal = 2, and add some random noise to the data. We will then fit a non-linear least squares regression to the data using the nls function, and compare the results to a quantile regression using the nlrq function.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="quantile-regression.html#cb426-1" tabindex="-1"></a>Dat <span class="ot">&lt;-</span> <span class="cn">NULL</span>; Dat<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">20</span>)</span>
<span id="cb426-2"><a href="quantile-regression.html#cb426-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb426-3"><a href="quantile-regression.html#cb426-3" tabindex="-1"></a>Dat<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">SSlogis</span>(Dat<span class="sc">$</span>x, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">2</span>)<span class="sc">*</span><span class="fu">rnorm</span>(<span class="dv">500</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)</span>
<span id="cb426-4"><a href="quantile-regression.html#cb426-4" tabindex="-1"></a><span class="fu">plot</span>(Dat)</span>
<span id="cb426-5"><a href="quantile-regression.html#cb426-5" tabindex="-1"></a><span class="co"># fit first a nonlinear least-square regression</span></span>
<span id="cb426-6"><a href="quantile-regression.html#cb426-6" tabindex="-1"></a>Dat.nls <span class="ot">&lt;-</span> <span class="fu">nls</span>(y <span class="sc">~</span> <span class="fu">SSlogis</span>(x, Asym, mid, scal), <span class="at">data=</span>Dat); Dat.nls</span></code></pre></div>
<pre><code>## Nonlinear regression model
##   model: y ~ SSlogis(x, Asym, mid, scal)
##    data: Dat
##   Asym    mid   scal 
##  9.968 11.947  1.962 
##  residual sum-of-squares: 241.8
## 
## Number of iterations to convergence: 0 
## Achieved convergence tolerance: 6.921e-07</code></pre>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="quantile-regression.html#cb428-1" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>, <span class="fu">predict</span>(Dat.nls, <span class="at">newdata=</span><span class="fu">list</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>)), <span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb428-2"><a href="quantile-regression.html#cb428-2" tabindex="-1"></a><span class="co"># then fit the median using nlrq</span></span>
<span id="cb428-3"><a href="quantile-regression.html#cb428-3" tabindex="-1"></a>Dat.nlrq <span class="ot">&lt;-</span> <span class="fu">nlrq</span>(y <span class="sc">~</span> <span class="fu">SSlogis</span>(x, Asym, mid, scal), <span class="at">data=</span>Dat, <span class="at">tau=</span><span class="fl">0.5</span>, <span class="at">trace=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 109.059 :   9.968027 11.947208  1.962113 
## final  value 108.942725 
## converged
## lambda = 1 
## 108.9427 :   9.958648 11.943273  1.967144 
## final  value 108.490939 
## converged
## lambda = 0.9750984 
## 108.4909 :   9.949430 11.987472  1.998607 
## final  value 108.471416 
## converged
## lambda = 0.9999299 
## 108.4714 :   9.94163 11.99077  1.99344 
## final  value 108.471243 
## converged
## lambda = 1 
## 108.4712 :   9.941008 11.990550  1.992921 
## final  value 108.470935 
## stopped after 4 iterations
## lambda = 0.8621249 
## 108.4709 :   9.942734 11.992773  1.993209 
## final  value 108.470923 
## converged
## lambda = 0.9999613 
## 108.4709 :   9.942629 11.992728  1.993136 
## final  value 108.470919 
## converged
## lambda = 1 
## 108.4709 :   9.942644 11.992737  1.993144 
## final  value 108.470919 
## converged
## lambda = 1 
## 108.4709 :   9.942644 11.992737  1.993144 
## final  value 108.470919 
## converged
## lambda = 1 
## 108.4709 :   9.942644 11.992737  1.993144</code></pre>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="quantile-regression.html#cb430-1" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>, <span class="fu">predict</span>(Dat.nlrq, <span class="at">newdata=</span><span class="fu">list</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>)), <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb430-2"><a href="quantile-regression.html#cb430-2" tabindex="-1"></a><span class="co"># the 1st and 3rd quartiles regressions</span></span>
<span id="cb430-3"><a href="quantile-regression.html#cb430-3" tabindex="-1"></a>Dat.nlrq <span class="ot">&lt;-</span> <span class="fu">nlrq</span>(y <span class="sc">~</span> <span class="fu">SSlogis</span>(x, Asym, mid, scal), <span class="at">data=</span>Dat, <span class="at">tau=</span><span class="fl">0.25</span>, <span class="at">trace=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 108.6656 :   9.968027 11.947208  1.962113 
## final  value 89.108243 
## converged
## lambda = 1 
## 89.10824 :   9.432250 11.803924  1.923472 
## final  value 85.688895 
## converged
## lambda = 1 
## 85.6889 :   9.183598 11.794244  1.929699 
## final  value 85.473712 
## converged
## lambda = 0.6405076 
## 85.47371 :   9.212527 11.844090  1.938003 
## final  value 85.447786 
## converged
## lambda = 1 
## 85.44779 :   9.234097 11.863975  1.949241 
## final  value 85.446407 
## converged
## lambda = 1 
## 85.44641 :   9.242009 11.866644  1.954192 
## final  value 85.445691 
## converged
## lambda = 1 
## 85.44569 :   9.234247 11.864554  1.952338 
## final  value 85.444920 
## converged
## lambda = 1 
## 85.44492 :   9.232975 11.863979  1.953587 
## final  value 85.443854 
## converged
## lambda = 0.363237 
## 85.44385 :   9.233661 11.864280  1.957197 
## final  value 85.443668 
## stopped after 3 iterations
## lambda = 0.8495473 
## 85.44367 :   9.233453 11.860020  1.957831 
## final  value 85.443667 
## converged
## lambda = 0.008522445 
## 85.44367 :   9.233449 11.860007  1.957814 
## final  value 85.443584 
## converged
## lambda = 1 
## 85.44358 :   9.232996 11.859020  1.955928 
## final  value 85.443586 
## converged
## lambda = 0.9999957 
## 85.44359 :   9.232995 11.859024  1.955916</code></pre>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="quantile-regression.html#cb432-1" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>, <span class="fu">predict</span>(Dat.nlrq, <span class="at">newdata=</span><span class="fu">list</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>)), <span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb432-2"><a href="quantile-regression.html#cb432-2" tabindex="-1"></a>Dat.nlrq <span class="ot">&lt;-</span> <span class="fu">nlrq</span>(y <span class="sc">~</span> <span class="fu">SSlogis</span>(x, Asym, mid, scal), <span class="at">data=</span>Dat, <span class="at">tau=</span><span class="fl">0.75</span>, <span class="at">trace=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 109.4525 :   9.968027 11.947208  1.962113 
## final  value 89.561436 
## converged
## lambda = 1 
## 89.56144 :  10.64021 12.13202  2.02044 
## final  value 87.302043 
## converged
## lambda = 1 
## 87.30204 :  10.652294 11.966018  1.958371 
## final  value 87.200715 
## converged
## lambda = 1 
## 87.20072 :  10.666754 11.953497  1.962447 
## final  value 87.131462 
## converged
## lambda = 0.8659451 
## 87.13146 :  10.639094 11.949236  1.971242 
## final  value 87.125795 
## converged
## lambda = 0.6273927 
## 87.1258 :  10.647784 11.962635  1.975851 
## final  value 87.122717 
## converged
## lambda = 0.8041119 
## 87.12272 :  10.647957 11.963190  1.973657 
## final  value 87.121592 
## converged
## lambda = 1 
## 87.12159 :  10.649877 11.962363  1.973516 
## final  value 87.121427 
## converged
## lambda = 1 
## 87.12143 :  10.649051 11.961685  1.973086 
## final  value 87.121355 
## converged
## lambda = 0.5468903 
## 87.12135 :  10.648209 11.961208  1.972643 
## final  value 87.121400 
## converged
## lambda = 0.9999045 
## 87.1214 :  10.648073 11.961122  1.972568</code></pre>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="quantile-regression.html#cb434-1" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>, <span class="fu">predict</span>(Dat.nlrq, <span class="at">newdata=</span><span class="fu">list</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>)), <span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb434-2"><a href="quantile-regression.html#cb434-2" tabindex="-1"></a><span class="co"># and finally &quot;external envelopes&quot; holding 95 percent of the data</span></span>
<span id="cb434-3"><a href="quantile-regression.html#cb434-3" tabindex="-1"></a>Dat.nlrq <span class="ot">&lt;-</span> <span class="fu">nlrq</span>(y <span class="sc">~</span> <span class="fu">SSlogis</span>(x, Asym, mid, scal), <span class="at">data=</span>Dat, <span class="at">tau=</span><span class="fl">0.025</span>, <span class="at">trace=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 108.3114 :   9.968027 11.947208  1.962113 
## final  value 62.166616 
## converged
## lambda = 1 
## 62.16662 :   9.432250 11.803924  1.923472 
## final  value 16.887325 
## converged
## lambda = 1 
## 16.88732 :   8.006640 11.718631  1.979243 
## final  value 15.823276 
## converged
## lambda = 0.7133884 
## 15.82328 :   8.135460 12.048708  1.987995 
## final  value 15.732737 
## stopped after 3 iterations
## lambda = 0.7726586 
## 15.73274 :   8.042059 12.019442  1.994386 
## final  value 15.732737 
## converged
## lambda = 0 
## 15.73274 :   8.042059 12.019442  1.994386</code></pre>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="quantile-regression.html#cb436-1" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>, <span class="fu">predict</span>(Dat.nlrq, <span class="at">newdata=</span><span class="fu">list</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>)), <span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb436-2"><a href="quantile-regression.html#cb436-2" tabindex="-1"></a>Dat.nlrq <span class="ot">&lt;-</span> <span class="fu">nlrq</span>(y <span class="sc">~</span> <span class="fu">SSlogis</span>(x, Asym, mid, scal), <span class="at">data=</span>Dat, <span class="at">tau=</span><span class="fl">0.975</span>, <span class="at">trace=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 109.8066 :   9.968027 11.947208  1.962113 
## final  value 56.575819 
## converged
## lambda = 1 
## 56.57582 :  10.672415 12.148657  2.027285 
## final  value 20.551829 
## converged
## lambda = 1 
## 20.55183 :  11.923558 12.366710  2.121476 
## final  value 17.268734 
## converged
## lambda = 1 
## 17.26873 :  12.266850 12.051876  2.060768 
## final  value 17.194623 
## converged
## lambda = 0.5512476 
## 17.19462 :  12.176373 12.020546  2.003537 
## final  value 17.175845 
## converged
## lambda = 0.900139 
## 17.17585 :  12.180837 12.005129  2.019783 
## final  value 17.175761 
## converged
## lambda = 0.1504766 
## 17.17576 :  12.177202 12.003960  2.011709 
## final  value 17.175612 
## converged
## lambda = 1 
## 17.17561 :  12.18154 12.00534  2.01894 
## final  value 17.175603 
## converged
## lambda = 1 
## 17.1756 :  12.181679 12.005403  2.019175 
## final  value 17.175518 
## converged
## lambda = 1 
## 17.17552 :  12.17954 12.00469  2.01453 
## final  value 17.175518 
## converged
## lambda = 0 
## 17.17552 :  12.17954 12.00469  2.01453</code></pre>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="quantile-regression.html#cb438-1" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>, <span class="fu">predict</span>(Dat.nlrq, <span class="at">newdata=</span><span class="fu">list</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>)), <span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb438-2"><a href="quantile-regression.html#cb438-2" tabindex="-1"></a>leg <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;least squares&quot;</span>,<span class="st">&quot;median (0.5)&quot;</span>,<span class="st">&quot;quartiles (0.25/0.75)&quot;</span>,<span class="st">&quot;.95 band (0.025/0.975)&quot;</span>)</span>
<span id="cb438-3"><a href="quantile-regression.html#cb438-3" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">1</span>, <span class="fl">12.5</span>, <span class="at">legend=</span>leg, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="Quantitative-Agricultural-Economics_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<p><a href="https://stackoverflow.com/questions/51223379/how-get-plot-from-nlrq-in-r" class="uri">https://stackoverflow.com/questions/51223379/how-get-plot-from-nlrq-in-r</a></p>
<p>Need a better data set.</p>
<p>To adjust a non-linear quantile regression model, we use the <code>nlrq()</code> function from the <code>quantreg</code> package. The <code>nlrq()</code> function takes two main arguments: the formula that specifies the model and the data frame that contains the data. In this case, we will fit a non-linear quantile regression model to estimate the median of mpg given wt.</p>
<p>The formula specifies the model, which in this case is a non-linear model that estimates the conditional median of mpg given wt using the SSlogis function. The SSlogis function is a self-starting logistic model that defines a logistic curve with three parameters: Asym, mid, and scal.</p>
<p>The <code>tau</code> argument specifies the quantile level we want to estimate, in this case, the median of the conditional distribution of mpg given wt.</p>
<ul>
<li><code>Asym</code> refers to the asymptote of the curve,</li>
<li><code>mid</code> is the x-value at the inflection point of the curve,</li>
<li><code>scal</code> is a scaling parameter that determines the steepness of the curve.</li>
</ul>
<p>The summary of the non-linear quantile regression model provides the estimated coefficients for the parameters Asym, mid, and scal, as well as the standard errors, t-values, and p-values for the coefficients. The residual standard error and the number of observations used in the model are also provided.</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="quantile-regression.html#cb439-1" tabindex="-1"></a><span class="co"># Adjusting a non-linear quantile regression model</span></span>
<span id="cb439-2"><a href="quantile-regression.html#cb439-2" tabindex="-1"></a></span>
<span id="cb439-3"><a href="quantile-regression.html#cb439-3" tabindex="-1"></a>model_nlrq <span class="ot">&lt;-</span> <span class="fu">nlrq</span>(<span class="dv">1</span><span class="sc">/</span>hwy <span class="sc">~</span> <span class="fu">SSlogis</span>(displ, Asym, mid, scal), <span class="at">data =</span> mpg, <span class="at">tau=</span><span class="fl">0.5</span>)</span>
<span id="cb439-4"><a href="quantile-regression.html#cb439-4" tabindex="-1"></a></span>
<span id="cb439-5"><a href="quantile-regression.html#cb439-5" tabindex="-1"></a><span class="fu">summary</span>(model_nlrq)</span></code></pre></div>
<pre><code>## 
## Call: nlrq(formula = 1/hwy ~ SSlogis(displ, Asym, mid, scal), data = mpg, 
##     tau = 0.5, control = list(maxiter = 100, k = 2, InitialStepSize = 1, 
##         big = 1e+20, eps = 1e-07, beta = 0.97), trace = FALSE)
## 
## tau: [1] 0.5
## 
## Coefficients:
##      Value   Std. Error t value Pr(&gt;|t|)
## Asym 0.07233 0.01221    5.92518 0.00000 
## mid  2.20424 0.74844    2.94513 0.00356 
## scal 2.18291 0.69912    3.12238 0.00202</code></pre>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="quantile-regression.html#cb441-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">/</span>hwy <span class="sc">~</span> displ, mpg)</span>
<span id="cb441-2"><a href="quantile-regression.html#cb441-2" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">fitted</span>(model_nlrq) <span class="sc">~</span> displ, mpg)</span></code></pre></div>
<p><img src="Quantitative-Agricultural-Economics_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
</div>
<div id="multivariate-quantile-regression" class="section level2 hasAnchor" number="16.8">
<h2><span class="header-section-number">16.8</span> Multivariate quantile regression<a href="quantile-regression.html#multivariate-quantile-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the previous examples, we estimated the conditional quantiles of the response variable given a single predictor variable. However, quantile regression can be extended to include multiple predictor variables, allowing for a more comprehensive analysis of the relationship between the response variable and the predictor variables.</p>
<p>In this example, we will fit a multivariate quantile regression model to estimate the median of mpg given wt and hp. The formula specifies the model, which includes both wt and hp as predictor variables. The <code>tau</code> argument specifies the quantile level we want to estimate, in this case, the median of the conditional distribution of mpg given wt and hp.</p>
<p>The summary of the multivariate quantile regression model provides the estimated coefficients for the predictor variables wt and hp, as well as the standard errors, t-values, and p-values for the coefficients. The residual standard error and the number of observations used in the model are also provided.</p>
<p>Here is another function to evaluate a mutiple quantile regression model and their confidence intervals.</p>
<p><a href="https://www.rdocumentation.org/packages/ggstatsplot/versions/0.6.5" class="uri">https://www.rdocumentation.org/packages/ggstatsplot/versions/0.6.5</a></p>
<p>See also</p>
<p><a href="https://broom.tidymodels.org/reference/augment.nlrq.html" class="uri">https://broom.tidymodels.org/reference/augment.nlrq.html</a></p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="quantile-regression.html#cb442-1" tabindex="-1"></a><span class="fu">library</span>(quantreg)</span>
<span id="cb442-2"><a href="quantile-regression.html#cb442-2" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot)</span></code></pre></div>
<pre><code>## You can cite this package as:
##      Patil, I. (2021). Visualizations with statistical details: The &#39;ggstatsplot&#39; approach.
##      Journal of Open Source Software, 6(61), 3167, doi:10.21105/joss.03167</code></pre>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="quantile-regression.html#cb444-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb444-2"><a href="quantile-regression.html#cb444-2" tabindex="-1"></a>mod <span class="ot">&lt;-</span> quantreg<span class="sc">::</span><span class="fu">rq</span>(<span class="at">formula =</span> mpg <span class="sc">~</span> am <span class="sc">*</span> cyl<span class="dv">-1</span>, <span class="at">data =</span> mtcars)</span>
<span id="cb444-3"><a href="quantile-regression.html#cb444-3" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code></pre></div>
<pre><code>## Warning in rq.fit.br(x, y, tau = tau, ci = TRUE, ...): Solution may be
## nonunique</code></pre>
<pre><code>## 
## Call: quantreg::rq(formula = mpg ~ am * cyl - 1, data = mtcars)
## 
## tau: [1] 0.5
## 
## Coefficients:
##        coefficients lower bd upper bd
## am     39.60000     36.10924 52.74217
## cyl     2.05000      1.83548  2.37127
## am:cyl -5.12500     -7.25166 -4.51242</code></pre>
<p>To visualize the results of the multivariate quantile regression model, we can use the <code>ggcoefstats()</code> function from the <code>ggstatsplot</code> package. This function creates a plot that displays the estimated coefficients for the predictor variables, along with their confidence intervals and p-values.</p>
<p>The plot shows the estimated coefficients for the predictor variables wt and hp, as well as their confidence intervals and p-values. The confidence intervals provide a range of values within which we can be confident that the true coefficient lies, while the p-values indicate whether the coefficient is significantly different from zero.</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="quantile-regression.html#cb447-1" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb447-2"><a href="quantile-regression.html#cb447-2" tabindex="-1"></a>ggstatsplot<span class="sc">::</span><span class="fu">ggcoefstats</span>(mod)</span></code></pre></div>
<pre><code>## Warning in rq.fit.br(x, y, tau = tau, ci = TRUE, ...): Solution may be
## nonunique</code></pre>
<p><img src="Quantitative-Agricultural-Economics_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
</div>
<div id="conclusion-1" class="section level2 hasAnchor" number="16.9">
<h2><span class="header-section-number">16.9</span> Conclusion<a href="quantile-regression.html#conclusion-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Quantile regression is a powerful regression technique that estimates the conditional quantiles of a response variable given a set of predictor variables. It is particularly useful when the response variable is not normally distributed or when the relationship between the response variable and the predictor variables is not linear or there is heteroscedasticity.</p>
<p>The relationship still does assume some type of linear model, but it is more robust to outliers and can provide a more complete picture of the relationship between the response variable and the predictor variables. By estimating the conditional quantiles, quantile regression allows for a more nuanced analysis of the data and can provide valuable insights into the relationship between the response variable and the predictor variables.</p>
<p>If model is expected to be non-linear maybe a LOESS regression is more appropriate.</p>
<p>References:</p>
<p>Koenker, Roger, and Gilbert Bassett Jr. “Regression quantiles.” Econometrica: journal of the Econometric Society (1978): 33-50.</p>
<p>Bassett, G., &amp; Koenker, R. (1978). Asymptotic Theory of Least Absolute Error Regression. Journal of the American Statistical Association, 73(363), 618–622. <a href="https://doi.org/10.1080/01621459.1978.10480065" class="uri">https://doi.org/10.1080/01621459.1978.10480065</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduction-to-generalized-linear-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/RaymondLTremblay/Quantitative_Agricultural_Economics/edit/main/15-Quantile_Regression.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/RaymondLTremblay/Quantitative_Agricultural_Economics/blob/main/15-Quantile_Regression.Rmd",
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
