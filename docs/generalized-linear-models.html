<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 Generalized Linear Models | Quantitative Agricultural Economics</title>
  <meta name="description" content="Chapter 16 Generalized Linear Models | Quantitative Agricultural Economics" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 Generalized Linear Models | Quantitative Agricultural Economics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 Generalized Linear Models | Quantitative Agricultural Economics" />
  
  
  

<meta name="author" content="Raymond L. Tremblay" />


<meta name="date" content="2025-03-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="quantile-regression.html"/>
<link rel="next" href="multinomial-logit-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">QAE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Daily Activities</a></li>
<li class="chapter" data-level="2" data-path="introduction-to-r-and-posit-rstudio.html"><a href="introduction-to-r-and-posit-rstudio.html"><i class="fa fa-check"></i><b>2</b> Introduction to R and POSIT (RStudio)</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r-and-posit-rstudio.html"><a href="introduction-to-r-and-posit-rstudio.html#what-is-r"><i class="fa fa-check"></i><b>2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r-and-posit-rstudio.html"><a href="introduction-to-r-and-posit-rstudio.html#what-is-rstudio"><i class="fa fa-check"></i><b>2.2</b> What is RStudio?</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r-and-posit-rstudio.html"><a href="introduction-to-r-and-posit-rstudio.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>2.3</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r-and-posit-rstudio.html"><a href="introduction-to-r-and-posit-rstudio.html#getting-started-with-rstudio"><i class="fa fa-check"></i><b>2.4</b> Getting started with RStudio</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r-and-posit-rstudio.html"><a href="introduction-to-r-and-posit-rstudio.html#what-is-rmarkdown"><i class="fa fa-check"></i><b>2.5</b> What is RMarkdown?</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r-and-posit-rstudio.html"><a href="introduction-to-r-and-posit-rstudio.html#creating-an-rstudio-project"><i class="fa fa-check"></i><b>2.6</b> Creating an RStudio project</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r-and-posit-rstudio.html"><a href="introduction-to-r-and-posit-rstudio.html#getting-help-with-r"><i class="fa fa-check"></i><b>2.7</b> Getting help with R</a></li>
<li class="chapter" data-level="2.8" data-path="introduction-to-r-and-posit-rstudio.html"><a href="introduction-to-r-and-posit-rstudio.html#conclusion"><i class="fa fa-check"></i><b>2.8</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="packages-and-functions-in-r.html"><a href="packages-and-functions-in-r.html"><i class="fa fa-check"></i><b>3</b> Packages and Functions in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="packages-and-functions-in-r.html"><a href="packages-and-functions-in-r.html#what-is-an-r-package"><i class="fa fa-check"></i><b>3.1</b> What is an R package?</a></li>
<li class="chapter" data-level="3.2" data-path="packages-and-functions-in-r.html"><a href="packages-and-functions-in-r.html#understanding-packages-in-r"><i class="fa fa-check"></i><b>3.2</b> Understanding packages in R</a></li>
<li class="chapter" data-level="3.3" data-path="packages-and-functions-in-r.html"><a href="packages-and-functions-in-r.html#installing-and-loading-packages"><i class="fa fa-check"></i><b>3.3</b> Installing and loading packages</a></li>
<li class="chapter" data-level="3.4" data-path="packages-and-functions-in-r.html"><a href="packages-and-functions-in-r.html#surfing-the-web-for-packages-and-functions"><i class="fa fa-check"></i><b>3.4</b> Surfing the web for packages and functions</a></li>
<li class="chapter" data-level="3.5" data-path="packages-and-functions-in-r.html"><a href="packages-and-functions-in-r.html#installing-packages-from-github"><i class="fa fa-check"></i><b>3.5</b> Installing packages from github</a></li>
<li class="chapter" data-level="3.6" data-path="packages-and-functions-in-r.html"><a href="packages-and-functions-in-r.html#installing-packages-from-bioconductor"><i class="fa fa-check"></i><b>3.6</b> Installing packages from Bioconductor</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-upload.html"><a href="data-upload.html"><i class="fa fa-check"></i><b>4</b> Data Upload</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-upload.html"><a href="data-upload.html#adding-data-directly-to-the-document"><i class="fa fa-check"></i><b>4.1</b> Adding data directly to the document</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data-upload.html"><a href="data-upload.html#using-the-function-tibble-in-the-package-tibble"><i class="fa fa-check"></i><b>4.1.1</b> Using the function <strong>tibble</strong> in the package <strong>tibble</strong></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-upload.html"><a href="data-upload.html#loading-data-from-a-file"><i class="fa fa-check"></i><b>4.2</b> Loading data from a file</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-upload.html"><a href="data-upload.html#csv-file-uplaod"><i class="fa fa-check"></i><b>4.2.1</b> .csv file uplaod</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-upload.html"><a href="data-upload.html#excel-file-upload"><i class="fa fa-check"></i><b>4.2.2</b> Excel file upload</a></li>
<li class="chapter" data-level="4.2.3" data-path="data-upload.html"><a href="data-upload.html#txt-file"><i class="fa fa-check"></i><b>4.2.3</b> .txt file</a></li>
<li class="chapter" data-level="4.2.4" data-path="data-upload.html"><a href="data-upload.html#spss-file"><i class="fa fa-check"></i><b>4.2.4</b> .spss file</a></li>
<li class="chapter" data-level="4.2.5" data-path="data-upload.html"><a href="data-upload.html#read-a-stata-file"><i class="fa fa-check"></i><b>4.2.5</b> read a Stata file</a></li>
<li class="chapter" data-level="4.2.6" data-path="data-upload.html"><a href="data-upload.html#read-a-sas-file"><i class="fa fa-check"></i><b>4.2.6</b> Read a SAS file</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-upload.html"><a href="data-upload.html#loading-data-from-the-web"><i class="fa fa-check"></i><b>4.3</b> Loading data from the web</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>5</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#cleaning-column-names"><i class="fa fa-check"></i><b>5.1</b> Cleaning column names</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#cleaning-the-names-of-the-variables-with-janitor"><i class="fa fa-check"></i><b>5.1.1</b> Cleaning the names of the variables with <strong>janitor</strong></a></li>
<li class="chapter" data-level="5.1.2" data-path="data-wrangling.html"><a href="data-wrangling.html#now-let-us-clean-the-names-of-the-variables"><i class="fa fa-check"></i><b>5.1.2</b> Now let us clean the names of the variables</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling.html"><a href="data-wrangling.html#changing-the-names-to-variables"><i class="fa fa-check"></i><b>5.2</b> Changing the names to variables</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling.html"><a href="data-wrangling.html#deleting-variables"><i class="fa fa-check"></i><b>5.3</b> Deleting variables</a></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling.html"><a href="data-wrangling.html#changing-names-of-levelsfactors"><i class="fa fa-check"></i><b>5.4</b> Changing names of levels/factors</a></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling.html"><a href="data-wrangling.html#finding-missing-values"><i class="fa fa-check"></i><b>5.5</b> Finding missing values</a></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling.html"><a href="data-wrangling.html#section"><i class="fa fa-check"></i><b>5.6</b> </a></li>
<li class="chapter" data-level="5.7" data-path="data-wrangling.html"><a href="data-wrangling.html#exclude-na-values-from-a-specific-variable-with-drop_na"><i class="fa fa-check"></i><b>5.7</b> Exclude NA values from a specific variable with <strong>drop_na</strong></a></li>
<li class="chapter" data-level="5.8" data-path="data-wrangling.html"><a href="data-wrangling.html#subsetting-data-set"><i class="fa fa-check"></i><b>5.8</b> Subsetting data set</a></li>
<li class="chapter" data-level="5.9" data-path="data-wrangling.html"><a href="data-wrangling.html#titanic-data-set"><i class="fa fa-check"></i><b>5.9</b> Titanic data set</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="data-wrangling.html"><a href="data-wrangling.html#arrange-rows-based-on-a-variable"><i class="fa fa-check"></i><b>5.9.1</b> Arrange rows based on a variable</a></li>
<li class="chapter" data-level="5.9.2" data-path="data-wrangling.html"><a href="data-wrangling.html#mutate-calculate-new-variables-based-on-existing-variables"><i class="fa fa-check"></i><b>5.9.2</b> Mutate: Calculate new variables based on existing variables</a></li>
<li class="chapter" data-level="5.9.3" data-path="data-wrangling.html"><a href="data-wrangling.html#group-data-by-a-variable"><i class="fa fa-check"></i><b>5.9.3</b> Group data by a variable</a></li>
<li class="chapter" data-level="5.9.4" data-path="data-wrangling.html"><a href="data-wrangling.html#group-by-multiple-variables."><i class="fa fa-check"></i><b>5.9.4</b> Group by multiple variables.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html"><i class="fa fa-check"></i><b>6</b> Understanding your file data strutcture</a>
<ul>
<li class="chapter" data-level="6.1" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html#introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html#functions-to-evaluate-your-data"><i class="fa fa-check"></i><b>6.2</b> Functions to evaluate your data</a></li>
<li class="chapter" data-level="6.3" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html#example"><i class="fa fa-check"></i><b>6.3</b> Example</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html#dimensions-of-the-data"><i class="fa fa-check"></i><b>6.3.1</b> Dimensions of the data</a></li>
<li class="chapter" data-level="6.3.2" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html#structure-of-the-data"><i class="fa fa-check"></i><b>6.3.2</b> Structure of the data</a></li>
<li class="chapter" data-level="6.3.3" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html#recoding-variables"><i class="fa fa-check"></i><b>6.3.3</b> Recoding variables</a></li>
<li class="chapter" data-level="6.3.4" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html#levels-of-the-variables"><i class="fa fa-check"></i><b>6.3.4</b> Levels of the variables</a></li>
<li class="chapter" data-level="6.3.5" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html#summary-of-the-data"><i class="fa fa-check"></i><b>6.3.5</b> Summary of the data</a></li>
<li class="chapter" data-level="6.3.6" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html#first-and-last-rows-of-the-data"><i class="fa fa-check"></i><b>6.3.6</b> First and last rows of the data</a></li>
<li class="chapter" data-level="6.3.7" data-path="understanding-your-file-data-strutcture.html"><a href="understanding-your-file-data-strutcture.html#unique-values-of-the-variables"><i class="fa fa-check"></i><b>6.3.7</b> Unique values of the variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html"><i class="fa fa-check"></i><b>7</b> Tests of Normality and Equality of Variance</a>
<ul>
<li class="chapter" data-level="7.1" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#shapiro-wilk-normality-test"><i class="fa fa-check"></i><b>7.1</b> Shapiro-Wilk normality test</a></li>
<li class="chapter" data-level="7.2" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#the-shapiro-francia-normality-test"><i class="fa fa-check"></i><b>7.2</b> The shapiro-Francia normality test</a></li>
<li class="chapter" data-level="7.3" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#anderson-darling-normality-test"><i class="fa fa-check"></i><b>7.3</b> Anderson-Darling normality test</a></li>
<li class="chapter" data-level="7.4" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#cramer-von-mises-test-of-normality"><i class="fa fa-check"></i><b>7.4</b> Cramer-von Mises test of normality</a></li>
<li class="chapter" data-level="7.5" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#lilliefors-test-of-normality"><i class="fa fa-check"></i><b>7.5</b> Lilliefors test of normality</a></li>
<li class="chapter" data-level="7.6" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#visualizing-the-data"><i class="fa fa-check"></i><b>7.6</b> Visualizing the data</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#qq-plot"><i class="fa fa-check"></i><b>7.6.1</b> qq-plot</a></li>
<li class="chapter" data-level="7.6.2" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#histogram"><i class="fa fa-check"></i><b>7.6.2</b> Histogram</a></li>
<li class="chapter" data-level="7.6.3" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#density-plot"><i class="fa fa-check"></i><b>7.6.3</b> Density plot</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#remove-the-outlier-from-the-day1-hygiene-score"><i class="fa fa-check"></i><b>7.7</b> Remove the outlier from the day1 hygiene score</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#what-is-the-variance"><i class="fa fa-check"></i><b>7.7.1</b> What is the variance?</a></li>
<li class="chapter" data-level="7.7.2" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#what-is-the-standard-deviation"><i class="fa fa-check"></i><b>7.7.2</b> What is the standard deviation?</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#test-of-normality-shapiro-wilks-test"><i class="fa fa-check"></i><b>7.8</b> Test of normality, Shapiro Wilks Test</a></li>
<li class="chapter" data-level="7.9" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#tests-of-equality-of-variances"><i class="fa fa-check"></i><b>7.9</b> Tests of Equality of variances</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#the-f-test-of-equality-of-variance"><i class="fa fa-check"></i><b>7.9.1</b> The F-test of equality of variance</a></li>
<li class="chapter" data-level="7.9.2" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#bartletts-test-of-equality-of-variance"><i class="fa fa-check"></i><b>7.9.2</b> Bartlett’s test of equality of variance</a></li>
<li class="chapter" data-level="7.9.3" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#brown-forsythe-test-of-equality-of-variance"><i class="fa fa-check"></i><b>7.9.3</b> Brown-Forsythe test of equality of variance</a></li>
<li class="chapter" data-level="7.9.4" data-path="tests-of-normality-and-equality-of-variance.html"><a href="tests-of-normality-and-equality-of-variance.html#levenes-test-testing-for-assumption-of-normality-among-groups"><i class="fa fa-check"></i><b>7.9.4</b> Levene’s Test: testing for assumption of normality among groups</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html"><i class="fa fa-check"></i><b>8</b> Non-parametric tests</a>
<ul>
<li class="chapter" data-level="8.0.1" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>8.0.1</b> Wilcoxon signed-rank test</a></li>
<li class="chapter" data-level="8.0.2" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#mann-whitney-u-test"><i class="fa fa-check"></i><b>8.0.2</b> Mann-Whitney U test</a></li>
<li class="chapter" data-level="8.0.3" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#kruskal-wallis-test"><i class="fa fa-check"></i><b>8.0.3</b> Kruskal-Wallis test</a></li>
<li class="chapter" data-level="8.0.4" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#friedman-test"><i class="fa fa-check"></i><b>8.0.4</b> Friedman test</a></li>
<li class="chapter" data-level="8.0.5" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#spearmans-rank-correlation"><i class="fa fa-check"></i><b>8.0.5</b> Spearman’s rank correlation</a></li>
<li class="chapter" data-level="8.0.6" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#kendalls-tau"><i class="fa fa-check"></i><b>8.0.6</b> Kendall’s tau</a></li>
<li class="chapter" data-level="8.1" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#spearman-vs-kendall-correlations-comparison"><i class="fa fa-check"></i><b>8.1</b> Spearman vs Kendall correlations comparison</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#altenative-to-non-parametric-tests"><i class="fa fa-check"></i><b>8.1.1</b> Altenative to non-parametric tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="scatter-plots.html"><a href="scatter-plots.html"><i class="fa fa-check"></i><b>9</b> Scatter Plots</a>
<ul>
<li class="chapter" data-level="9.1" data-path="scatter-plots.html"><a href="scatter-plots.html#basic-scatter-plots"><i class="fa fa-check"></i><b>9.1</b> Basic scatter plots</a></li>
<li class="chapter" data-level="9.2" data-path="scatter-plots.html"><a href="scatter-plots.html#the-lm-function"><i class="fa fa-check"></i><b>9.2</b> the lm() function</a></li>
<li class="chapter" data-level="9.3" data-path="scatter-plots.html"><a href="scatter-plots.html#visualization-of-the-regression"><i class="fa fa-check"></i><b>9.3</b> Visualization of the regression</a></li>
<li class="chapter" data-level="9.4" data-path="scatter-plots.html"><a href="scatter-plots.html#the-impact-of-outliers"><i class="fa fa-check"></i><b>9.4</b> The impact of outliers</a></li>
<li class="chapter" data-level="9.5" data-path="scatter-plots.html"><a href="scatter-plots.html#selling-music-records"><i class="fa fa-check"></i><b>9.5</b> Selling music records</a></li>
<li class="chapter" data-level="9.6" data-path="scatter-plots.html"><a href="scatter-plots.html#linear-regression-assumptions"><i class="fa fa-check"></i><b>9.6</b> Linear Regression Assumptions</a></li>
<li class="chapter" data-level="9.7" data-path="scatter-plots.html"><a href="scatter-plots.html#cooks-distance"><i class="fa fa-check"></i><b>9.7</b> Cook’s Distance</a></li>
<li class="chapter" data-level="9.8" data-path="scatter-plots.html"><a href="scatter-plots.html#steps-to-do-a-linear-regression-analysis"><i class="fa fa-check"></i><b>9.8</b> Steps to do a linear regression analysis</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="scatter-plots.html"><a href="scatter-plots.html#step-1"><i class="fa fa-check"></i><b>9.8.1</b> Step 1</a></li>
<li class="chapter" data-level="9.8.2" data-path="scatter-plots.html"><a href="scatter-plots.html#step-2"><i class="fa fa-check"></i><b>9.8.2</b> Step 2</a></li>
<li class="chapter" data-level="9.8.3" data-path="scatter-plots.html"><a href="scatter-plots.html#step-3"><i class="fa fa-check"></i><b>9.8.3</b> Step 3</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="scatter-plots.html"><a href="scatter-plots.html#alternative-to-graph-the-residuals"><i class="fa fa-check"></i><b>9.9</b> Alternative to Graph the Residuals</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="scatter-plots.html"><a href="scatter-plots.html#plot-the-residuals"><i class="fa fa-check"></i><b>9.9.1</b> Plot the residuals</a></li>
<li class="chapter" data-level="9.9.2" data-path="scatter-plots.html"><a href="scatter-plots.html#exercise-1"><i class="fa fa-check"></i><b>9.9.2</b> Exercise 1</a></li>
<li class="chapter" data-level="9.9.3" data-path="scatter-plots.html"><a href="scatter-plots.html#exercise-2"><i class="fa fa-check"></i><b>9.9.3</b> Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="scatter-plots.html"><a href="scatter-plots.html#scatter-plots-with-jitter"><i class="fa fa-check"></i><b>9.10</b> Scatter plots with jitter</a></li>
<li class="chapter" data-level="9.11" data-path="scatter-plots.html"><a href="scatter-plots.html#scatter-plots-with-marginal-histograms"><i class="fa fa-check"></i><b>9.11</b> Scatter plots with marginal histograms</a></li>
<li class="chapter" data-level="9.12" data-path="scatter-plots.html"><a href="scatter-plots.html#scatter-plots-for-multiple-variables"><i class="fa fa-check"></i><b>9.12</b> Scatter plots for multiple variables</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ring-chart-alternative-to-the-pie-chart.html"><a href="ring-chart-alternative-to-the-pie-chart.html"><i class="fa fa-check"></i><b>10</b> Ring chart (alternative to the pie chart)</a>
<ul>
<li class="chapter" data-level="10.0.1" data-path="ring-chart-alternative-to-the-pie-chart.html"><a href="ring-chart-alternative-to-the-pie-chart.html#adding-values"><i class="fa fa-check"></i><b>10.0.1</b> Adding values</a></li>
<li class="chapter" data-level="10.0.2" data-path="ring-chart-alternative-to-the-pie-chart.html"><a href="ring-chart-alternative-to-the-pie-chart.html#example-of-why-pie-chart-should-not-be-used"><i class="fa fa-check"></i><b>10.0.2</b> Example of why PIE chart should NOT be used</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html"><i class="fa fa-check"></i><b>11</b> Histograms/Density Plots</a>
<ul>
<li class="chapter" data-level="11.1" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#histograms-with-geom_histogram"><i class="fa fa-check"></i><b>11.1</b> Histograms with geom_histogram</a></li>
<li class="chapter" data-level="11.2" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#changing-bin-sizes-with-binwidth"><i class="fa fa-check"></i><b>11.2</b> Changing bin sizes with <em>binwidth</em></a></li>
<li class="chapter" data-level="11.3" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#numbers-of-hospital-beds-per-1000-inhabitants-in-different-countries"><i class="fa fa-check"></i><b>11.3</b> Numbers of hospital beds per 1000 inhabitants in different countries</a></li>
<li class="chapter" data-level="11.4" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#modifying-continuous-scales-with-scale_y_continuous-and-scale_x_continuous"><i class="fa fa-check"></i><b>11.4</b> Modifying continuous scales with scale_y_continuous and scale_x_continuous</a></li>
<li class="chapter" data-level="11.5" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#frequency-and-color-intensity-overlap"><i class="fa fa-check"></i><b>11.5</b> Frequency and color intensity overlap</a></li>
<li class="chapter" data-level="11.6" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#position-the-bars-next-to-each-other-with-the-dodge-function"><i class="fa fa-check"></i><b>11.6</b> Position the bars next to each other with the <strong>dodge</strong> function</a></li>
<li class="chapter" data-level="11.7" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#group-graphics-with-facet_wrap"><i class="fa fa-check"></i><b>11.7</b> Group graphics with <strong>Facet_wrap</strong></a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#change-chart-colors-manually"><i class="fa fa-check"></i><b>11.7.1</b> Change chart colors manually</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#geom_histogram-options-and-parameters"><i class="fa fa-check"></i><b>11.8</b> <strong>geom_histogram</strong> Options and Parameters:</a></li>
<li class="chapter" data-level="11.9" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#densityplots"><i class="fa fa-check"></i><b>11.9</b> DensityPlots</a>
<ul>
<li class="chapter" data-level="11.9.1" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#area-density-and-line-histogram-plots-with-geom_dotplot-geom_density-and-geom-freqpoly"><i class="fa fa-check"></i><b>11.9.1</b> Area, density and line histogram plots with <strong>geom_dotplot</strong>, <strong>geom_density</strong> and <strong>geom-freqpoly</strong></a></li>
</ul></li>
<li class="chapter" data-level="11.10" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#area-chart-with-geom_area"><i class="fa fa-check"></i><b>11.10</b> Area chart with <strong>geom_area</strong></a>
<ul>
<li class="chapter" data-level="11.10.1" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#area-chart-section"><i class="fa fa-check"></i><b>11.10.1</b> Area Chart Section</a></li>
<li class="chapter" data-level="11.10.2" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#linetype-types"><i class="fa fa-check"></i><b>11.10.2</b> <strong>linetype</strong> types</a></li>
</ul></li>
<li class="chapter" data-level="11.11" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#geom_area-with-multiple-groups"><i class="fa fa-check"></i><b>11.11</b> geom_area with multiple groups</a></li>
<li class="chapter" data-level="11.12" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#the-density-function-aesy..density.."><i class="fa fa-check"></i><b>11.12</b> The density function <strong>aes(y=..density..)</strong></a>
<ul>
<li class="chapter" data-level="11.12.1" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#geom_area-options-and-parameters"><i class="fa fa-check"></i><b>11.12.1</b> <strong>geom_area</strong> Options and Parameters:</a></li>
</ul></li>
<li class="chapter" data-level="11.13" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#density-plot-with-geom_density"><i class="fa fa-check"></i><b>11.13</b> Density plot with <strong>geom_density</strong></a>
<ul>
<li class="chapter" data-level="11.13.1" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#what-is-a-kernel"><i class="fa fa-check"></i><b>11.13.1</b> What is a kernel?</a></li>
</ul></li>
<li class="chapter" data-level="11.14" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#geom_density-and-simulated-data"><i class="fa fa-check"></i><b>11.14</b> geom_density and simulated data</a>
<ul>
<li class="chapter" data-level="11.14.1" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#geom_density-options-and-parameters"><i class="fa fa-check"></i><b>11.14.1</b> <strong>geom_density</strong> Options and Parameters:</a></li>
</ul></li>
<li class="chapter" data-level="11.15" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#polygon-frequency-graph-with-geom_freqpoly"><i class="fa fa-check"></i><b>11.15</b> Polygon frequency graph with <strong>geom_freqpoly</strong></a>
<ul>
<li class="chapter" data-level="11.15.1" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html#opciones-y-parametros-de-geom_freqpoly"><i class="fa fa-check"></i><b>11.15.1</b> Opciones y Parametros de <strong>geom_freqpoly</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="boxplots.html"><a href="boxplots.html"><i class="fa fa-check"></i><b>12</b> Boxplots</a>
<ul>
<li class="chapter" data-level="12.1" data-path="boxplots.html"><a href="boxplots.html#boxplot-with-geom_boxplot"><i class="fa fa-check"></i><b>12.1</b> Boxplot with geom_boxplot</a></li>
<li class="chapter" data-level="12.2" data-path="boxplots.html"><a href="boxplots.html#teoretical-boxplot"><i class="fa fa-check"></i><b>12.2</b> Teoretical boxplot</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="boxplots.html"><a href="boxplots.html#change-the-width-of-the-boxes"><i class="fa fa-check"></i><b>12.2.1</b> Change the width of the boxes</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="boxplots.html"><a href="boxplots.html#geom_boxplot-options-and-parameters"><i class="fa fa-check"></i><b>12.3</b> <strong>geom_boxplot</strong> Options and Parameters:</a></li>
<li class="chapter" data-level="12.4" data-path="boxplots.html"><a href="boxplots.html#violin-diagram-with-geom_violin"><i class="fa fa-check"></i><b>12.4</b> Violin diagram with <strong>geom_violin</strong></a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="boxplots.html"><a href="boxplots.html#geom_violin-with-multiple-groups"><i class="fa fa-check"></i><b>12.4.1</b> <strong>Geom_violin</strong> with multiple groups</a></li>
<li class="chapter" data-level="12.4.2" data-path="boxplots.html"><a href="boxplots.html#geom_violin-used-with-geom_point-and-geom_jitter"><i class="fa fa-check"></i><b>12.4.2</b> <strong>Geom_violin</strong> used with <strong>geom_point</strong> and <strong>geom_jitter</strong></a></li>
<li class="chapter" data-level="12.4.3" data-path="boxplots.html"><a href="boxplots.html#geom_jitter-and-geom-overlap"><i class="fa fa-check"></i><b>12.4.3</b> geom_jitter and <strong>geom</strong> overlap</a></li>
<li class="chapter" data-level="12.4.4" data-path="boxplots.html"><a href="boxplots.html#quartiles-and-geom_violin"><i class="fa fa-check"></i><b>12.4.4</b> Quartiles and geom_violin</a></li>
<li class="chapter" data-level="12.4.5" data-path="boxplots.html"><a href="boxplots.html#adding-color-to-the-outline-of-the-violin"><i class="fa fa-check"></i><b>12.4.5</b> Adding color to the outline of the violin</a></li>
<li class="chapter" data-level="12.4.6" data-path="boxplots.html"><a href="boxplots.html#geom_violin-by-category-or-factor"><i class="fa fa-check"></i><b>12.4.6</b> geom_violin by category or factor</a></li>
<li class="chapter" data-level="12.4.7" data-path="boxplots.html"><a href="boxplots.html#geom_violin-in-proportion-to-sample-size"><i class="fa fa-check"></i><b>12.4.7</b> Geom_violin in proportion to sample size</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="boxplots.html"><a href="boxplots.html#geom_violin-not-in-proportion-to-sample-size"><i class="fa fa-check"></i><b>12.5</b> geom_violin not in proportion to sample size</a></li>
<li class="chapter" data-level="12.6" data-path="boxplots.html"><a href="boxplots.html#geom_violin-and-orientation-change"><i class="fa fa-check"></i><b>12.6</b> geom_violin and orientation change</a></li>
<li class="chapter" data-level="12.7" data-path="boxplots.html"><a href="boxplots.html#geom_violin-options-and-parameters"><i class="fa fa-check"></i><b>12.7</b> <strong>geom_violin</strong> Options and Parameters:</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="other-visualizations.html"><a href="other-visualizations.html"><i class="fa fa-check"></i><b>13</b> Other visualizations</a>
<ul>
<li class="chapter" data-level="13.1" data-path="other-visualizations.html"><a href="other-visualizations.html#barplot"><i class="fa fa-check"></i><b>13.1</b> Barplot</a></li>
<li class="chapter" data-level="13.2" data-path="other-visualizations.html"><a href="other-visualizations.html#line-chart"><i class="fa fa-check"></i><b>13.2</b> Line chart</a></li>
<li class="chapter" data-level="13.3" data-path="other-visualizations.html"><a href="other-visualizations.html#heat-map"><i class="fa fa-check"></i><b>13.3</b> Heat map</a></li>
<li class="chapter" data-level="13.4" data-path="other-visualizations.html"><a href="other-visualizations.html#plot-of-mean-and-confidence-intervals"><i class="fa fa-check"></i><b>13.4</b> Plot of mean and confidence intervals</a></li>
<li class="chapter" data-level="13.5" data-path="other-visualizations.html"><a href="other-visualizations.html#major-error-caution"><i class="fa fa-check"></i><b>13.5</b> MAJOR error: CAUTION</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>14</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="14.1" data-path="linear-regression.html"><a href="linear-regression.html#model-of-linear-regression"><i class="fa fa-check"></i><b>14.1</b> Model of linear regression</a></li>
<li class="chapter" data-level="14.2" data-path="linear-regression.html"><a href="linear-regression.html#assumption-of-linear-regression"><i class="fa fa-check"></i><b>14.2</b> Assumption of linear regression</a></li>
<li class="chapter" data-level="14.3" data-path="linear-regression.html"><a href="linear-regression.html#selling-music-records-1"><i class="fa fa-check"></i><b>14.3</b> Selling music records</a></li>
<li class="chapter" data-level="14.4" data-path="linear-regression.html"><a href="linear-regression.html#cooks-distance-1"><i class="fa fa-check"></i><b>14.4</b> Cook’s Distance</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="quantile-regression.html"><a href="quantile-regression.html"><i class="fa fa-check"></i><b>15</b> Quantile Regression</a>
<ul>
<li class="chapter" data-level="15.1" data-path="quantile-regression.html"><a href="quantile-regression.html#overview"><i class="fa fa-check"></i><b>15.1</b> Overview</a></li>
<li class="chapter" data-level="15.2" data-path="quantile-regression.html"><a href="quantile-regression.html#the-model"><i class="fa fa-check"></i><b>15.2</b> The model</a></li>
<li class="chapter" data-level="15.3" data-path="quantile-regression.html"><a href="quantile-regression.html#the-assumptions-of-quantile-regression"><i class="fa fa-check"></i><b>15.3</b> The assumptions of quantile regression</a></li>
<li class="chapter" data-level="15.4" data-path="quantile-regression.html"><a href="quantile-regression.html#visualization"><i class="fa fa-check"></i><b>15.4</b> Visualization</a></li>
<li class="chapter" data-level="15.5" data-path="quantile-regression.html"><a href="quantile-regression.html#example-quantile-regression-in-r"><i class="fa fa-check"></i><b>15.5</b> Example: Quantile regression in R</a></li>
<li class="chapter" data-level="15.6" data-path="quantile-regression.html"><a href="quantile-regression.html#the-quantile-regression-model-rq"><i class="fa fa-check"></i><b>15.6</b> The quantile regression model, <code>rq()</code></a></li>
<li class="chapter" data-level="15.7" data-path="quantile-regression.html"><a href="quantile-regression.html#nlrq-function"><i class="fa fa-check"></i><b>15.7</b> nlrq() function</a></li>
<li class="chapter" data-level="15.8" data-path="quantile-regression.html"><a href="quantile-regression.html#multivariate-quantile-regression"><i class="fa fa-check"></i><b>15.8</b> Multivariate quantile regression</a></li>
<li class="chapter" data-level="15.9" data-path="quantile-regression.html"><a href="quantile-regression.html#conclusion-1"><i class="fa fa-check"></i><b>15.9</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>16</b> Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="16.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#generalized-linear-models-1"><i class="fa fa-check"></i><b>16.1</b> Generalized Linear models</a></li>
<li class="chapter" data-level="16.2" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#when-the-dependent-variable-is-not-linear"><i class="fa fa-check"></i><b>16.2</b> When the dependent variable is not linear</a></li>
<li class="chapter" data-level="16.3" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#link-available"><i class="fa fa-check"></i><b>16.3</b> Link available</a></li>
<li class="chapter" data-level="16.4" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#the-assumptions"><i class="fa fa-check"></i><b>16.4</b> The assumptions</a></li>
<li class="chapter" data-level="16.5" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#the-advantages-of-glm"><i class="fa fa-check"></i><b>16.5</b> The advantages of GLM</a></li>
<li class="chapter" data-level="16.6" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#binomial-or-bernoulli-models"><i class="fa fa-check"></i><b>16.6</b> Binomial or Bernoulli models</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#gamma-distribution"><i class="fa fa-check"></i><b>16.6.1</b> Gamma Distribution</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#the-basic-parameters-of-the-gamma."><i class="fa fa-check"></i><b>16.7</b> The basic parameters of the gamma.</a>
<ul>
<li class="chapter" data-level="16.7.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#the-inverse-gaussian-distribution"><i class="fa fa-check"></i><b>16.7.1</b> The inverse Gaussian distribution</a></li>
</ul></li>
<li class="chapter" data-level="16.8" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#evaluating-distributions"><i class="fa fa-check"></i><b>16.8</b> Evaluating distributions</a></li>
<li class="chapter" data-level="16.9" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#binomial-regression"><i class="fa fa-check"></i><b>16.9</b> Binomial regression</a></li>
<li class="chapter" data-level="16.10" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#poisson-regression"><i class="fa fa-check"></i><b>16.10</b> Poisson regression</a></li>
<li class="chapter" data-level="16.11" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#negative-binomial-regression"><i class="fa fa-check"></i><b>16.11</b> Negative binomial regression</a>
<ul>
<li class="chapter" data-level="16.11.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#comparing-dispersion-models"><i class="fa fa-check"></i><b>16.11.1</b> Comparing dispersion models</a></li>
<li class="chapter" data-level="16.11.2" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#alternative-approach-to-compare-the-poisson-and-the-negative-binomial-model."><i class="fa fa-check"></i><b>16.11.2</b> Alternative approach to compare the Poisson and the negative binomial model.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="multinomial-logit-analysis.html"><a href="multinomial-logit-analysis.html"><i class="fa fa-check"></i><b>17</b> Multinomial logit analysis</a>
<ul>
<li class="chapter" data-level="17.0.1" data-path="multinomial-logit-analysis.html"><a href="multinomial-logit-analysis.html#load-libraries"><i class="fa fa-check"></i><b>17.0.1</b> Load libraries</a></li>
<li class="chapter" data-level="17.0.2" data-path="multinomial-logit-analysis.html"><a href="multinomial-logit-analysis.html#data"><i class="fa fa-check"></i><b>17.0.2</b> Data</a></li>
<li class="chapter" data-level="17.0.3" data-path="multinomial-logit-analysis.html"><a href="multinomial-logit-analysis.html#model"><i class="fa fa-check"></i><b>17.0.3</b> Model</a></li>
<li class="chapter" data-level="17.0.4" data-path="multinomial-logit-analysis.html"><a href="multinomial-logit-analysis.html#assumptions"><i class="fa fa-check"></i><b>17.0.4</b> Assumptions</a></li>
<li class="chapter" data-level="17.0.5" data-path="multinomial-logit-analysis.html"><a href="multinomial-logit-analysis.html#post-estimation-analysis"><i class="fa fa-check"></i><b>17.0.5</b> Post estimation analysis</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="beta-regression.html"><a href="beta-regression.html"><i class="fa fa-check"></i><b>18</b> Beta Regression</a>
<ul>
<li class="chapter" data-level="18.1" data-path="beta-regression.html"><a href="beta-regression.html#what-is-a-beta-regression"><i class="fa fa-check"></i><b>18.1</b> What is a beta regression?</a></li>
<li class="chapter" data-level="18.2" data-path="beta-regression.html"><a href="beta-regression.html#what-is-the-problem-with-the-data"><i class="fa fa-check"></i><b>18.2</b> What is the problem with the data?</a></li>
<li class="chapter" data-level="18.3" data-path="beta-regression.html"><a href="beta-regression.html#first-step-what-is-a-beta-distribution"><i class="fa fa-check"></i><b>18.3</b> First step, what is a beta distribution?</a></li>
<li class="chapter" data-level="18.4" data-path="beta-regression.html"><a href="beta-regression.html#wikipedia"><i class="fa fa-check"></i><b>18.4</b> Wikipedia</a></li>
<li class="chapter" data-level="18.5" data-path="beta-regression.html"><a href="beta-regression.html#proportion-of-smokers-in-different-countries"><i class="fa fa-check"></i><b>18.5</b> Proportion of smokers in different countries</a></li>
<li class="chapter" data-level="18.6" data-path="beta-regression.html"><a href="beta-regression.html#convert-the-mean-and-variance-into-shape-alpha-and-beta"><i class="fa fa-check"></i><b>18.6</b> Convert the mean and variance into shape <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span></a></li>
<li class="chapter" data-level="18.7" data-path="beta-regression.html"><a href="beta-regression.html#visualization-of-the-distribution-with-ci."><i class="fa fa-check"></i><b>18.7</b> Visualization of the distribution with CI.</a></li>
<li class="chapter" data-level="18.8" data-path="beta-regression.html"><a href="beta-regression.html#regression-model"><i class="fa fa-check"></i><b>18.8</b> Regression model</a></li>
<li class="chapter" data-level="18.9" data-path="beta-regression.html"><a href="beta-regression.html#regresión-beta-proporción-de-frutos-por-cantidad-de-flores"><i class="fa fa-check"></i><b>18.9</b> Regresión beta, proporción de frutos por cantidad de flores</a></li>
<li class="chapter" data-level="18.10" data-path="beta-regression.html"><a href="beta-regression.html#visualize-the-beta-regression"><i class="fa fa-check"></i><b>18.10</b> Visualize the beta regression</a></li>
<li class="chapter" data-level="18.11" data-path="beta-regression.html"><a href="beta-regression.html#compare-the-traditional-linear-model-versus-a-beta-model"><i class="fa fa-check"></i><b>18.11</b> Compare the traditional linear model versus a beta model</a></li>
<li class="chapter" data-level="18.12" data-path="beta-regression.html"><a href="beta-regression.html#distribution-of-specific-values"><i class="fa fa-check"></i><b>18.12</b> Distribution of specific values</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="auto-regressive-vectorial-analysis.html"><a href="auto-regressive-vectorial-analysis.html"><i class="fa fa-check"></i><b>19</b> Auto Regressive Vectorial Analysis</a></li>
<li class="chapter" data-level="20" data-path="chi-square-testcontingency-tables.html"><a href="chi-square-testcontingency-tables.html"><i class="fa fa-check"></i><b>20</b> Chi-square test/Contingency tables</a>
<ul>
<li class="chapter" data-level="20.1" data-path="chi-square-testcontingency-tables.html"><a href="chi-square-testcontingency-tables.html#count-data"><i class="fa fa-check"></i><b>20.1</b> Count data</a></li>
<li class="chapter" data-level="20.2" data-path="chi-square-testcontingency-tables.html"><a href="chi-square-testcontingency-tables.html#chi-square-test"><i class="fa fa-check"></i><b>20.2</b> Chi-square test</a></li>
<li class="chapter" data-level="20.3" data-path="chi-square-testcontingency-tables.html"><a href="chi-square-testcontingency-tables.html#contingency-tables"><i class="fa fa-check"></i><b>20.3</b> Contingency tables</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative Agricultural Economics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="generalized-linear-models" class="section level1 hasAnchor" number="16">
<h1><span class="header-section-number">Chapter 16</span> Generalized Linear Models<a href="generalized-linear-models.html#generalized-linear-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<hr />
<div id="generalized-linear-models-1" class="section level2 hasAnchor" number="16.1">
<h2><span class="header-section-number">16.1</span> Generalized Linear models<a href="generalized-linear-models.html#generalized-linear-models-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Generalized linear models, GLM, are an extension of linear models where the dependent variable has a normal distribution. We remember that in a linear regression the dependent variable follows the model <span class="math inline">\(y_i = \beta_0 + \beta_1 x_i\)</span>, where <span class="math inline">\(\beta_0\)</span> is the intercept and the <span class="math inline">\(\beta_1\)</span> is the coefficient, that is, the slope and the <span class="math inline">\(x_i\)</span> are the values of x’s. One of the assumptions is that the variation in the values of <span class="math inline">\(\mu_i\)</span>, which are the <span class="math inline">\(y_i\)</span>, have a normal distribution in each x’s and that there is homogeneity of variance.</p>
<p><span class="math display">\[\mu_i=\beta_0+\beta_1x_i\]</span> An important assumption is the assumption that the variation in the <span class="math inline">\(y_i\)</span> are normally distributed and that there is homogeneity of variance.</p>
<p><span class="math display">\[y_i\sim N\left(\mu_i,\ \epsilon\right)\]</span> We can visualize it with the following figure, where the values of y’s have a normal distribution and that this distribution is homogeneous across the values of x’s.</p>
<p>We show two figures where the y’s are normally distributed (with histogram) and that the distribution is homogeneous across the values of x’s. The second figure shows the relationship between the x’s and the y’s, where the points are the values of the x’s and y’s and the line is the regression line aredistributed moreor less equally around the line.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="generalized-linear-models.html#cb1-1" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb1-2"><a href="generalized-linear-models.html#cb1-2" tabindex="-1"></a>y<span class="ot">=</span><span class="dv">2</span><span class="sc">+</span><span class="dv">3</span><span class="sc">*</span>x<span class="sc">+</span><span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb1-3"><a href="generalized-linear-models.html#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="generalized-linear-models.html#cb1-4" tabindex="-1"></a>df<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)</span>
<span id="cb1-5"><a href="generalized-linear-models.html#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="generalized-linear-models.html#cb1-6" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>y))<span class="sc">+</span></span>
<span id="cb1-7"><a href="generalized-linear-models.html#cb1-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">colour=</span><span class="st">&quot;white&quot;</span>)<span class="sc">+</span></span>
<span id="cb1-8"><a href="generalized-linear-models.html#cb1-8" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;x values&quot;</span>)<span class="sc">+</span></span>
<span id="cb1-9"><a href="generalized-linear-models.html#cb1-9" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;y values&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="generalized-linear-models.html#cb3-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y))<span class="sc">+</span></span>
<span id="cb3-2"><a href="generalized-linear-models.html#cb3-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb3-3"><a href="generalized-linear-models.html#cb3-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span>F)<span class="sc">+</span></span>
<span id="cb3-4"><a href="generalized-linear-models.html#cb3-4" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;x values&quot;</span>)<span class="sc">+</span></span>
<span id="cb3-5"><a href="generalized-linear-models.html#cb3-5" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;y values&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-1-2.png" width="672" /></p>
<hr />
</div>
<div id="when-the-dependent-variable-is-not-linear" class="section level2 hasAnchor" number="16.2">
<h2><span class="header-section-number">16.2</span> When the dependent variable is not linear<a href="generalized-linear-models.html#when-the-dependent-variable-is-not-linear" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The main problem for a long time has been that the dependent variables does not always normally distributed and consequently did not meet the assumptions of linear regression. The method of linearizing the response variable was developed by Nelder and Wedderburn 1972. Information about the test and its evolution of GLM can be found at <a href="https://encyclopediaofmath.org/wiki/Generalized_linear_models" class="uri">https://encyclopediaofmath.org/wiki/Generalized_linear_models</a>. With the advancement of the use of computers in the 80s, it ended up being one of the most used statistical methods.</p>
<p>The term GLM refers to a wide variety of regression models. The assumption in these models is that the response variable <span class="math inline">\(y_i\)</span> follows a distribution within the family of exponential distributions with an average <span class="math inline">\(\mu_i\)</span>, where a function <span class="math inline">\(\mu_i^T\beta\)</span> is assumed that is frequently non-linear. To linearize the variable it is necessary to use a “link” to convert the dependent variable, <span class="math inline">\(y_i\)</span>.</p>
<hr />
</div>
<div id="link-available" class="section level2 hasAnchor" number="16.3">
<h2><span class="header-section-number">16.3</span> Link available<a href="generalized-linear-models.html#link-available" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A link is a function that transforms the dependent variable, <span class="math inline">\(y_i\)</span>, to make it linear with the independent variable, <span class="math inline">\(x_i\)</span>. The link function is a function that connects the expected value of the dependent variable, <span class="math inline">\(\mu_i\)</span>, with the linear combination of the independent variable, <span class="math inline">\(x_i\)</span>. The link function is denoted by <span class="math inline">\(g\left(\mu_i\right)=\beta_0+\beta_1x_i\)</span>.</p>
<p>Here I show a partial list of the different types of “links” for different types of data (or distributions) of the independent variable, <span class="math inline">\(y_i\)</span>. The decision of which transformation or <strong>link</strong> to use will depend on the data types and their distribution. This is only a subset of avaliable link functions.</p>
<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:GLM_2">
<caption style="caption-side: top; text-align: center;">(#tab:GLM_2) Common Link function in GLM.</caption><col><col><col><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;"><span style="color: rgb(255, 0, 0);">Modelo</span></th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;"><span style="color: rgb(255, 0, 0);">Variable_Dep</span></th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;"><span style="color: rgb(255, 0, 0);">Link</span></th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;"><span style="color: rgb(255, 0, 0);">Variables_Independiente</span></th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Linear regressionl</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Normal</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Identidy</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Continuous</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">ANOVA</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Normal</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Identity</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Categorical</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Logistic Regression</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Binomial</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Logit</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Mix</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Poisson Regression</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Poisson</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Log</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Mix</td></tr>
</table>

<p>Although the previous distributions are very common, they are not the only links available to transform the data. Here is supplementary information on some other R links that are available in certain packages.</p>
<p><a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/family" class="uri">https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/family</a></p>
<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:GLM_3">
<caption style="caption-side: top; text-align: center;">(#tab:GLM_3) Common link functions in GLM.</caption><col><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;"><span style="color: rgb(255, 0, 0);">Familia</span></th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;"><span style="color: rgb(255, 0, 0);">Links</span></th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Gaussian/Normal</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">identity, log, inverse</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Binomial</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">logit, probit, cauchit, log, cloglog</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Gamma</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">inverse, identity, log</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Poisson</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">log, identity, square root</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Inverse Gausian</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1/µ^2, inverse, identity, log</td></tr>
</table>

<hr />
</div>
<div id="the-assumptions" class="section level2 hasAnchor" number="16.4">
<h2><span class="header-section-number">16.4</span> The assumptions<a href="generalized-linear-models.html#the-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>The advantage is that now the dependent variable does not have to have a normal distribution.</li>
<li>Furthermore, untransformed data does not have to have a linear relationship. However, the data must come from a distribution of the exponential family, for example, binomial, Poisson, multinomial, normal, inverse normal, etc.</li>
<li>GLM does not assume a linear relationship between the dependent and independent variable, but assumes a linear relationship of the transformed dependent variable data and the independent variable. Consequently, a linear relationship is assumed between the binary variable and the explanatory variable after using the transformation with the link, <span class="math inline">\(logit\left(\pi\right)=\beta_0+\beta_1\cdot x_i\)</span>.</li>
<li>The assumption of homogeneity of variance does not have to be taken into account (necesary for Linear regression).</li>
<li>The errors have to be independent but it does not matter if they comply with a normal distribution.</li>
</ul>
<hr />
</div>
<div id="the-advantages-of-glm" class="section level2 hasAnchor" number="16.5">
<h2><span class="header-section-number">16.5</span> The advantages of GLM<a href="generalized-linear-models.html#the-advantages-of-glm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>The parameters are estimated using likelihood (MLE = Maximum Likelihood estimators), not least squares (OLS = ordinary least square). The models are estimated via likelihood, then they optimize the estimators, <span class="math inline">\(\beta\)</span>.</li>
<li>There is no need to transform the data of the dependent variable to normalize them.</li>
<li>The selection of the “link” is independent of the dependent variable(s), which makes it easier to create models.</li>
<li>Tools to evaluate inferences and models are available such as evaluating residuals, confidence intervals, deviation, likelihood ratio test and Akaike Information Criterio index among others.</li>
</ul>
<hr />
</div>
<div id="binomial-or-bernoulli-models" class="section level2 hasAnchor" number="16.6">
<h2><span class="header-section-number">16.6</span> Binomial or Bernoulli models<a href="generalized-linear-models.html#binomial-or-bernoulli-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If the variable is binomial, there are only two alternatives, 0 and 1, or dead or alive, with fruit or no fruits, with inflorescence or not. In this case the the binomial distribution is used. The <strong>logit</strong> function is used as a link function and the binomial/Bernoulli distribution as a probability distribution, the model is called <strong>Logistic Regression</strong>.</p>
<p><span class="math display">\[\log\frac{q_i}{1-q_i}=\beta_0+\beta_1X_i\]</span>
where the distribution is a binomial with <span class="math inline">\(y_i\sim Binomial\left(q_i\right)\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="generalized-linear-models.html#cb5-1" tabindex="-1"></a><span class="co">#library(wakefield)</span></span>
<span id="cb5-2"><a href="generalized-linear-models.html#cb5-2" tabindex="-1"></a>x<span class="ot">=</span>wakefield<span class="sc">::</span><span class="fu">r_sample_binary</span>(<span class="dv">50</span>, <span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">prob =</span><span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>), <span class="at">name =</span> <span class="st">&quot;Binary&quot;</span>)</span>
<span id="cb5-3"><a href="generalized-linear-models.html#cb5-3" tabindex="-1"></a><span class="co">#x</span></span>
<span id="cb5-4"><a href="generalized-linear-models.html#cb5-4" tabindex="-1"></a>df<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">as.factor</span>(x))</span>
<span id="cb5-5"><a href="generalized-linear-models.html#cb5-5" tabindex="-1"></a><span class="co">#df</span></span>
<span id="cb5-6"><a href="generalized-linear-models.html#cb5-6" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x))<span class="sc">+</span></span>
<span id="cb5-7"><a href="generalized-linear-models.html#cb5-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb5-8"><a href="generalized-linear-models.html#cb5-8" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb5-9"><a href="generalized-linear-models.html#cb5-9" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Binary Values&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<hr />
<div id="gamma-distribution" class="section level3 hasAnchor" number="16.6.1">
<h3><span class="header-section-number">16.6.1</span> Gamma Distribution<a href="generalized-linear-models.html#gamma-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The gamma distribution is frequently used to take into account variables that have very long and large tails (Heavy-Tailed distributions). The distribution is widely used in the area of econometrics and survival estimates.</p>
<p>The gamma distribution can be parameterized with a “<strong>shape</strong> term <span class="math inline">\(\alpha = k\)</span> and the inverse of a scale parameter <span class="math inline">\(\beta=1/\theta\)</span> which is known as a * parameter *rate**.</p>
<p><span class="math display">\[f\left(x\right)=\frac{\left(\beta^{\alpha}\cdot x^{\alpha-1}e^{-\beta x}\right)}{\Gamma\left(\alpha\right)}\ para\ x&gt;0,\ \ \alpha,\ \beta&gt;0\]</span></p>
<p>where <span class="math inline">\(\Gamma\left(\alpha\right)\)</span> is the gamma function. For each integer value <span class="math inline">\(\Gamma\left(\alpha\right)=\left(\alpha-1\right)!\)</span></p>
<p>In another word, the gamma distribution is for modeling continuous variables that are always positive and have skewed distributions (long tails).</p>
<p>Examples where the gamma distribution is used</p>
<ul>
<li>the time until the moment of failure of a an equipment</li>
<li>the time until the death of individuals</li>
<li>the amount of water accumulated in a lake</li>
<li>the size of unpaid loans</li>
</ul>
<p>Let’s look at some gamma distributions</p>
<p>Note that in all cases the data is always positive and the distribution has a long tail and none comply with normal distribution. The k=9, theta=0.5 which a quick glance could appear normal has a very long tail, thus a normal distribution would not predict correctly data on the tail.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="generalized-linear-models.html#cb6-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb6-2"><a href="generalized-linear-models.html#cb6-2" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dgamma</span>(x, <span class="at">shape=</span><span class="dv">1</span>, <span class="at">scale=</span><span class="dv">2</span>), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;f(x;k,theta)&quot;</span>, <span class="fl">0.4</span>, <span class="dv">20</span>, <span class="at">col =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">3</span>, </span>
<span id="cb6-3"><a href="generalized-linear-models.html#cb6-3" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Examples of Gamma Distributions&quot;</span>)</span>
<span id="cb6-4"><a href="generalized-linear-models.html#cb6-4" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dgamma</span>(x, <span class="at">shape=</span><span class="dv">2</span>, <span class="at">scale=</span><span class="dv">2</span>), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;f(x;k,theta)&quot;</span>, <span class="fl">0.4</span>, <span class="dv">20</span>, <span class="at">col =</span> <span class="dv">5</span>, <span class="at">lwd =</span> <span class="dv">3</span>, </span>
<span id="cb6-5"><a href="generalized-linear-models.html#cb6-5" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-6"><a href="generalized-linear-models.html#cb6-6" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dgamma</span>(x, <span class="at">shape=</span><span class="dv">2</span>, <span class="at">scale=</span><span class="dv">4</span>), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;f(x;k,theta)&quot;</span>, <span class="fl">0.4</span>, <span class="dv">20</span>, <span class="at">col =</span> <span class="dv">6</span>, <span class="at">lwd =</span> <span class="dv">3</span>, </span>
<span id="cb6-7"><a href="generalized-linear-models.html#cb6-7" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-8"><a href="generalized-linear-models.html#cb6-8" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dgamma</span>(x,<span class="at">shape =</span><span class="dv">5</span>, <span class="at">scale=</span><span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;f(x;k,theta)&quot;</span>, <span class="fl">0.4</span>, <span class="dv">20</span>, <span class="at">col =</span> <span class="dv">7</span>, <span class="at">lwd =</span> <span class="dv">3</span>, </span>
<span id="cb6-9"><a href="generalized-linear-models.html#cb6-9" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-10"><a href="generalized-linear-models.html#cb6-10" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dgamma</span>(x, <span class="at">shape=</span><span class="dv">9</span>, <span class="at">scale=</span><span class="fl">0.5</span>), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;f(x;k,theta)&quot;</span>, <span class="fl">0.4</span>, <span class="dv">20</span>, <span class="at">col =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">3</span>, </span>
<span id="cb6-11"><a href="generalized-linear-models.html#cb6-11" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-12"><a href="generalized-linear-models.html#cb6-12" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dgamma</span>(x, <span class="at">shape=</span><span class="fl">7.5</span>, <span class="at">scale=</span><span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;f(x;k,theta)&quot;</span>, <span class="fl">0.4</span>, <span class="dv">20</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">3</span>, </span>
<span id="cb6-13"><a href="generalized-linear-models.html#cb6-13" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-14"><a href="generalized-linear-models.html#cb6-14" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;k=1,theta=2&quot;</span>, <span class="st">&quot;k=2,theta=2&quot;</span>, <span class="st">&quot;k=2,theta=4&quot;</span>,<span class="st">&quot;k=5,theta=1&quot;</span>,<span class="st">&quot;k=9,theta=0.5&quot;</span>, <span class="st">&quot;k=7.5,theta=1.0&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>,<span class="dv">6</span>, <span class="dv">7</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">inset =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/GLM_4-1.png" width="672" /></p>
</div>
</div>
<div id="the-basic-parameters-of-the-gamma." class="section level2 hasAnchor" number="16.7">
<h2><span class="header-section-number">16.7</span> The basic parameters of the gamma.<a href="generalized-linear-models.html#the-basic-parameters-of-the-gamma." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Note: The <strong>scale</strong> is a dispersion index, and the higher the number, the longer the tail.</p>
<p>The average is equal to the multiplication of shape=k by scale = theta, <span class="math display">\[average=k\cdot\theta\]</span>.</p>
<p>The variance is equal to the multiplication of shape=k by scale = (theta)^2, <span class="math display">\[variance=k\cdot\theta^2\]</span></p>
<p>You can find the formulas to calculate other parameters on the Wikipedia page.</p>
<p><a href="https://en.wikipedia.org/wiki/Gamma_distribution" class="uri">https://en.wikipedia.org/wiki/Gamma_distribution</a></p>
<hr />
<div id="the-inverse-gaussian-distribution" class="section level3 hasAnchor" number="16.7.1">
<h3><span class="header-section-number">16.7.1</span> The inverse Gaussian distribution<a href="generalized-linear-models.html#the-inverse-gaussian-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In probability theory, the inverse Gaussian distribution is a two-parameter family of continuous probability distributions with support at (0, ∞).</p>
<p>The distribution follows the following form <span class="math display">\[f\left(x;µ,\lambda\right)=\sqrt{\frac{\lambda}{2\pi x^3}}\exp\left(-\frac{\lambda\left(x-µ\right)^2}{2µ^2x}\right)\]</span></p>
<p>where <span class="math inline">\(x&gt;0\)</span>, <span class="math inline">\(µ&gt;0\)</span>, and <span class="math inline">\(\lambda\)</span>. It is the form of distribution and is always greater than zero. The larger the <span class="math inline">\(\lambda\)</span> (the shape parameter) the more symmetrical the distribution.</p>
<p>As λ tends to infinity, the inverse Gaussian distribution looks like a normal (Gaussian) distribution. The inverse Gaussian distribution is also known as the Wald distribution.</p>
<p>The distribution is used when the population distribution where the lognormal distribution has too heavy a right tail. When referring to heavy tails in statistics, it means that there are more probabilities in this region than a normal distribution. The distribution is used to model non-negative data that is positively skewed. In other words, all values are positive and the tail tends to decrease more slowly than in a normal distribution.</p>
<div id="reverse-gaussian-history" class="section level4 hasAnchor" number="16.7.1.1">
<h4><span class="header-section-number">16.7.1.1</span> Reverse Gaussian history<a href="generalized-linear-models.html#reverse-gaussian-history" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Historical information on the inverse Gaussian distribution is somewhat limited. The distribution was apparently first derived by Louis Bachelier in 1900, when he was trying to estimate the stock market price for different companies. But the name “Inverse Gaussian” was suggested by Maurice Tweedie in 1945. See this link for more details.</p>
<p><a href="https://en.wikipedia.org/wiki/Normal-inverse_Gaussian_distribution" class="uri">https://en.wikipedia.org/wiki/Normal-inverse_Gaussian_distribution</a></p>
<p>Examples that could be of this type of distribution</p>
<ul>
<li>the time it takes to get to a place.</li>
<li>the distribution of house prices</li>
<li>the number of children in a family</li>
<li>the survival of organisms (survival data)</li>
</ul>
<p>Note that the distribution is not symmetrical, and the larger the <span class="math inline">\(\lambda\)</span> the more symmetrical the distribution.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="generalized-linear-models.html#cb7-1" tabindex="-1"></a><span class="fu">library</span>(SuppDists) </span>
<span id="cb7-2"><a href="generalized-linear-models.html#cb7-2" tabindex="-1"></a><span class="co">#dinvGauss(x, nu, lambda, log=FALSE)</span></span>
<span id="cb7-3"><a href="generalized-linear-models.html#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="generalized-linear-models.html#cb7-4" tabindex="-1"></a>x <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb7-5"><a href="generalized-linear-models.html#cb7-5" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dinvGauss</span>(x, <span class="at">nu=</span>.<span class="dv">7</span>, <span class="at">lambda=</span><span class="fl">0.2</span>, <span class="at">log=</span><span class="cn">FALSE</span>), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;f(x;k,theta)&quot;</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">3</span>, <span class="at">col =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb7-6"><a href="generalized-linear-models.html#cb7-6" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Gráfico distribución Gausiana Inversa&quot;</span>)</span>
<span id="cb7-7"><a href="generalized-linear-models.html#cb7-7" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dinvGauss</span>(x, <span class="at">nu=</span>.<span class="dv">7</span>, <span class="at">lambda=</span><span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;f(x;k,theta)&quot;</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">3</span>, <span class="at">col =</span> <span class="dv">5</span>, <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb7-8"><a href="generalized-linear-models.html#cb7-8" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-9"><a href="generalized-linear-models.html#cb7-9" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dinvGauss</span>(x, <span class="at">nu=</span>.<span class="dv">7</span>, <span class="at">lambda=</span><span class="dv">3</span>), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;f(x;k,theta)&quot;</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">3</span>, <span class="at">col =</span> <span class="dv">6</span>, <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb7-10"><a href="generalized-linear-models.html#cb7-10" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-11"><a href="generalized-linear-models.html#cb7-11" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dinvGauss</span>(x, <span class="at">nu=</span><span class="dv">2</span>, <span class="at">lambda=</span><span class="fl">0.2</span>), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;f(x;k,theta)&quot;</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">3</span>, <span class="at">col =</span> <span class="dv">7</span>, <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb7-12"><a href="generalized-linear-models.html#cb7-12" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-13"><a href="generalized-linear-models.html#cb7-13" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dinvGauss</span>(x, <span class="at">nu=</span><span class="dv">2</span>, <span class="at">lambda=</span><span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;f(x;k,theta)&quot;</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">3</span>, <span class="at">col =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb7-14"><a href="generalized-linear-models.html#cb7-14" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-15"><a href="generalized-linear-models.html#cb7-15" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dinvGauss</span>(x, <span class="at">nu=</span><span class="dv">2</span>, <span class="at">lambda=</span><span class="dv">4</span>), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;f(x;k,theta)&quot;</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">3</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb7-16"><a href="generalized-linear-models.html#cb7-16" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-17"><a href="generalized-linear-models.html#cb7-17" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dinvGauss</span>(x, <span class="at">nu=</span><span class="dv">1</span>, <span class="at">lambda=</span><span class="dv">40</span>), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;f(x;k,theta)&quot;</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">3</span>, <span class="at">col =</span> <span class="dv">4</span>, <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb7-18"><a href="generalized-linear-models.html#cb7-18" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-19"><a href="generalized-linear-models.html#cb7-19" tabindex="-1"></a></span>
<span id="cb7-20"><a href="generalized-linear-models.html#cb7-20" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;nu=.7,lambda=0.2&quot;</span>, <span class="st">&quot;nu=.7,lambda=1&quot;</span>, <span class="st">&quot;nu=.7,lambda=3&quot;</span>,<span class="st">&quot;nu=2,lambda=0.2&quot;</span>,<span class="st">&quot;nu=2,lambda=1&quot;</span>, <span class="st">&quot;nu=2,lambda=4&quot;</span>,<span class="st">&quot;nu=1,lambda=40&quot;</span>), </span>
<span id="cb7-21"><a href="generalized-linear-models.html#cb7-21" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>,<span class="dv">6</span>, <span class="dv">7</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">inset =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/GLM_5-1.png" width="672" /></p>
</div>
<div id="the-parameters-of-the-inverse-gaussian-distribution" class="section level4 hasAnchor" number="16.7.1.2">
<h4><span class="header-section-number">16.7.1.2</span> The parameters of the inverse Gaussian distribution<a href="generalized-linear-models.html#the-parameters-of-the-inverse-gaussian-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The average is calculated as follows</p>
<p><span class="math display">\[E\left[X\right]=\frac{1}{\mu}+\frac{1}{\lambda}\]</span></p>
<p>The variance is calculated in the following way</p>
<p><span class="math display">\[Var\left[X\right]=\frac{1}{\mu\lambda}+\frac{2}{\lambda^2}\]</span></p>
<p>For other parameters see this link</p>
<p><a href="https://en.wikipedia.org/wiki/Inverse_Gaussian_distribution" class="uri">https://en.wikipedia.org/wiki/Inverse_Gaussian_distribution</a></p>
<hr />
</div>
</div>
</div>
<div id="evaluating-distributions" class="section level2 hasAnchor" number="16.8">
<h2><span class="header-section-number">16.8</span> Evaluating distributions<a href="generalized-linear-models.html#evaluating-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Evaluate a data set to visualize the distribution.</p>
<p>If you need to do regression analysis with data that has an inverse Gaussian distribution the following package is available <strong>invGauss</strong> and if you want to determine which is the best distribution for your data with the package <strong>univariateML</strong> there are some functions to help you determine the type of distribution of your data.</p>
<p>I suggest this link.</p>
<p><a href="https://www.cienciadedatos.net/documentos/55_ajuste_distribuciones_con_r.html" class="uri">https://www.cienciadedatos.net/documentos/55_ajuste_distribuciones_con_r.html</a></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="generalized-linear-models.html#cb8-1" tabindex="-1"></a><span class="fu">library</span>(invGauss)</span>
<span id="cb8-2"><a href="generalized-linear-models.html#cb8-2" tabindex="-1"></a><span class="fu">library</span>(univariateML)</span>
<span id="cb8-3"><a href="generalized-linear-models.html#cb8-3" tabindex="-1"></a><span class="fu">data</span>(d.oropha.rec)</span>
<span id="cb8-4"><a href="generalized-linear-models.html#cb8-4" tabindex="-1"></a><span class="co">#d.oropha.rec</span></span>
<span id="cb8-5"><a href="generalized-linear-models.html#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a href="generalized-linear-models.html#cb8-6" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d.oropha.rec) <span class="sc">+</span></span>
<span id="cb8-7"><a href="generalized-linear-models.html#cb8-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span>  <span class="fu">after_stat</span>(density)),</span>
<span id="cb8-8"><a href="generalized-linear-models.html#cb8-8" tabindex="-1"></a>                 <span class="at">bins =</span> <span class="dv">40</span>,</span>
<span id="cb8-9"><a href="generalized-linear-models.html#cb8-9" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-10"><a href="generalized-linear-models.html#cb8-10" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="fu">aes</span>(<span class="at">x =</span> time)) <span class="sc">+</span></span>
<span id="cb8-11"><a href="generalized-linear-models.html#cb8-11" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(.x){<span class="fu">dml</span>(<span class="at">x =</span> .x, <span class="at">obj =</span> <span class="fu">mlnorm</span>(d.oropha.rec<span class="sc">$</span>time))},</span>
<span id="cb8-12"><a href="generalized-linear-models.html#cb8-12" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;normal&quot;</span>),</span>
<span id="cb8-13"><a href="generalized-linear-models.html#cb8-13" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb8-14"><a href="generalized-linear-models.html#cb8-14" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(.x){<span class="fu">dml</span>(<span class="at">x =</span> .x, <span class="at">obj =</span> <span class="fu">mlinvgauss</span>(d.oropha.rec<span class="sc">$</span>time))},</span>
<span id="cb8-15"><a href="generalized-linear-models.html#cb8-15" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;inverse-normal&quot;</span>),</span>
<span id="cb8-16"><a href="generalized-linear-models.html#cb8-16" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb8-17"><a href="generalized-linear-models.html#cb8-17" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;normal&quot;</span>, <span class="st">&quot;inverse-normal&quot;</span>),</span>
<span id="cb8-18"><a href="generalized-linear-models.html#cb8-18" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;normal&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;inverse-normal&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb8-19"><a href="generalized-linear-models.html#cb8-19" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of time of development&quot;</span>,</span>
<span id="cb8-20"><a href="generalized-linear-models.html#cb8-20" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Distribución&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-21"><a href="generalized-linear-models.html#cb8-21" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb8-22"><a href="generalized-linear-models.html#cb8-22" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/GLM_6-1.png" width="672" />
Example of diamond prices from the ggplot2 package</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="generalized-linear-models.html#cb9-1" tabindex="-1"></a><span class="co">#library(univariateML)</span></span>
<span id="cb9-2"><a href="generalized-linear-models.html#cb9-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds) <span class="sc">+</span></span>
<span id="cb9-3"><a href="generalized-linear-models.html#cb9-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> price, <span class="at">y =</span>  <span class="fu">after_stat</span>(density)),</span>
<span id="cb9-4"><a href="generalized-linear-models.html#cb9-4" tabindex="-1"></a>                 <span class="at">bins =</span> <span class="dv">40</span>,</span>
<span id="cb9-5"><a href="generalized-linear-models.html#cb9-5" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-6"><a href="generalized-linear-models.html#cb9-6" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="fu">aes</span>(<span class="at">x =</span> price)) <span class="sc">+</span></span>
<span id="cb9-7"><a href="generalized-linear-models.html#cb9-7" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(.x){<span class="fu">dml</span>(<span class="at">x =</span> .x, <span class="at">obj =</span> <span class="fu">mllnorm</span>(diamonds<span class="sc">$</span>price))},</span>
<span id="cb9-8"><a href="generalized-linear-models.html#cb9-8" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;log-normal&quot;</span>),</span>
<span id="cb9-9"><a href="generalized-linear-models.html#cb9-9" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9-10"><a href="generalized-linear-models.html#cb9-10" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(.x){<span class="fu">dml</span>(<span class="at">x =</span> .x, <span class="at">obj =</span> <span class="fu">mlinvgauss</span>(diamonds<span class="sc">$</span>price))},</span>
<span id="cb9-11"><a href="generalized-linear-models.html#cb9-11" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;inverse-normal&quot;</span>),</span>
<span id="cb9-12"><a href="generalized-linear-models.html#cb9-12" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9-13"><a href="generalized-linear-models.html#cb9-13" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;log-normal&quot;</span>, <span class="st">&quot;inverse-normal&quot;</span>),</span>
<span id="cb9-14"><a href="generalized-linear-models.html#cb9-14" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;log-normal&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;inverse-normal&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9-15"><a href="generalized-linear-models.html#cb9-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of diamond prices&quot;</span>,</span>
<span id="cb9-16"><a href="generalized-linear-models.html#cb9-16" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-17"><a href="generalized-linear-models.html#cb9-17" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb9-18"><a href="generalized-linear-models.html#cb9-18" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/GLM_7-1.png" width="672" /></p>
<hr />
</div>
<div id="binomial-regression" class="section level2 hasAnchor" number="16.9">
<h2><span class="header-section-number">16.9</span> Binomial regression<a href="generalized-linear-models.html#binomial-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The binomial regression is used when the dependent variable is binary, that is, it has two possible outcomes, 0 or 1, dead or alive, success or failure, etc. The binomial distribution is used as a probability distribution and the <strong>logit</strong> function is used as a link function. The model is called <strong>Logistic Regression</strong>.</p>
<p><span class="math display">\[\log\frac{q_i}{1-q_i}=\beta_0+\beta_1X_i\]</span>
where the distribution is a binomial with <span class="math inline">\(y_i\sim Binomial\left(q_i\right)\)</span>.</p>
<p>Here let use the data from Karn and Penrose of the survival or death on infants and birth weight.</p>
<ul>
<li>Survival: 1 = Infant survived, 0 = the Infant died</li>
<li>Weigth_lb = The weigth of the infant in pounds at birth.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="generalized-linear-models.html#cb10-1" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb10-2"><a href="generalized-linear-models.html#cb10-2" tabindex="-1"></a>Karn_Penrose_infant_survivorship <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Data/Karn_Penrose_infant_survivorship.csv&quot;</span>)</span>
<span id="cb10-3"><a href="generalized-linear-models.html#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="generalized-linear-models.html#cb10-4" tabindex="-1"></a>Infant<span class="ot">=</span> Karn_Penrose_infant_survivorship</span>
<span id="cb10-5"><a href="generalized-linear-models.html#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="generalized-linear-models.html#cb10-6" tabindex="-1"></a><span class="fu">head</span>(Infant)</span></code></pre></div>
<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:GLM_8">
<caption style="caption-side: top; text-align: center;">(#tab:GLM_8) </caption><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">row_num</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Survival</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Weigth_lb</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Gestation_Time_days</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">155</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">165</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">3</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">165</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">5.5</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">170</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">5</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">180</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">6</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.5</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">180</td></tr>
</table>

<p>Visualize the data</p>
<ul>
<li>The data is not normally distributed.</li>
<li>The data is binary, 0 or 1.</li>
<li>The regression line is not linear and is probability</li>
<li>The 95% confidence interval is shown in the graph.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="generalized-linear-models.html#cb11-1" tabindex="-1"></a><span class="fu">ggplot</span>(Infant, <span class="fu">aes</span>(<span class="at">x=</span>Weigth_lb, <span class="at">y=</span>Survival))<span class="sc">+</span></span>
<span id="cb11-2"><a href="generalized-linear-models.html#cb11-2" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">height =</span> <span class="fl">0.1</span>)<span class="sc">+</span> <span class="co"># point represents an infants outcome</span></span>
<span id="cb11-3"><a href="generalized-linear-models.html#cb11-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;glm&quot;</span>, <span class="at">method.args=</span><span class="fu">list</span>(<span class="at">family=</span><span class="st">&quot;binomial&quot;</span>), <span class="at">se=</span>T)<span class="sc">+</span> </span>
<span id="cb11-4"><a href="generalized-linear-models.html#cb11-4" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Weight in pounds&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-5"><a href="generalized-linear-models.html#cb11-5" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Probability of Survival&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-6"><a href="generalized-linear-models.html#cb11-6" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">14</span>, <span class="at">by =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/GLM_9-1.png" width="672" /></p>
<p>Creating the binomial model</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="generalized-linear-models.html#cb12-1" tabindex="-1"></a>Infant_model<span class="ot">=</span><span class="fu">glm</span>(Survival <span class="sc">~</span> Weigth_lb, <span class="at">data=</span>Infant, <span class="at">family=</span>binomial)</span>
<span id="cb12-2"><a href="generalized-linear-models.html#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="generalized-linear-models.html#cb12-3" tabindex="-1"></a><span class="fu">summary</span>(Infant_model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Survival ~ Weigth_lb, family = binomial, data = Infant)
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.76189    0.22628  -7.786 6.91e-15 ***
## Weigth_lb    0.67591    0.03825  17.670  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2199.2  on 4051  degrees of freedom
## Residual deviance: 1833.2  on 4050  degrees of freedom
## AIC: 1837.2
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<hr />
<p>Second example of logistic regression</p>
<p>Explanatory variables</p>
<ul>
<li>age= 201 particpants and their age</li>
<li>sex:0 = female 1= male</li>
<li>num_dependents: number of dependents</li>
<li>income: income in categories</li>
<li>descriminatory buyer: a person who regularly searches for differentiated products at grocery stores</li>
<li>Edu_none: 1 = less or equal to junior school and 0 = otherwise</li>
<li>Edu_high: 1 = has a high school degree, 0 = has less than high school</li>
<li>edu_bach: 1 = has a bachellor degree, 0= has less than a bachellor degree</li>
</ul>
<p>Response variable</p>
<ul>
<li>milk_local: ready to buy local milk? 0 = no, 1 = yes</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="generalized-linear-models.html#cb14-1" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb14-2"><a href="generalized-linear-models.html#cb14-2" tabindex="-1"></a>Milk_probit_logit <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;Data/Milk_probit_logit.xlsx&quot;</span>)</span>
<span id="cb14-3"><a href="generalized-linear-models.html#cb14-3" tabindex="-1"></a></span>
<span id="cb14-4"><a href="generalized-linear-models.html#cb14-4" tabindex="-1"></a><span class="fu">names</span>(Milk_probit_logit)</span></code></pre></div>
<pre><code>## [1] &quot;age&quot;                  &quot;sex&quot;                  &quot;num_dependents&quot;      
## [4] &quot;descriminatory_buyer&quot; &quot;income&quot;               &quot;Edu_none&quot;            
## [7] &quot;Educ_high&quot;            &quot;Educ_bacj&quot;            &quot;milk_local&quot;</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="generalized-linear-models.html#cb16-1" tabindex="-1"></a>milk_model_logit<span class="ot">=</span><span class="fu">glm</span>(milk_local<span class="sc">~</span>age<span class="sc">+</span>sex<span class="sc">+</span>num_dependents<span class="sc">+</span> descriminatory_buyer<span class="sc">+</span></span>
<span id="cb16-2"><a href="generalized-linear-models.html#cb16-2" tabindex="-1"></a>                          income<span class="sc">+</span> Edu_none<span class="sc">+</span> Educ_high<span class="sc">+</span> Educ_bacj, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span>logit), <span class="at">data=</span>Milk_probit_logit)</span>
<span id="cb16-3"><a href="generalized-linear-models.html#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="generalized-linear-models.html#cb16-4" tabindex="-1"></a><span class="fu">summary</span>(milk_model_logit)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = milk_local ~ age + sex + num_dependents + descriminatory_buyer + 
##     income + Edu_none + Educ_high + Educ_bacj, family = binomial(link = logit), 
##     data = Milk_probit_logit)
## 
## Coefficients:
##                       Estimate Std. Error z value Pr(&gt;|z|)   
## (Intercept)          -0.918174   0.878275  -1.045  0.29582   
## age                   0.025989   0.009741   2.668  0.00763 **
## sex                   0.662518   0.339971   1.949  0.05133 . 
## num_dependents        0.260138   0.131064   1.985  0.04716 * 
## descriminatory_buyer -0.817777   0.328015  -2.493  0.01266 * 
## income               -0.450150   0.150804  -2.985  0.00284 **
## Edu_none              0.027829   1.090379   0.026  0.97964   
## Educ_high             0.663716   0.589243   1.126  0.26000   
## Educ_bacj             1.363096   0.578054   2.358  0.01837 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 276.54  on 199  degrees of freedom
## Residual deviance: 233.02  on 191  degrees of freedom
## AIC: 251.02
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>The same model with a “probit” link function</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="generalized-linear-models.html#cb18-1" tabindex="-1"></a>milk_model_probit<span class="ot">=</span><span class="fu">glm</span>(milk_local<span class="sc">~</span>age<span class="sc">+</span>sex<span class="sc">+</span>num_dependents<span class="sc">+</span> descriminatory_buyer<span class="sc">+</span></span>
<span id="cb18-2"><a href="generalized-linear-models.html#cb18-2" tabindex="-1"></a>                          income<span class="sc">+</span> Edu_none<span class="sc">+</span> Educ_high<span class="sc">+</span> Educ_bacj, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span>probit), <span class="at">data=</span>Milk_probit_logit)</span>
<span id="cb18-3"><a href="generalized-linear-models.html#cb18-3" tabindex="-1"></a></span>
<span id="cb18-4"><a href="generalized-linear-models.html#cb18-4" tabindex="-1"></a><span class="fu">summary</span>(milk_model_probit)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = milk_local ~ age + sex + num_dependents + descriminatory_buyer + 
##     income + Edu_none + Educ_high + Educ_bacj, family = binomial(link = probit), 
##     data = Milk_probit_logit)
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)   
## (Intercept)          -0.56593    0.52262  -1.083  0.27887   
## age                   0.01554    0.00577   2.693  0.00708 **
## sex                   0.40903    0.20394   2.006  0.04489 * 
## num_dependents        0.15258    0.07768   1.964  0.04950 * 
## descriminatory_buyer -0.48533    0.19675  -2.467  0.01363 * 
## income               -0.26201    0.08831  -2.967  0.00301 **
## Edu_none              0.02380    0.64862   0.037  0.97073   
## Educ_high             0.40083    0.34670   1.156  0.24763   
## Educ_bacj             0.79879    0.33676   2.372  0.01769 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 276.54  on 199  degrees of freedom
## Residual deviance: 233.34  on 191  degrees of freedom
## AIC: 251.34
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>Evaluating assumptions of the binomial model</p>
<p>You need to check for linearity, independence of errors, homoscedasticity, overdispersion and normality of residuals.</p>
<ul>
<li>The response variable is binary</li>
<li>Check for the homoscedasticity of the residuals</li>
<li>Check for overdispersion</li>
</ul>
<p>In this first figure we have the Cook’s distance, an index of outliers and influential points. The values are in the order of the data set, thus a point a position 100, is the 100th point in the data set. The values are the Cook’s distance, the larger the value the more influential the point is. The red line is the threshold value of 4/n, where n is the number of observations. Points above the line are influential points.</p>
<p>Good news, the values are not extremely high, thus there are no influential points.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="generalized-linear-models.html#cb20-1" tabindex="-1"></a><span class="fu">library</span>(ggResidpanel) <span class="co"># a package to look at residuals</span></span>
<span id="cb20-2"><a href="generalized-linear-models.html#cb20-2" tabindex="-1"></a><span class="fu">resid_panel</span>(milk_model_logit, <span class="at">plots =</span> <span class="st">&quot;cookd&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>The easiest way to check dispersion in a model is to calculate the ratio of the residual deviance to the residual degrees of freedom.</p>
<p>Going back to the original output of the model, we can calculate the dispersion as follows</p>
<p>Coefficients:
Estimate Std. Error z value Pr(&gt;|z|)<br />
(Intercept) -0.918174 0.878275 -1.045 0.29582<br />
age 0.025989 0.009741 2.668 0.00763 <strong>
sex 0.662518 0.339971 1.949 0.05133 .
num_dependents 0.260138 0.131064 1.985 0.04716 *
descriminatory_buyer -0.817777 0.328015 -2.493 0.01266 *
income -0.450150 0.150804 -2.985 0.00284 </strong>
Edu_none 0.027829 1.090379 0.026 0.97964<br />
Educ_high 0.663716 0.589243 1.126 0.26000<br />
Educ_bacj 1.363096 0.578054 2.358 0.01837 *
—
Signif. codes: 0 ‘<em><strong>’ 0.001 ‘</strong>’ 0.01 ‘</em>’ 0.05 ‘.’ 0.1 ‘ ’ 1</p>
<p>(Dispersion parameter for binomial family taken to be 1)</p>
<pre><code>Null deviance: 276.54  on 199  degrees of freedom</code></pre>
<p>Residual deviance: 233.02 on 191 degrees of freedom
AIC: 251.02</p>
<p>NOte we have the residual variance at 233.02 on 191 df. The dispersion is calculated as follows</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="generalized-linear-models.html#cb22-1" tabindex="-1"></a>milk_model_logit<span class="sc">$</span>deviance<span class="sc">/</span>milk_model_logit<span class="sc">$</span>df.residual</span></code></pre></div>
<pre><code>## [1] 1.219975</code></pre>
<p>The dispersion is 1.22, which is greater than 1, thus there is some overdispersion.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="generalized-linear-models.html#cb24-1" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(milk_model_logit<span class="sc">$</span>deviance, milk_model_logit<span class="sc">$</span>df.residual)</span></code></pre></div>
<pre><code>## [1] 0.02051796</code></pre>
<p>The p value of the Chi square test returns a p = 0.02, which suggest that there is some overdisersion.</p>
<hr />
</div>
<div id="poisson-regression" class="section level2 hasAnchor" number="16.10">
<h2><span class="header-section-number">16.10</span> Poisson regression<a href="generalized-linear-models.html#poisson-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A poisson regression is used when the dependent variable is a count variable, that is, the number of events that occur in a fixed period of time. The Poisson distribution is used as a probability distribution and the <strong>log</strong> function is used as a link function. The model is called <strong>Poisson Regression</strong>.</p>
<p><span class="math display">\[\log\left(\lambda_i\right)=\beta_0+\beta_1X_i\]</span>
where the distribution is a Poisson with <span class="math inline">\(y_i\sim Poisson\left(\lambda_i\right)\)</span>.</p>
<p>Here let use the data from the number of accidents in a city and the number of cars in the city.</p>
<ul>
<li>Brooklyn_Bridge: The number cyclist on the Brooklyn Bridge on each day.</li>
<li>Precipitation = The precipitation in inches on that day</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="generalized-linear-models.html#cb26-1" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb26-2"><a href="generalized-linear-models.html#cb26-2" tabindex="-1"></a>NY_CITY_CYCLIST <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Data/NY_CITY_CYCLIST.csv&quot;</span>)</span>
<span id="cb26-3"><a href="generalized-linear-models.html#cb26-3" tabindex="-1"></a></span>
<span id="cb26-4"><a href="generalized-linear-models.html#cb26-4" tabindex="-1"></a>NY<span class="ot">=</span>NY_CITY_CYCLIST</span>
<span id="cb26-5"><a href="generalized-linear-models.html#cb26-5" tabindex="-1"></a></span>
<span id="cb26-6"><a href="generalized-linear-models.html#cb26-6" tabindex="-1"></a><span class="fu">head</span>(NY)</span></code></pre></div>
<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:GLM_11">
<caption style="caption-side: top; text-align: center;">(#tab:GLM_11) </caption><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Date</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Day</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">High_Tem_F</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Low_Temp_F</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Precipitation</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Brooklyn_Bridge</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Manhattan_Bridge</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Williamsburg_Bridge</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Queensboro_Bridge</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Total</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1-Apr</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Friday</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">78.1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">66&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.01</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.7e+03&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">3.13e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">4.12e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">2.55e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.15e+04</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2-Apr</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Saturday</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">55&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">48.9</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.15</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">827&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.65e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.56e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.88e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">6.92e+03</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">3-Apr</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Sunday</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">39.9</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">34&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.09</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">526&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.23e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.7e+03&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.31e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">4.76e+03</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4-Apr</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Monday</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">44.1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">33.1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.47</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">521&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.07e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.44e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.31e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.34e+03</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">5-Apr</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Tuesday</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">42.1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">26.1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.42e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">2.62e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">3.08e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">2.36e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">9.47e+03</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">6-Apr</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Wednesday</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">45&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">30&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.88e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.33e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.86e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.85e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.19e+04</td></tr>
</table>

<p>Visualize the data</p>
<ul>
<li>The data is not normally distributed.</li>
<li>The data is a count variable.</li>
<li>The regression line is not linear and is count (number of cylcist)</li>
<li>The 95% confidence interval is shown in the graph.</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="generalized-linear-models.html#cb27-1" tabindex="-1"></a><span class="fu">ggplot</span>(NY, <span class="fu">aes</span>(<span class="at">x=</span>Precipitation, <span class="at">y=</span>Brooklyn_Bridge))<span class="sc">+</span></span>
<span id="cb27-2"><a href="generalized-linear-models.html#cb27-2" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.01</span>, <span class="at">height =</span> <span class="fl">0.1</span>)<span class="sc">+</span> <span class="co"># point represents a count of number of cyclist for a specific day</span></span>
<span id="cb27-3"><a href="generalized-linear-models.html#cb27-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;glm&quot;</span>, <span class="at">method.args=</span><span class="fu">list</span>(<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>), <span class="at">se=</span>T)<span class="sc">+</span> </span>
<span id="cb27-4"><a href="generalized-linear-models.html#cb27-4" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Precipitation in inches&quot;</span>)<span class="sc">+</span></span>
<span id="cb27-5"><a href="generalized-linear-models.html#cb27-5" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of cyclist&quot;</span>)<span class="sc">+</span></span>
<span id="cb27-6"><a href="generalized-linear-models.html#cb27-6" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Creating the Poisson model</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="generalized-linear-models.html#cb28-1" tabindex="-1"></a>NY_model<span class="ot">=</span><span class="fu">glm</span>(Brooklyn_Bridge <span class="sc">~</span> Precipitation, <span class="at">data=</span>NY, <span class="at">family=</span>poisson)</span>
<span id="cb28-2"><a href="generalized-linear-models.html#cb28-2" tabindex="-1"></a><span class="fu">summary</span>(NY_model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Brooklyn_Bridge ~ Precipitation, family = poisson, 
##     data = NY)
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    8.086430   0.001378 5868.99   &lt;2e-16 ***
## Precipitation -0.565548   0.006023  -93.91   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 91743  on 197  degrees of freedom
## Residual deviance: 81450  on 196  degrees of freedom
##   (17 observations deleted due to missingness)
## AIC: 83389
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Testing for overdispersion of Poisson model. In this case the model is highly obverdisperded. The dispersion is 418 and the p-value is p &lt; 0.001.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="generalized-linear-models.html#cb30-1" tabindex="-1"></a><span class="fu">library</span>(AER)</span></code></pre></div>
<pre><code>## Loading required package: car</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## 
## Attaching package: &#39;car&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     recode</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     some</code></pre>
<pre><code>## Loading required package: lmtest</code></pre>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## Loading required package: sandwich</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="generalized-linear-models.html#cb41-1" tabindex="-1"></a><span class="fu">dispersiontest</span>(NY_model)</span></code></pre></div>
<pre><code>## 
##  Overdispersion test
## 
## data:  NY_model
## z = 4.8057, p-value = 7.71e-07
## alternative hypothesis: true dispersion is greater than 1
## sample estimates:
## dispersion 
##   418.2393</code></pre>
<hr />
</div>
<div id="negative-binomial-regression" class="section level2 hasAnchor" number="16.11">
<h2><span class="header-section-number">16.11</span> Negative binomial regression<a href="generalized-linear-models.html#negative-binomial-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A negative binomial regression is used when the dependent variable is a count variable and that the data suggests overdipersion. Overdispersion is when the variance is greater than the mean. The Poisson distribution is used as a probability distribution and the <strong>log</strong> function is used as a link function. The model is called <strong>Negative Binomial Regression</strong>.</p>
<p><span class="math display">\[\log\left(\lambda_i\right)=\beta_0+\beta_1X_i\]</span>
where the distribution is a negative binomial with <span class="math inline">\(y_i\sim NegBinomial\left(\lambda_i\right)\)</span>.</p>
<p>We will start by calculating the mean and vaiance of the above data set and detemrine if there is overdisperion</p>
<p>The function required <strong>dispersiontest</strong> is available in the package <strong>AER</strong>. The function will return the dispersion parameter and the p-value. If the p-value is less than 0.05, then there is overdispersion.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="generalized-linear-models.html#cb43-1" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb43-2"><a href="generalized-linear-models.html#cb43-2" tabindex="-1"></a>model<span class="ot">=</span><span class="fu">glm</span>(Brooklyn_Bridge <span class="sc">~</span> Precipitation, <span class="at">data=</span>NY, <span class="at">family=</span>poisson)</span></code></pre></div>
<p>Note that the alpha is very large and the p-value is less than 0.05, which indicates that there is overdispersion. We will now create the negative binomial model. We will use the MASS library and the function <strong>glm.nb</strong> to create the model. The function is used to create a negative binomial model. The function is used in the same way as the glm function, but the family is set to negative binomial.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="generalized-linear-models.html#cb44-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb44-2"><a href="generalized-linear-models.html#cb44-2" tabindex="-1"></a></span>
<span id="cb44-3"><a href="generalized-linear-models.html#cb44-3" tabindex="-1"></a><span class="fu">ggplot</span>(NY, <span class="fu">aes</span>(<span class="at">x=</span>Precipitation, <span class="at">y=</span>Brooklyn_Bridge))<span class="sc">+</span></span>
<span id="cb44-4"><a href="generalized-linear-models.html#cb44-4" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.01</span>, <span class="at">height =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb44-5"><a href="generalized-linear-models.html#cb44-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;glm.nb&quot;</span>, <span class="at">se=</span>T)<span class="sc">+</span> </span>
<span id="cb44-6"><a href="generalized-linear-models.html#cb44-6" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Precipitation in inches&quot;</span>)<span class="sc">+</span></span>
<span id="cb44-7"><a href="generalized-linear-models.html#cb44-7" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of cyclist&quot;</span>)<span class="sc">+</span></span>
<span id="cb44-8"><a href="generalized-linear-models.html#cb44-8" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/GLM_14-1.png" width="672" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="generalized-linear-models.html#cb45-1" tabindex="-1"></a>NY_model_nb<span class="ot">=</span>MASS<span class="sc">::</span><span class="fu">glm.nb</span>(Brooklyn_Bridge <span class="sc">~</span> Precipitation, <span class="at">data=</span>NY)</span>
<span id="cb45-2"><a href="generalized-linear-models.html#cb45-2" tabindex="-1"></a></span>
<span id="cb45-3"><a href="generalized-linear-models.html#cb45-3" tabindex="-1"></a><span class="fu">summary</span>(NY_model_nb) <span class="co"># note that theta is a the measure of dispersion</span></span></code></pre></div>
<pre><code>## 
## Call:
## MASS::glm.nb(formula = Brooklyn_Bridge ~ Precipitation, data = NY, 
##     init.theta = 6.243688849, link = log)
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    8.08310    0.03105  260.33  &lt; 2e-16 ***
## Precipitation -0.53141    0.10670   -4.98 6.35e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Negative Binomial(6.2437) family taken to be 1)
## 
##     Null deviance: 226.06  on 197  degrees of freedom
## Residual deviance: 203.38  on 196  degrees of freedom
##   (17 observations deleted due to missingness)
## AIC: 3360.2
## 
## Number of Fisher Scoring iterations: 1
## 
## 
##               Theta:  6.244 
##           Std. Err.:  0.613 
## 
##  2 x log-likelihood:  -3354.199</code></pre>
<p>We interpret the results as follows</p>
<ul>
<li>The precipitation has a negative effect on the number of cyclist (negative sign). With precipitation (exp(coef) = -0.53) which states that there is 47% decrease in the number of cyclist for <strong>each inch of precipitation</strong>.</li>
</ul>
<p>We can reconvert the coefficient to a positive value by taking the exponential of the coefficient.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="generalized-linear-models.html#cb47-1" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(NY_model_nb))</span></code></pre></div>
<pre><code>##   (Intercept) Precipitation 
##   3239.274773      0.587776</code></pre>
<p>In this case to evaluate overdispersion in the negative binomial model we use the function <strong>odTest</strong> from the package <strong>pscl</strong>. The function will return the dispersion parameter and the p-value. If the p-value is less than 0.05, then there is overdispersion.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="generalized-linear-models.html#cb49-1" tabindex="-1"></a><span class="fu">library</span>(pscl)</span></code></pre></div>
<pre><code>## Classes and Methods for R originally developed in the
## Political Science Computational Laboratory
## Department of Political Science
## Stanford University (2002-2015),
## by and under the direction of Simon Jackman.
## hurdle and zeroinfl functions by Achim Zeileis.</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="generalized-linear-models.html#cb51-1" tabindex="-1"></a><span class="fu">odTest</span>(NY_model_nb)</span></code></pre></div>
<pre><code>## Likelihood ratio test of H0: Poisson, as restricted NB model:
## n.b., the distribution of the test-statistic under H0 is non-standard
## e.g., see help(odTest) for details/references
## 
## Critical value of test statistic at the alpha= 0.05 level: 2.7055 
## Chi-Square Test Statistic =  80031.1386 p-value = &lt; 2.2e-16</code></pre>
<hr />
<div id="comparing-dispersion-models" class="section level3 hasAnchor" number="16.11.1">
<h3><span class="header-section-number">16.11.1</span> Comparing dispersion models<a href="generalized-linear-models.html#comparing-dispersion-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Comparing the dispersion of a Poisson and a negative binomial model. The approach is to use a likelyhood ratio test. Note the fitted log-likelihood of the NB model (-1677.1) is much large/better than the Poisson model (-41692.7). The p-value is less than 0.05, thus the negative binomial model is better than the Poisson model.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="generalized-linear-models.html#cb53-1" tabindex="-1"></a>    <span class="co"># Calculate the likelihood ratio statistic</span></span>
<span id="cb53-2"><a href="generalized-linear-models.html#cb53-2" tabindex="-1"></a>    likelihood_ratio <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(NY_model_nb) <span class="sc">-</span> <span class="fu">logLik</span>(NY_model))</span>
<span id="cb53-3"><a href="generalized-linear-models.html#cb53-3" tabindex="-1"></a>    </span>
<span id="cb53-4"><a href="generalized-linear-models.html#cb53-4" tabindex="-1"></a><span class="fu">logLik</span>(NY_model_nb) <span class="co"># the log likelihood of the negative binomial model</span></span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; -1677.1 (df=3)</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="generalized-linear-models.html#cb55-1" tabindex="-1"></a><span class="fu">logLik</span>(NY_model) <span class="co"># the log likelihood of the Poisson model</span></span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; -41692.67 (df=2)</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="generalized-linear-models.html#cb57-1" tabindex="-1"></a>    <span class="co"># Degrees of freedom (df) is the difference in the number of parameters</span></span>
<span id="cb57-2"><a href="generalized-linear-models.html#cb57-2" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(NY_model_nb)) <span class="sc">-</span> <span class="fu">length</span>(<span class="fu">coef</span>(NY_model))</span>
<span id="cb57-3"><a href="generalized-linear-models.html#cb57-3" tabindex="-1"></a>    </span>
<span id="cb57-4"><a href="generalized-linear-models.html#cb57-4" tabindex="-1"></a>    <span class="co"># Perform the chi-squared test</span></span>
<span id="cb57-5"><a href="generalized-linear-models.html#cb57-5" tabindex="-1"></a>    p_value <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(likelihood_ratio, df)</span>
<span id="cb57-6"><a href="generalized-linear-models.html#cb57-6" tabindex="-1"></a>    </span>
<span id="cb57-7"><a href="generalized-linear-models.html#cb57-7" tabindex="-1"></a>    <span class="co"># Print the p-value</span></span>
<span id="cb57-8"><a href="generalized-linear-models.html#cb57-8" tabindex="-1"></a>    <span class="fu">print</span>(p_value)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; 0 (df=3)</code></pre>
</div>
<div id="alternative-approach-to-compare-the-poisson-and-the-negative-binomial-model." class="section level3 hasAnchor" number="16.11.2">
<h3><span class="header-section-number">16.11.2</span> Alternative approach to compare the Poisson and the negative binomial model.<a href="generalized-linear-models.html#alternative-approach-to-compare-the-poisson-and-the-negative-binomial-model." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can also use the function <strong>lrtest</strong> from the package <strong>lmtest</strong> to perform the likelihood ratio test. The function will return the likelihood ratio test statistic and the p-value. If the p-value is less than 0.05, then the negative binomial model is better than the Poisson model.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="generalized-linear-models.html#cb59-1" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb59-2"><a href="generalized-linear-models.html#cb59-2" tabindex="-1"></a><span class="fu">lrtest</span>(NY_model_nb, NY_model)</span></code></pre></div>
<pre><code>## Warning in modelUpdate(objects[[i - 1]], objects[[i]]): original model was of
## class &quot;negbin&quot;, updated model is of class &quot;glm&quot;</code></pre>
<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  ">
<col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">#Df</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">LogLik</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Df</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Chisq</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Pr(&gt;Chisq)</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">3</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-1.68e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-4.17e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">8e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0</td></tr>
</table>

<p>Overlaying the Poisson and the negative binomial models</p>
<p>NEED To FIND a better example</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="generalized-linear-models.html#cb61-1" tabindex="-1"></a><span class="fu">ggplot</span>(NY, <span class="fu">aes</span>(<span class="at">x=</span>Precipitation, <span class="at">y=</span>Brooklyn_Bridge))<span class="sc">+</span></span>
<span id="cb61-2"><a href="generalized-linear-models.html#cb61-2" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.01</span>, <span class="at">height =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb61-3"><a href="generalized-linear-models.html#cb61-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;glm&quot;</span>, <span class="at">method.args=</span><span class="fu">list</span>(<span class="at">family=</span><span class="st">&quot;poisson&quot;</span>), <span class="at">se=</span>T, <span class="at">color=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span> </span>
<span id="cb61-4"><a href="generalized-linear-models.html#cb61-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;glm.nb&quot;</span>, <span class="at">se=</span>T, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span> </span>
<span id="cb61-5"><a href="generalized-linear-models.html#cb61-5" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Precipitation in inches&quot;</span>)<span class="sc">+</span></span>
<span id="cb61-6"><a href="generalized-linear-models.html#cb61-6" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of cyclist&quot;</span>)<span class="sc">+</span></span>
<span id="cb61-7"><a href="generalized-linear-models.html#cb61-7" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/GLM_16-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="quantile-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multinomial-logit-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/RaymondLTremblay/Quantitative_Agricultural_Economics/edit/main/16_GLM.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/RaymondLTremblay/Quantitative_Agricultural_Economics/blob/main/16_GLM.Rmd",
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
