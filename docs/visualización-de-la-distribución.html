<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 18 Visualización de la distribución | Quantitative Agricultural Economics</title>
  <meta name="description" content="Chapter 18 Visualización de la distribución | Quantitative Agricultural Economics" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 18 Visualización de la distribución | Quantitative Agricultural Economics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 18 Visualización de la distribución | Quantitative Agricultural Economics" />
  
  
  

<meta name="author" content="Raymond L. Tremblay" />


<meta name="date" content="2024-12-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="beta-regression.html"/>
<link rel="next" href="auto-regressive-vectorial-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">QAE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Down the rabbit-hole</a></li>
<li class="chapter" data-level="2" data-path="introduction-to-r-and-posit-rstudio.html"><a href="introduction-to-r-and-posit-rstudio.html"><i class="fa fa-check"></i><b>2</b> Introduction to R and POSIT (RStudio)</a></li>
<li class="chapter" data-level="3" data-path="packages-and-functions-in-r.html"><a href="packages-and-functions-in-r.html"><i class="fa fa-check"></i><b>3</b> Packages and Functions in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="packages-and-functions-in-r.html"><a href="packages-and-functions-in-r.html#what-is-an-r-package"><i class="fa fa-check"></i><b>3.1</b> What is an R package</a></li>
<li class="chapter" data-level="3.2" data-path="packages-and-functions-in-r.html"><a href="packages-and-functions-in-r.html#understanding-funcions-in-r"><i class="fa fa-check"></i><b>3.2</b> Understanding funcions in R</a></li>
<li class="chapter" data-level="3.3" data-path="packages-and-functions-in-r.html"><a href="packages-and-functions-in-r.html#installing-and-loading-packages"><i class="fa fa-check"></i><b>3.3</b> Installing and loading packages</a></li>
<li class="chapter" data-level="3.4" data-path="packages-and-functions-in-r.html"><a href="packages-and-functions-in-r.html#surfing-the-web-for-packages-and-functions"><i class="fa fa-check"></i><b>3.4</b> Surfing the web for packages and functions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>4</b> Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data.html"><a href="data.html#adding-data-directly-to-the-document"><i class="fa fa-check"></i><b>4.1</b> Adding data directly to the document</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data.html"><a href="data.html#using-the-function-tibble"><i class="fa fa-check"></i><b>4.1.1</b> Using the function <strong>tibble</strong></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data.html"><a href="data.html#loading-data-from-a-file"><i class="fa fa-check"></i><b>4.2</b> Loading data from a file</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data.html"><a href="data.html#csv-file"><i class="fa fa-check"></i><b>4.2.1</b> .csv file</a></li>
<li class="chapter" data-level="4.2.2" data-path="data.html"><a href="data.html#excel-file"><i class="fa fa-check"></i><b>4.2.2</b> .excel file</a></li>
<li class="chapter" data-level="4.2.3" data-path="data.html"><a href="data.html#txt-file"><i class="fa fa-check"></i><b>4.2.3</b> .txt file</a></li>
<li class="chapter" data-level="4.2.4" data-path="data.html"><a href="data.html#spss-file"><i class="fa fa-check"></i><b>4.2.4</b> .spss file</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data.html"><a href="data.html#loading-data-from-the-web"><i class="fa fa-check"></i><b>4.3</b> Loading data from the web</a></li>
<li class="chapter" data-level="4.4" data-path="data.html"><a href="data.html#section"><i class="fa fa-check"></i><b>4.4</b> </a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>5</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#cleaning-the-names-of-the-variables-with-janitor"><i class="fa fa-check"></i><b>5.1</b> cleaning the names of the variables with <strong>janitor</strong></a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling.html"><a href="data-wrangling.html#changing-the-names-to-variables"><i class="fa fa-check"></i><b>5.2</b> Changing the names to variables</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling.html"><a href="data-wrangling.html#deleting-variables"><i class="fa fa-check"></i><b>5.3</b> Deleting variables</a></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling.html"><a href="data-wrangling.html#changing-names-of-levelsfactors"><i class="fa fa-check"></i><b>5.4</b> changing names of levels/factors</a></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling.html"><a href="data-wrangling.html#finding-missing-values"><i class="fa fa-check"></i><b>5.5</b> Finding missing values</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="understanding-your-data.html"><a href="understanding-your-data.html"><i class="fa fa-check"></i><b>6</b> Understanding your data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="understanding-your-data.html"><a href="understanding-your-data.html#functions-to-evaluate-your-data"><i class="fa fa-check"></i><b>6.1</b> Functions to evaluate your data</a></li>
<li class="chapter" data-level="6.2" data-path="understanding-your-data.html"><a href="understanding-your-data.html#dimensions-of-the-data"><i class="fa fa-check"></i><b>6.2</b> dimensions of the data</a></li>
<li class="chapter" data-level="6.3" data-path="understanding-your-data.html"><a href="understanding-your-data.html#structure-of-the-data"><i class="fa fa-check"></i><b>6.3</b> structure of the data</a></li>
<li class="chapter" data-level="6.4" data-path="understanding-your-data.html"><a href="understanding-your-data.html#levels-of-the-variables"><i class="fa fa-check"></i><b>6.4</b> Levels of the variables</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="test-of-normality.html"><a href="test-of-normality.html"><i class="fa fa-check"></i><b>7</b> Test of normality</a>
<ul>
<li class="chapter" data-level="7.1" data-path="test-of-normality.html"><a href="test-of-normality.html#shapiro-wilk-normality-test"><i class="fa fa-check"></i><b>7.1</b> Shapiro-Wilk normality test</a></li>
<li class="chapter" data-level="7.2" data-path="test-of-normality.html"><a href="test-of-normality.html#the-shapiro-francia-normality-test"><i class="fa fa-check"></i><b>7.2</b> The shapiro-Francia normality test</a></li>
<li class="chapter" data-level="7.3" data-path="test-of-normality.html"><a href="test-of-normality.html#anderson-darling-normality-test"><i class="fa fa-check"></i><b>7.3</b> Anderson-Darling normality test</a></li>
<li class="chapter" data-level="7.4" data-path="test-of-normality.html"><a href="test-of-normality.html#cramer-von-mises-test-of-normality"><i class="fa fa-check"></i><b>7.4</b> Cramer-von Mises test of normality</a></li>
<li class="chapter" data-level="7.5" data-path="test-of-normality.html"><a href="test-of-normality.html#lilliefors-test-of-normality"><i class="fa fa-check"></i><b>7.5</b> Lilliefors test of normality</a></li>
<li class="chapter" data-level="7.6" data-path="test-of-normality.html"><a href="test-of-normality.html#visualizing-the-data"><i class="fa fa-check"></i><b>7.6</b> Visualizing the data</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="test-of-normality.html"><a href="test-of-normality.html#qq-plot"><i class="fa fa-check"></i><b>7.6.1</b> qq-plot</a></li>
<li class="chapter" data-level="7.6.2" data-path="test-of-normality.html"><a href="test-of-normality.html#histogram"><i class="fa fa-check"></i><b>7.6.2</b> Histogram</a></li>
<li class="chapter" data-level="7.6.3" data-path="test-of-normality.html"><a href="test-of-normality.html#density-plot"><i class="fa fa-check"></i><b>7.6.3</b> Density plot</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="test-of-normality.html"><a href="test-of-normality.html#remove-the-outlier-from-the-day1-hygiene-score"><i class="fa fa-check"></i><b>7.7</b> Remove the outlier from the day1 hygiene score</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="test-of-normality.html"><a href="test-of-normality.html#the-f-test-of-equality-of-variance"><i class="fa fa-check"></i><b>7.7.1</b> The F-test of equality of variance</a></li>
<li class="chapter" data-level="7.7.2" data-path="test-of-normality.html"><a href="test-of-normality.html#bartletts-test-of-equality-of-variance"><i class="fa fa-check"></i><b>7.7.2</b> Bartlett’s test of equality of variance</a></li>
<li class="chapter" data-level="7.7.3" data-path="test-of-normality.html"><a href="test-of-normality.html#brown-forsythe-test-of-equality-of-variance"><i class="fa fa-check"></i><b>7.7.3</b> Brown-Forsythe test of equality of variance</a></li>
<li class="chapter" data-level="7.7.4" data-path="test-of-normality.html"><a href="test-of-normality.html#levenes-test-testing-for-assumption-of-normality-among-groups"><i class="fa fa-check"></i><b>7.7.4</b> Levene’s Test: testing for assumption of normality among groups</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="non-parametric-test.html"><a href="non-parametric-test.html"><i class="fa fa-check"></i><b>8</b> Non-parametric test</a>
<ul>
<li class="chapter" data-level="8.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#altenative-to-non-parametric-tests"><i class="fa fa-check"></i><b>8.1</b> Altenative to non-parametric tests</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="scatter-plots.html"><a href="scatter-plots.html"><i class="fa fa-check"></i><b>9</b> Scatter Plots</a>
<ul>
<li class="chapter" data-level="9.1" data-path="scatter-plots.html"><a href="scatter-plots.html#basic-scatter-plots"><i class="fa fa-check"></i><b>9.1</b> Basic scatter plots</a></li>
<li class="chapter" data-level="9.2" data-path="scatter-plots.html"><a href="scatter-plots.html#scatter-plots-with-jitter"><i class="fa fa-check"></i><b>9.2</b> Scatter plots with jitter</a></li>
<li class="chapter" data-level="9.3" data-path="scatter-plots.html"><a href="scatter-plots.html#scatter-plots-with-marginal-histograms"><i class="fa fa-check"></i><b>9.3</b> Scatter plots with marginal histograms</a></li>
<li class="chapter" data-level="9.4" data-path="scatter-plots.html"><a href="scatter-plots.html#scatter-plots-for-multiple-variables"><i class="fa fa-check"></i><b>9.4</b> Scatter plots for multiple variables</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-regression-model.html"><a href="linear-regression-model.html"><i class="fa fa-check"></i><b>10</b> Linear regression model</a>
<ul>
<li class="chapter" data-level="10.1" data-path="linear-regression-model.html"><a href="linear-regression-model.html#visualize-the-model-with-ggplot2"><i class="fa fa-check"></i><b>10.1</b> Visualize the model with ggplot2</a></li>
<li class="chapter" data-level="10.2" data-path="linear-regression-model.html"><a href="linear-regression-model.html#the-linear-model"><i class="fa fa-check"></i><b>10.2</b> the linear model</a></li>
<li class="chapter" data-level="10.3" data-path="linear-regression-model.html"><a href="linear-regression-model.html#the-summary-of-the-model"><i class="fa fa-check"></i><b>10.3</b> the summary of the model</a></li>
<li class="chapter" data-level="10.4" data-path="linear-regression-model.html"><a href="linear-regression-model.html#the-assumptions-of-the-model"><i class="fa fa-check"></i><b>10.4</b> the assumptions of the model</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ring-chart-alternative-to-pie-chart.html"><a href="ring-chart-alternative-to-pie-chart.html"><i class="fa fa-check"></i><b>11</b> Ring chart (alternative to pie chart)</a></li>
<li class="chapter" data-level="12" data-path="histogramsdensity-plots.html"><a href="histogramsdensity-plots.html"><i class="fa fa-check"></i><b>12</b> Histograms/Density Plots</a></li>
<li class="chapter" data-level="13" data-path="boxplots.html"><a href="boxplots.html"><i class="fa fa-check"></i><b>13</b> Boxplots</a></li>
<li class="chapter" data-level="14" data-path="other-visualizations.html"><a href="other-visualizations.html"><i class="fa fa-check"></i><b>14</b> Other visualizations</a></li>
<li class="chapter" data-level="15" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>15</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="15.1" data-path="linear-regression.html"><a href="linear-regression.html#model-of-linear-regression"><i class="fa fa-check"></i><b>15.1</b> Model of linear regression</a></li>
<li class="chapter" data-level="15.2" data-path="linear-regression.html"><a href="linear-regression.html#assumption-of-linear-regression"><i class="fa fa-check"></i><b>15.2</b> Assumption of linear regression</a></li>
<li class="chapter" data-level="15.3" data-path="linear-regression.html"><a href="linear-regression.html#visualization-of-the-model"><i class="fa fa-check"></i><b>15.3</b> Visualization of the model</a></li>
<li class="chapter" data-level="15.4" data-path="linear-regression.html"><a href="linear-regression.html#quantile-regression"><i class="fa fa-check"></i><b>15.4</b> Quantile Regression</a></li>
<li class="chapter" data-level="15.5" data-path="linear-regression.html"><a href="linear-regression.html#the-model"><i class="fa fa-check"></i><b>15.5</b> The model</a></li>
<li class="chapter" data-level="15.6" data-path="linear-regression.html"><a href="linear-regression.html#the-assumptions"><i class="fa fa-check"></i><b>15.6</b> The assumptions</a></li>
<li class="chapter" data-level="15.7" data-path="linear-regression.html"><a href="linear-regression.html#visualization"><i class="fa fa-check"></i><b>15.7</b> Visualization</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>16</b> Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="16.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#binomial-regression"><i class="fa fa-check"></i><b>16.1</b> Binomial regression</a></li>
<li class="chapter" data-level="16.2" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#poisson-regression"><i class="fa fa-check"></i><b>16.2</b> Poisson regression</a></li>
<li class="chapter" data-level="16.3" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#negative-binomial-regression"><i class="fa fa-check"></i><b>16.3</b> Negative binomial regression</a></li>
<li class="chapter" data-level="16.4" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#multinomial-logit-analysis"><i class="fa fa-check"></i><b>16.4</b> Multinomial logit analysis</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#model"><i class="fa fa-check"></i><b>16.4.1</b> Model</a></li>
<li class="chapter" data-level="16.4.2" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#assumptions"><i class="fa fa-check"></i><b>16.4.2</b> Assumptions</a></li>
<li class="chapter" data-level="16.4.3" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#post-estimation-analysis"><i class="fa fa-check"></i><b>16.4.3</b> Post estimation analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="beta-regression.html"><a href="beta-regression.html"><i class="fa fa-check"></i><b>17</b> Beta Regression</a>
<ul>
<li class="chapter" data-level="17.1" data-path="beta-regression.html"><a href="beta-regression.html#what-is-a-beta-regression"><i class="fa fa-check"></i><b>17.1</b> What is a beta regression?</a></li>
<li class="chapter" data-level="17.2" data-path="beta-regression.html"><a href="beta-regression.html#what-is-the-problem-with-the-data"><i class="fa fa-check"></i><b>17.2</b> What is the problem with the data?</a></li>
<li class="chapter" data-level="17.3" data-path="beta-regression.html"><a href="beta-regression.html#first-step-what-is-a-beta-distribution"><i class="fa fa-check"></i><b>17.3</b> First step, what is a beta distribution?</a></li>
<li class="chapter" data-level="17.4" data-path="beta-regression.html"><a href="beta-regression.html#wikipedia"><i class="fa fa-check"></i><b>17.4</b> Wikipedia</a></li>
<li class="chapter" data-level="17.5" data-path="beta-regression.html"><a href="beta-regression.html#proporción-de-fumadores-por-diferentes-paises."><i class="fa fa-check"></i><b>17.5</b> Proporción de fumadores por diferentes paises.</a></li>
<li class="chapter" data-level="17.6" data-path="beta-regression.html"><a href="beta-regression.html#convertir-el-promedio-y-varianza-en-shape-alpha-y-beta"><i class="fa fa-check"></i><b>17.6</b> Convertir el promedio y varianza en shape <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span></a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="visualización-de-la-distribución.html"><a href="visualización-de-la-distribución.html"><i class="fa fa-check"></i><b>18</b> Visualización de la distribución</a>
<ul>
<li class="chapter" data-level="18.1" data-path="visualización-de-la-distribución.html"><a href="visualización-de-la-distribución.html#regresión-beta-proporción-de-frutos-por-cantidad-de-flores"><i class="fa fa-check"></i><b>18.1</b> Regresión beta, proporción de frutos por cantidad de flores</a></li>
<li class="chapter" data-level="18.2" data-path="visualización-de-la-distribución.html"><a href="visualización-de-la-distribución.html#visualizar-un-gráfico-de-regresión-beta"><i class="fa fa-check"></i><b>18.2</b> Visualizar un gráfico de regresión beta</a></li>
<li class="chapter" data-level="18.3" data-path="visualización-de-la-distribución.html"><a href="visualización-de-la-distribución.html#comparar-el-modelo-tradicional-lineal-versus-un-modelo-beta"><i class="fa fa-check"></i><b>18.3</b> Comparar el modelo tradicional lineal versus un modelo beta</a></li>
<li class="chapter" data-level="18.4" data-path="visualización-de-la-distribución.html"><a href="visualización-de-la-distribución.html#distribución-de-valores-especificos"><i class="fa fa-check"></i><b>18.4</b> Distribución de valores especificos</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="auto-regressive-vectorial-analysis.html"><a href="auto-regressive-vectorial-analysis.html"><i class="fa fa-check"></i><b>19</b> Auto Regressive Vectorial Analysis</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative Agricultural Economics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualización-de-la-distribución" class="section level1 hasAnchor" number="18">
<h1><span class="header-section-number">Chapter 18</span> Visualización de la distribución<a href="visualización-de-la-distribución.html#visualización-de-la-distribución" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Sobreponemos el intervalo de confianza de la mediana sobre la distribución beta</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="visualización-de-la-distribución.html#cb21-1" tabindex="-1"></a><span class="fu">ggplot</span>(Smokers, <span class="fu">aes</span>(Y2000P))<span class="sc">+</span></span>
<span id="cb21-2"><a href="visualización-de-la-distribución.html#cb21-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..), <span class="at">bins=</span><span class="dv">20</span>, <span class="at">colour=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;grey50&quot;</span>)<span class="sc">+</span></span>
<span id="cb21-3"><a href="visualización-de-la-distribución.html#cb21-3" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="fu">aes</span>(<span class="at">x =</span> Smokers<span class="sc">$</span>Y2000P, <span class="at">y =</span> ..y..), <span class="at">fun =</span> dbeta, <span class="at">colour=</span><span class="st">&quot;red&quot;</span>, <span class="at">n =</span> <span class="dv">100</span>,</span>
<span id="cb21-4"><a href="visualización-de-la-distribución.html#cb21-4" tabindex="-1"></a>                      <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="fl">3.593</span>, <span class="at">shape2 =</span> <span class="fl">9.185</span>))<span class="sc">+</span></span>
<span id="cb21-5"><a href="visualización-de-la-distribución.html#cb21-5" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span><span class="fl">0.2320</span>, <span class="at">colour=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span> <span class="co"># El intervalo de confianza del promedio</span></span>
<span id="cb21-6"><a href="visualización-de-la-distribución.html#cb21-6" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span><span class="fl">0.2768</span>, <span class="at">colour=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb21-7"><a href="visualización-de-la-distribución.html#cb21-7" tabindex="-1"></a>  rlt_theme<span class="sc">+</span></span>
<span id="cb21-8"><a href="visualización-de-la-distribución.html#cb21-8" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Proporción de fumadores por Pais&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="visualización-de-la-distribución.html#cb22-1" tabindex="-1"></a><span class="fu">library</span>(betareg) <span class="co"># El paquete para hacer regresión beta</span></span>
<span id="cb22-2"><a href="visualización-de-la-distribución.html#cb22-2" tabindex="-1"></a><span class="fu">library</span>(ggversa) <span class="co"># paquete para los datos</span></span>
<span id="cb22-3"><a href="visualización-de-la-distribución.html#cb22-3" tabindex="-1"></a><span class="fu">attach</span>(dipodium)</span>
<span id="cb22-4"><a href="visualización-de-la-distribución.html#cb22-4" tabindex="-1"></a><span class="fu">head</span>(dipodium, <span class="at">n=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 21
##   `Tree Number` `Tree species`   DBH `Plant number` `Ramet number` Distance
##           &lt;int&gt; &lt;chr&gt;          &lt;dbl&gt;          &lt;int&gt;          &lt;int&gt;    &lt;dbl&gt;
## 1             1 E.o               75              1              1     2.47
## 2             1 E.o               76              2              1     1.97
## 3             2 E.o               76              3              1     1.95
## 4             3 E.o               58              4              1     3.24
## # ℹ 15 more variables: Orientation &lt;dbl&gt;, Number_of_Flowers &lt;int&gt;,
## #   Height_Inflo &lt;int&gt;, Herbivory &lt;chr&gt;, RowPosition_NF &lt;int&gt;,
## #   Number_Flowers_position &lt;int&gt;, Number_of_fruits &lt;int&gt;, Perc_FR_set &lt;dbl&gt;,
## #   pardalinum_or_roseum &lt;chr&gt;, Fruit_position_effect &lt;int&gt;,
## #   Frutos_si_o_no &lt;int&gt;, P_or_R_Infl_Lenght &lt;chr&gt;, `Num of fruits` &lt;int&gt;,
## #   Species_Name &lt;chr&gt;, `Cardinal orientation` &lt;int&gt;</code></pre>
<hr />
<div id="regresión-beta-proporción-de-frutos-por-cantidad-de-flores" class="section level2 hasAnchor" number="18.1">
<h2><span class="header-section-number">18.1</span> Regresión beta, proporción de frutos por cantidad de flores<a href="visualización-de-la-distribución.html#regresión-beta-proporción-de-frutos-por-cantidad-de-flores" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ahora haremos el primer análisis de regresión donde nuestra respuesta es una proporción.</p>
<p>Los datos provienen de una especie de orquidea de Australia, <em>Dipodium roseum</em>, recolectado por RLT en 2004-2005. Vamos a evaluar la relación entre el número de flores y la proporción de frutos por planta. El primer paso es asegarar que no haya valores de 0 y 1. En este caso no hay ni una planta que tiene 100% de frutos, pero si hay individuos que tienen cero frutos.</p>
<ul>
<li><p>RECUERDA x &gt;0 y &lt;1. NO se acepta 0 o 1. Entonces a los valores de 0 se le puede añadir un valor mínimo como 0.001 y a los 1 restar 0.001. En realidad esta modificación no impacta la interpretación de los resultados.</p></li>
<li><p>se remueva también del archivo los NA.</p></li>
<li><p>Nota que el modelo se construye como un modelo lineal <strong>betareg(y~x, data =na.omit(df))</strong>. Las variables del archivo son <strong>PropFR</strong>, el proporción de frutos (número de frutos/números de flores) por cada individuo y el número de flores, <strong>Number_of_Flowers</strong>.</p></li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="visualización-de-la-distribución.html#cb24-1" tabindex="-1"></a><span class="co">#head(dipodium)</span></span>
<span id="cb24-2"><a href="visualización-de-la-distribución.html#cb24-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb24-3"><a href="visualización-de-la-distribución.html#cb24-3" tabindex="-1"></a>dipodium<span class="sc">$</span>PropFR<span class="ot">=</span>dipodium<span class="sc">$</span>Perc_FR_set<span class="fl">+0.0001</span> <span class="co"># solucionar para remover los cero</span></span>
<span id="cb24-4"><a href="visualización-de-la-distribución.html#cb24-4" tabindex="-1"></a><span class="co">#dipodium$PropFR</span></span>
<span id="cb24-5"><a href="visualización-de-la-distribución.html#cb24-5" tabindex="-1"></a>dipodium2<span class="ot">=</span>dipodium <span class="sc">%&gt;%</span> </span>
<span id="cb24-6"><a href="visualización-de-la-distribución.html#cb24-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(PropFR, Number_of_Flowers,Height_Inflo, Distance) <span class="sc">%&gt;%</span> </span>
<span id="cb24-7"><a href="visualización-de-la-distribución.html#cb24-7" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(PropFR, Number_of_Flowers,Height_Inflo, Distance))</span>
<span id="cb24-8"><a href="visualización-de-la-distribución.html#cb24-8" tabindex="-1"></a><span class="co">#dipodium2</span></span>
<span id="cb24-9"><a href="visualización-de-la-distribución.html#cb24-9" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="at">x=</span>dipodium2, <span class="at">file=</span><span class="st">&quot;dipodium2.csv&quot;</span>)</span>
<span id="cb24-10"><a href="visualización-de-la-distribución.html#cb24-10" tabindex="-1"></a></span>
<span id="cb24-11"><a href="visualización-de-la-distribución.html#cb24-11" tabindex="-1"></a></span>
<span id="cb24-12"><a href="visualización-de-la-distribución.html#cb24-12" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb24-13"><a href="visualización-de-la-distribución.html#cb24-13" tabindex="-1"></a>dipodium2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Data/dipodium2.csv&quot;</span>)</span></code></pre></div>
<pre><code>## New names:
## Rows: 62 Columns: 5
## ── Column specification
## ──────────────────────────────────────────────────────── Delimiter: &quot;,&quot; dbl
## (5): ...1, PropFR, Number_of_Flowers, Height_Inflo, Distance
## ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
## Specify the column types or set `show_col_types = FALSE` to quiet this message.
## • `` -&gt; `...1`</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="visualización-de-la-distribución.html#cb26-1" tabindex="-1"></a>modelpropFr<span class="ot">=</span><span class="fu">betareg</span>(PropFR<span class="sc">~</span>Number_of_Flowers<span class="sc">+</span>Height_Inflo<span class="sc">+</span>Distance, <span class="at">data =</span><span class="fu">na.omit</span>(dipodium2))</span>
<span id="cb26-2"><a href="visualización-de-la-distribución.html#cb26-2" tabindex="-1"></a><span class="fu">summary</span>(modelpropFr)</span></code></pre></div>
<pre><code>## 
## Call:
## betareg(formula = PropFR ~ Number_of_Flowers + Height_Inflo + Distance, 
##     data = na.omit(dipodium2))
## 
## Quantile residuals:
##     Min      1Q  Median      3Q     Max 
## -2.5667 -0.5097  0.0825  0.9165  1.7887 
## 
## Coefficients (mean model with logit link):
##                    Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)       -3.796016   0.727139  -5.220 1.78e-07 ***
## Number_of_Flowers  0.076200   0.028247   2.698  0.00698 ** 
## Height_Inflo       0.006054   0.017847   0.339  0.73444    
## Distance          -0.111010   0.093825  -1.183  0.23674    
## 
## Phi coefficients (precision model with identity link):
##       Estimate Std. Error z value Pr(&gt;|z|)    
## (phi)   4.8382     0.9982   4.847 1.25e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Type of estimator: ML (maximum likelihood)
## Log-likelihood: 113.9 on 5 Df
## Pseudo R-squared: 0.2757
## Number of iterations: 19 (BFGS) + 2 (Fisher scoring)</code></pre>
<hr />
</div>
<div id="visualizar-un-gráfico-de-regresión-beta" class="section level2 hasAnchor" number="18.2">
<h2><span class="header-section-number">18.2</span> Visualizar un gráfico de regresión beta<a href="visualización-de-la-distribución.html#visualizar-un-gráfico-de-regresión-beta" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="visualización-de-la-distribución.html#cb28-1" tabindex="-1"></a>dipodiumbeta<span class="ot">=</span>dipodium2[,<span class="fu">c</span>(<span class="st">&quot;Number_of_Flowers&quot;</span>,<span class="st">&quot;PropFR&quot;</span>)] <span class="co"># crear un df con solamente las columnas de interes </span></span>
<span id="cb28-2"><a href="visualización-de-la-distribución.html#cb28-2" tabindex="-1"></a></span>
<span id="cb28-3"><a href="visualización-de-la-distribución.html#cb28-3" tabindex="-1"></a> dp2<span class="ot">=</span>dipodiumbeta[<span class="fu">complete.cases</span>(dipodiumbeta),] <span class="co"># remover los &quot;NA&quot; </span></span>
<span id="cb28-4"><a href="visualización-de-la-distribución.html#cb28-4" tabindex="-1"></a> </span>
<span id="cb28-5"><a href="visualización-de-la-distribución.html#cb28-5" tabindex="-1"></a>modelpropFr<span class="ot">=</span><span class="fu">betareg</span>(PropFR<span class="sc">~</span>Number_of_Flowers, <span class="at">data=</span>dp2) <span class="co"># El modelo con solamente la explicativa</span></span>
<span id="cb28-6"><a href="visualización-de-la-distribución.html#cb28-6" tabindex="-1"></a><span class="fu">summary</span>(modelpropFr)</span></code></pre></div>
<pre><code>## 
## Call:
## betareg(formula = PropFR ~ Number_of_Flowers, data = dp2)
## 
## Quantile residuals:
##     Min      1Q  Median      3Q     Max 
## -2.3537 -0.4533  0.0723  0.8698  1.9507 
## 
## Coefficients (mean model with logit link):
##                   Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)       -3.88360    0.44251  -8.776  &lt; 2e-16 ***
## Number_of_Flowers  0.08259    0.01803   4.581 4.62e-06 ***
## 
## Phi coefficients (precision model with identity link):
##       Estimate Std. Error z value Pr(&gt;|z|)    
## (phi)   4.6947     0.9699    4.84  1.3e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Type of estimator: ML (maximum likelihood)
## Log-likelihood: 112.9 on 3 Df
## Pseudo R-squared: 0.2538
## Number of iterations: 18 (BFGS) + 1 (Fisher scoring)</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="visualización-de-la-distribución.html#cb30-1" tabindex="-1"></a> <span class="co">#head(dp2)</span></span>
<span id="cb30-2"><a href="visualización-de-la-distribución.html#cb30-2" tabindex="-1"></a><span class="co">#dp2$PropFR</span></span>
<span id="cb30-3"><a href="visualización-de-la-distribución.html#cb30-3" tabindex="-1"></a><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="co"># calcular los valores estimados (predichos)</span></span></code></pre></div>
<pre><code>##          1          2          3          4          5          6          7 
## 0.02568523 0.02783519 0.03015954 0.04856508 0.05679268 0.05679268 0.05679268 
##          8          9         10         11         12         13         14 
## 0.06138242 0.06138242 0.06138242 0.06138242 0.06138242 0.06138242 0.06631700 
##         15         16         17         18         19         20         21 
## 0.06631700 0.07161801 0.07161801 0.07161801 0.07161801 0.07730766 0.07730766 
##         22         23         24         25         26         27         28 
## 0.07730766 0.08340872 0.08340872 0.08994433 0.08994433 0.08994433 0.08994433 
##         29         30         31         32         33         34         35 
## 0.09693789 0.10441284 0.10441284 0.10441284 0.10441284 0.10441284 0.11239245 
##         36         37         38         39         40         41         42 
## 0.11239245 0.12089957 0.12089957 0.12089957 0.12089957 0.12089957 0.12089957 
##         43         44         45         46         47         48         49 
## 0.12995632 0.12995632 0.12995632 0.12995632 0.12995632 0.13958381 0.14980172 
##         50         51         52         53         54         55         56 
## 0.14980172 0.14980172 0.17207828 0.17207828 0.17207828 0.17207828 0.19690033 
##         57         58         59         60         61         62 
## 0.19690033 0.22433274 0.22433274 0.23903102 0.27035714 0.28695536</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="visualización-de-la-distribución.html#cb32-1" tabindex="-1"></a>dp2<span class="sc">$</span>response<span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb32-2"><a href="visualización-de-la-distribución.html#cb32-2" tabindex="-1"></a><span class="co">#dp2$link=predict(modelpropFr, type = &quot;link&quot;)</span></span>
<span id="cb32-3"><a href="visualización-de-la-distribución.html#cb32-3" tabindex="-1"></a>dp2<span class="sc">$</span>precision<span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;precision&quot;</span>)</span>
<span id="cb32-4"><a href="visualización-de-la-distribución.html#cb32-4" tabindex="-1"></a>dp2<span class="sc">$</span>variance<span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;variance&quot;</span>)</span>
<span id="cb32-5"><a href="visualización-de-la-distribución.html#cb32-5" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.01</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.01</span>))</span>
<span id="cb32-6"><a href="visualización-de-la-distribución.html#cb32-6" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.05</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.05</span>))</span>
<span id="cb32-7"><a href="visualización-de-la-distribución.html#cb32-7" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.10</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.10</span>))</span>
<span id="cb32-8"><a href="visualización-de-la-distribución.html#cb32-8" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.15</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.15</span>))</span>
<span id="cb32-9"><a href="visualización-de-la-distribución.html#cb32-9" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.20</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.20</span>))</span>
<span id="cb32-10"><a href="visualización-de-la-distribución.html#cb32-10" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.25</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.25</span>))</span>
<span id="cb32-11"><a href="visualización-de-la-distribución.html#cb32-11" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.30</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.30</span>))</span>
<span id="cb32-12"><a href="visualización-de-la-distribución.html#cb32-12" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.35</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.35</span>))</span>
<span id="cb32-13"><a href="visualización-de-la-distribución.html#cb32-13" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.40</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.40</span>))</span>
<span id="cb32-14"><a href="visualización-de-la-distribución.html#cb32-14" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.45</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.45</span>))</span>
<span id="cb32-15"><a href="visualización-de-la-distribución.html#cb32-15" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.50</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.50</span>))</span>
<span id="cb32-16"><a href="visualización-de-la-distribución.html#cb32-16" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.55</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.55</span>))</span>
<span id="cb32-17"><a href="visualización-de-la-distribución.html#cb32-17" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.60</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.60</span>))</span>
<span id="cb32-18"><a href="visualización-de-la-distribución.html#cb32-18" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.65</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.65</span>))</span>
<span id="cb32-19"><a href="visualización-de-la-distribución.html#cb32-19" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.70</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.70</span>))</span>
<span id="cb32-20"><a href="visualización-de-la-distribución.html#cb32-20" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.75</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.75</span>))</span>
<span id="cb32-21"><a href="visualización-de-la-distribución.html#cb32-21" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.80</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.80</span>))</span>
<span id="cb32-22"><a href="visualización-de-la-distribución.html#cb32-22" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.85</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.85</span>))</span>
<span id="cb32-23"><a href="visualización-de-la-distribución.html#cb32-23" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.90</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.90</span>))</span>
<span id="cb32-24"><a href="visualización-de-la-distribución.html#cb32-24" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.95</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.95</span>))</span>
<span id="cb32-25"><a href="visualización-de-la-distribución.html#cb32-25" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.99</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.99</span>))</span>
<span id="cb32-26"><a href="visualización-de-la-distribución.html#cb32-26" tabindex="-1"></a>dp2</span></code></pre></div>
<pre><code>## # A tibble: 62 × 26
##    Number_of_Flowers PropFR response precision variance quantile_.01
##                &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;
##  1                 3 0.0001   0.0257      4.69  0.00439     3.86e-18
##  2                 4 0.0001   0.0278      4.69  0.00475     7.44e-17
##  3                 5 0.0001   0.0302      4.69  0.00514     1.14e-15
##  4                11 0.0001   0.0486      4.69  0.00811     2.75e-10
##  5                13 0.0358   0.0568      4.69  0.00941     5.29e- 9
##  6                13 0.0938   0.0568      4.69  0.00941     5.29e- 9
##  7                13 0.0001   0.0568      4.69  0.00941     5.29e- 9
##  8                14 0.0001   0.0614      4.69  0.0101      1.96e- 8
##  9                14 0.364    0.0614      4.69  0.0101      1.96e- 8
## 10                14 0.105    0.0614      4.69  0.0101      1.96e- 8
## # ℹ 52 more rows
## # ℹ 20 more variables: quantile_.05 &lt;dbl&gt;, quantile_.10 &lt;dbl&gt;,
## #   quantile_.15 &lt;dbl&gt;, quantile_.20 &lt;dbl&gt;, quantile_.25 &lt;dbl&gt;,
## #   quantile_.30 &lt;dbl&gt;, quantile_.35 &lt;dbl&gt;, quantile_.40 &lt;dbl&gt;,
## #   quantile_.45 &lt;dbl&gt;, quantile_.50 &lt;dbl&gt;, quantile_.55 &lt;dbl&gt;,
## #   quantile_.60 &lt;dbl&gt;, quantile_.65 &lt;dbl&gt;, quantile_.70 &lt;dbl&gt;,
## #   quantile_.75 &lt;dbl&gt;, quantile_.80 &lt;dbl&gt;, quantile_.85 &lt;dbl&gt;, …</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="visualización-de-la-distribución.html#cb34-1" tabindex="-1"></a><span class="co">#modelpropFr$precision</span></span>
<span id="cb34-2"><a href="visualización-de-la-distribución.html#cb34-2" tabindex="-1"></a></span>
<span id="cb34-3"><a href="visualización-de-la-distribución.html#cb34-3" tabindex="-1"></a><span class="co">#quantile_many=predict(modelpropFr, type = &quot;quantile&quot;, at=c(.99))</span></span>
<span id="cb34-4"><a href="visualización-de-la-distribución.html#cb34-4" tabindex="-1"></a><span class="co">#quantile_many</span></span></code></pre></div>
<p>Al construir la figura para la regresión beta, una de las principales ventajas de utilizar este enfoque es que los cuartiles se calcula con una distribución beta. Por lo tanto, el margen de error NO baja de 0 y NO pasa de 1.</p>
<p>Evalua la siguiente figura en cada x hay una distribución beta, donde la linea roja representa una mediana, las lineas verdes son los cuartiles 25 y 75 y las lineas azules las percentilas 5 y 95. NOTA que la distribución no es simétrica, y cambia a travez de la regresión.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="visualización-de-la-distribución.html#cb35-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb35-2"><a href="visualización-de-la-distribución.html#cb35-2" tabindex="-1"></a><span class="fu">ggplot</span>(dp2, <span class="fu">aes</span>(<span class="at">x=</span>Number_of_Flowers, <span class="at">y=</span>PropFR))<span class="sc">+</span></span>
<span id="cb35-3"><a href="visualización-de-la-distribución.html#cb35-3" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb35-4"><a href="visualización-de-la-distribución.html#cb35-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>quantile_<span class="fl">.05</span>), <span class="at">linetype=</span><span class="st">&quot;twodash&quot;</span>, <span class="at">colour=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-5"><a href="visualización-de-la-distribución.html#cb35-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>quantile_<span class="fl">.25</span>),<span class="at">linetype=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">&quot;green&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-6"><a href="visualización-de-la-distribución.html#cb35-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>quantile_<span class="fl">.50</span>), <span class="at">colour=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-7"><a href="visualización-de-la-distribución.html#cb35-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>quantile_<span class="fl">.75</span>), <span class="at">linetype=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">&quot;green&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-8"><a href="visualización-de-la-distribución.html#cb35-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>quantile_<span class="fl">.95</span>), <span class="at">linetype=</span><span class="st">&quot;twodash&quot;</span>, <span class="at">colour=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-9"><a href="visualización-de-la-distribución.html#cb35-9" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Predicción de la proporción de frutos&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-10"><a href="visualización-de-la-distribución.html#cb35-10" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Números de Flores&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-11"><a href="visualización-de-la-distribución.html#cb35-11" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">25</span>, <span class="at">y=</span><span class="fl">0.50</span>, <span class="at">label=</span><span class="st">&quot;95th quartile&quot;</span>, <span class="at">fontface=</span><span class="st">&quot;italic&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-12"><a href="visualización-de-la-distribución.html#cb35-12" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">32</span>, <span class="at">y=</span><span class="fl">0.39</span>, <span class="at">label=</span><span class="st">&quot;75th quartile&quot;</span>, <span class="at">fontface=</span><span class="st">&quot;italic&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-13"><a href="visualización-de-la-distribución.html#cb35-13" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">33</span>, <span class="at">y=</span><span class="fl">0.14</span>, <span class="at">label=</span><span class="st">&quot;25th quartile&quot;</span>, <span class="at">fontface=</span><span class="st">&quot;italic&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-14"><a href="visualización-de-la-distribución.html#cb35-14" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">33</span>, <span class="at">y=</span><span class="fl">0.27</span>, <span class="at">label=</span><span class="st">&quot;Median&quot;</span>, <span class="at">fontface=</span><span class="st">&quot;italic&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-15"><a href="visualización-de-la-distribución.html#cb35-15" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">35</span>, <span class="at">y=</span><span class="sc">-</span><span class="fl">0.02</span>, <span class="at">label=</span><span class="st">&quot;5th quartile&quot;</span>, <span class="at">fontface=</span><span class="st">&quot;italic&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-16"><a href="visualización-de-la-distribución.html#cb35-16" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;grey20&quot;</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb35-17"><a href="visualización-de-la-distribución.html#cb35-17" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;grey20&quot;</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb35-18"><a href="visualización-de-la-distribución.html#cb35-18" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;grey20&quot;</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">face=</span><span class="st">&quot;bold&quot;</span>), </span>
<span id="cb35-19"><a href="visualización-de-la-distribución.html#cb35-19" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;grey20&quot;</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">face=</span><span class="st">&quot;bold&quot;</span>))<span class="sc">+</span></span>
<span id="cb35-20"><a href="visualización-de-la-distribución.html#cb35-20" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-21"><a href="visualización-de-la-distribución.html#cb35-21" tabindex="-1"></a>  rlt_theme</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/beta%20reg%20graph-1.png" width="672" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="visualización-de-la-distribución.html#cb36-1" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Figures/Beta_number_flowers.png&quot;</span>)</span></code></pre></div>
<pre><code>## Saving 7 x 5 in image</code></pre>
<p>Esto es una representación de las distribuciones beta en las x, número de flores. En rojo simulamos la distribución de la proporción esperada de frutos en plantas que tienen 15 flores y en la linea azul simulamos la distribución esperada de la proporción de frutos en plantas con 30 flores.</p>
<hr />
</div>
<div id="comparar-el-modelo-tradicional-lineal-versus-un-modelo-beta" class="section level2 hasAnchor" number="18.3">
<h2><span class="header-section-number">18.3</span> Comparar el modelo tradicional lineal versus un modelo beta<a href="visualización-de-la-distribución.html#comparar-el-modelo-tradicional-lineal-versus-un-modelo-beta" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Para comparar efectivadad de los modelos usamos el Akaike Information Criterion (AIC). En un acercmiento de selección modelo se acepta como mejor modelo el indice de AIC más pequeño, que representa el modelo meas parsimonio. Una diferencia de AIC DE 4 es significativo. Nota que el modelo beta es mucho mejor (AIC = -219) que el modelo de regresión lineal (AIC = -102)</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="visualización-de-la-distribución.html#cb38-1" tabindex="-1"></a><span class="co">#AIC(modelpropFr) # modelo beta</span></span>
<span id="cb38-2"><a href="visualización-de-la-distribución.html#cb38-2" tabindex="-1"></a></span>
<span id="cb38-3"><a href="visualización-de-la-distribución.html#cb38-3" tabindex="-1"></a></span>
<span id="cb38-4"><a href="visualización-de-la-distribución.html#cb38-4" tabindex="-1"></a>modelpropFr_lm<span class="ot">=</span><span class="fu">lm</span>(PropFR<span class="sc">~</span>Number_of_Flowers, <span class="at">data=</span>dp2)</span>
<span id="cb38-5"><a href="visualización-de-la-distribución.html#cb38-5" tabindex="-1"></a></span>
<span id="cb38-6"><a href="visualización-de-la-distribución.html#cb38-6" tabindex="-1"></a><span class="fu">AIC</span>(modelpropFr,modelpropFr_lm)</span></code></pre></div>
<pre><code>##                df       AIC
## modelpropFr     3 -219.8470
## modelpropFr_lm  3 -102.3526</code></pre>
<hr />
</div>
<div id="distribución-de-valores-especificos" class="section level2 hasAnchor" number="18.4">
<h2><span class="header-section-number">18.4</span> Distribución de valores especificos<a href="visualización-de-la-distribución.html#distribución-de-valores-especificos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Evaluando la distribución de beta para valores específicos de x= Proporción de frutos por plantas basado en la cantidad de flores en la planta.</p>
<p>Seleccionar los diferentes valores de <strong>x</strong> y calcular el promedio y la varianza y convertir estos en <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span>. Con estos parámetros se puede construir la densidad de la distribución por cada valor de x.</p>
<p>Se seleccionan valores específicos para la visualizar la distribución, las plantas que tienen 25, 30 y 35 flores. Se tiene que reorganizar los datos para calcular el promedio y la varianza.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="visualización-de-la-distribución.html#cb40-1" tabindex="-1"></a>dpQ<span class="ot">=</span>dp2 <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="visualización-de-la-distribución.html#cb40-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span><span class="sc">:</span><span class="dv">26</span>))</span>
<span id="cb40-3"><a href="visualización-de-la-distribución.html#cb40-3" tabindex="-1"></a></span>
<span id="cb40-4"><a href="visualización-de-la-distribución.html#cb40-4" tabindex="-1"></a>dpQ2<span class="ot">=</span>dpQ<span class="sc">%&gt;%</span> </span>
<span id="cb40-5"><a href="visualización-de-la-distribución.html#cb40-5" tabindex="-1"></a>  <span class="fu">filter</span>(Number_of_Flowers<span class="sc">==</span> <span class="dv">35</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">22</span>))<span class="sc">%&gt;%</span> t <span class="sc">%&gt;%</span> as.data.frame</span>
<span id="cb40-6"><a href="visualización-de-la-distribución.html#cb40-6" tabindex="-1"></a>dpQ2<span class="sc">$</span>Quartiles<span class="ot">=</span><span class="fu">c</span>(.<span class="dv">01</span>, <span class="fl">0.05</span>, .<span class="dv">1</span>, .<span class="dv">15</span>, .<span class="dv">2</span>, .<span class="dv">25</span>, .<span class="dv">30</span>, .<span class="dv">35</span>, .<span class="dv">4</span>, .<span class="dv">45</span>, .<span class="dv">5</span>, .<span class="dv">55</span>, .<span class="dv">6</span>, .<span class="dv">65</span>,  .<span class="dv">7</span>,.<span class="dv">75</span>, .<span class="dv">8</span>, .<span class="dv">85</span>, .<span class="dv">9</span>, .<span class="dv">95</span>, .<span class="dv">99</span> )</span>
<span id="cb40-7"><a href="visualización-de-la-distribución.html#cb40-7" tabindex="-1"></a></span>
<span id="cb40-8"><a href="visualización-de-la-distribución.html#cb40-8" tabindex="-1"></a><span class="fu">mean</span>(dpQ2<span class="sc">$</span>V1, <span class="at">na.rm=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.2757771</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="visualización-de-la-distribución.html#cb42-1" tabindex="-1"></a><span class="fu">var</span>(dpQ2<span class="sc">$</span>V1, <span class="at">na.rm=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.04226223</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="visualización-de-la-distribución.html#cb44-1" tabindex="-1"></a><span class="co">#dpQ2</span></span>
<span id="cb44-2"><a href="visualización-de-la-distribución.html#cb44-2" tabindex="-1"></a></span>
<span id="cb44-3"><a href="visualización-de-la-distribución.html#cb44-3" tabindex="-1"></a></span>
<span id="cb44-4"><a href="visualización-de-la-distribución.html#cb44-4" tabindex="-1"></a><span class="fu">ggplot</span>(dpQ2, <span class="fu">aes</span>(Quartiles, V1))<span class="sc">+</span></span>
<span id="cb44-5"><a href="visualización-de-la-distribución.html#cb44-5" tabindex="-1"></a> <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Usando la varianza calculada en el chunk anterior, se puede calcular el <span class="math inline">\(\alpha\)</span> y el <span class="math inline">\(\beta\)</span>.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="visualización-de-la-distribución.html#cb45-1" tabindex="-1"></a>estBetaParams <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, var) {</span>
<span id="cb45-2"><a href="visualización-de-la-distribución.html#cb45-2" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> ((<span class="dv">1</span> <span class="sc">-</span> mu) <span class="sc">/</span> var <span class="sc">-</span> <span class="dv">1</span> <span class="sc">/</span> mu) <span class="sc">*</span> mu <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb45-3"><a href="visualización-de-la-distribución.html#cb45-3" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> alpha <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> mu <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb45-4"><a href="visualización-de-la-distribución.html#cb45-4" tabindex="-1"></a>  <span class="fu">return</span>(<span class="at">params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> alpha, <span class="at">beta =</span> beta))</span>
<span id="cb45-5"><a href="visualización-de-la-distribución.html#cb45-5" tabindex="-1"></a>}</span>
<span id="cb45-6"><a href="visualización-de-la-distribución.html#cb45-6" tabindex="-1"></a><span class="co">#mean(Smokers$Y2000P)</span></span>
<span id="cb45-7"><a href="visualización-de-la-distribución.html#cb45-7" tabindex="-1"></a><span class="co">#var(Smokers$Y2000P)</span></span>
<span id="cb45-8"><a href="visualización-de-la-distribución.html#cb45-8" tabindex="-1"></a><span class="fu">estBetaParams</span>(<span class="fl">0.2757771</span>,<span class="fl">0.04226223</span>)</span></code></pre></div>
<pre><code>## $alpha
## [1] 1.027498
## 
## $beta
## [1] 2.698331</code></pre>
<hr />
<p>Producción de los gráficos. Se observa que para las plantas que tienen 25 y 30 flores la densidad esta sesgada a la izquierda, en otra palabra la probabilidad de tener pocas frutos domina la distribuciones.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="visualización-de-la-distribución.html#cb47-1" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;gridExtra&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     combine</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="visualización-de-la-distribución.html#cb50-1" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">ggplot</span>(dipodium2, <span class="fu">aes</span>(PropFR))<span class="sc">+</span></span>
<span id="cb50-2"><a href="visualización-de-la-distribución.html#cb50-2" tabindex="-1"></a><span class="fu">stat_function</span>(<span class="fu">aes</span>(<span class="at">x =</span> dipodium2<span class="sc">$</span>PropFR, <span class="at">y =</span> ..y..), <span class="at">fun =</span> dbeta, <span class="at">colour=</span><span class="st">&quot;red&quot;</span>, <span class="at">n =</span> <span class="dv">62</span>,</span>
<span id="cb50-3"><a href="visualización-de-la-distribución.html#cb50-3" tabindex="-1"></a>                      <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span><span class="fl">0.5418068</span>, <span class="at">shape2 =</span><span class="fl">3.135593</span>))<span class="sc">+</span></span>
<span id="cb50-4"><a href="visualización-de-la-distribución.html#cb50-4" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Beta </span><span class="sc">\n</span><span class="st">Density&quot;</span>)<span class="sc">+</span></span>
<span id="cb50-5"><a href="visualización-de-la-distribución.html#cb50-5" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Probabilidad de tener frutos&quot;</span>)<span class="sc">+</span></span>
<span id="cb50-6"><a href="visualización-de-la-distribución.html#cb50-6" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>))<span class="sc">+</span></span>
<span id="cb50-7"><a href="visualización-de-la-distribución.html#cb50-7" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Densidad beta para plantas con 25 flores&quot;</span>)</span>
<span id="cb50-8"><a href="visualización-de-la-distribución.html#cb50-8" tabindex="-1"></a></span>
<span id="cb50-9"><a href="visualización-de-la-distribución.html#cb50-9" tabindex="-1"></a>b<span class="ot">=</span><span class="fu">ggplot</span>(dipodium2, <span class="fu">aes</span>(PropFR))<span class="sc">+</span></span>
<span id="cb50-10"><a href="visualización-de-la-distribución.html#cb50-10" tabindex="-1"></a><span class="fu">stat_function</span>(<span class="fu">aes</span>(<span class="at">x =</span> dipodium2<span class="sc">$</span>PropFR, <span class="at">y =</span> ..y..), <span class="at">fun =</span> dbeta, <span class="at">colour=</span><span class="st">&quot;blue&quot;</span>, <span class="at">n =</span> <span class="dv">62</span>,</span>
<span id="cb50-11"><a href="visualización-de-la-distribución.html#cb50-11" tabindex="-1"></a>                      <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="fl">0.7549048</span>, <span class="at">shape2 =</span><span class="fl">2.949404</span>))<span class="sc">+</span></span>
<span id="cb50-12"><a href="visualización-de-la-distribución.html#cb50-12" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Beta </span><span class="sc">\n</span><span class="st">Density&quot;</span>)<span class="sc">+</span></span>
<span id="cb50-13"><a href="visualización-de-la-distribución.html#cb50-13" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Probabilidad de tener frutos&quot;</span>)<span class="sc">+</span></span>
<span id="cb50-14"><a href="visualización-de-la-distribución.html#cb50-14" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>))<span class="sc">+</span></span>
<span id="cb50-15"><a href="visualización-de-la-distribución.html#cb50-15" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Densidad beta para plantas con 30 flores&quot;</span>)</span>
<span id="cb50-16"><a href="visualización-de-la-distribución.html#cb50-16" tabindex="-1"></a></span>
<span id="cb50-17"><a href="visualización-de-la-distribución.html#cb50-17" tabindex="-1"></a>c<span class="ot">=</span><span class="fu">ggplot</span>(dipodium2, <span class="fu">aes</span>(PropFR))<span class="sc">+</span></span>
<span id="cb50-18"><a href="visualización-de-la-distribución.html#cb50-18" tabindex="-1"></a><span class="fu">stat_function</span>(<span class="fu">aes</span>(<span class="at">x =</span> dipodium2<span class="sc">$</span>PropFR, <span class="at">y =</span> ..y..), <span class="at">fun =</span> dbeta, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">n =</span> <span class="dv">62</span>,</span>
<span id="cb50-19"><a href="visualización-de-la-distribución.html#cb50-19" tabindex="-1"></a>                      <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="fl">1.027498</span>, <span class="at">shape2 =</span><span class="fl">2.698331</span>))<span class="sc">+</span></span>
<span id="cb50-20"><a href="visualización-de-la-distribución.html#cb50-20" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Beta </span><span class="sc">\n</span><span class="st">Density&quot;</span>)<span class="sc">+</span></span>
<span id="cb50-21"><a href="visualización-de-la-distribución.html#cb50-21" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Probabilidad de tener frutos&quot;</span>)<span class="sc">+</span></span>
<span id="cb50-22"><a href="visualización-de-la-distribución.html#cb50-22" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.10</span>))<span class="sc">+</span></span>
<span id="cb50-23"><a href="visualización-de-la-distribución.html#cb50-23" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Densidad beta para plantas con 35 flores&quot;</span>)</span>
<span id="cb50-24"><a href="visualización-de-la-distribución.html#cb50-24" tabindex="-1"></a></span>
<span id="cb50-25"><a href="visualización-de-la-distribución.html#cb50-25" tabindex="-1"></a>tresDensidad<span class="ot">=</span><span class="fu">grid.arrange</span>(a,b,c, <span class="at">ncol=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="visualización-de-la-distribución.html#cb51-1" tabindex="-1"></a>tresDensidad</span></code></pre></div>
<pre><code>## TableGrob (3 x 1) &quot;arrange&quot;: 3 grobs
##   z     cells    name           grob
## 1 1 (1-1,1-1) arrange gtable[layout]
## 2 2 (2-2,1-1) arrange gtable[layout]
## 3 3 (3-3,1-1) arrange gtable[layout]</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="visualización-de-la-distribución.html#cb53-1" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Figures/tresDensidad.png&quot;</span>)</span></code></pre></div>
<pre><code>## Saving 7 x 5 in image</code></pre>
<p>Un segundo ejemplo</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="visualización-de-la-distribución.html#cb55-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;StressAnxiety&quot;</span>, <span class="at">package =</span> <span class="st">&quot;betareg&quot;</span>)</span>
<span id="cb55-2"><a href="visualización-de-la-distribución.html#cb55-2" tabindex="-1"></a>StressAnxiety <span class="ot">&lt;-</span> StressAnxiety[<span class="fu">order</span>(StressAnxiety<span class="sc">$</span>stress),]</span>
<span id="cb55-3"><a href="visualización-de-la-distribución.html#cb55-3" tabindex="-1"></a></span>
<span id="cb55-4"><a href="visualización-de-la-distribución.html#cb55-4" tabindex="-1"></a><span class="do">## Smithson &amp; Verkuilen (2006, Table 4)</span></span>
<span id="cb55-5"><a href="visualización-de-la-distribución.html#cb55-5" tabindex="-1"></a>sa_null <span class="ot">&lt;-</span> <span class="fu">betareg</span>(anxiety <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> <span class="dv">1</span>,</span>
<span id="cb55-6"><a href="visualización-de-la-distribución.html#cb55-6" tabindex="-1"></a>  <span class="at">data =</span> StressAnxiety, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-7"><a href="visualización-de-la-distribución.html#cb55-7" tabindex="-1"></a>sa_stress <span class="ot">&lt;-</span> <span class="fu">betareg</span>(anxiety <span class="sc">~</span> stress <span class="sc">|</span> stress,</span>
<span id="cb55-8"><a href="visualización-de-la-distribución.html#cb55-8" tabindex="-1"></a>  <span class="at">data =</span> StressAnxiety, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-9"><a href="visualización-de-la-distribución.html#cb55-9" tabindex="-1"></a><span class="fu">summary</span>(sa_null)</span></code></pre></div>
<pre><code>## 
## Call:
## betareg(formula = anxiety ~ 1 | 1, data = StressAnxiety, hessian = TRUE)
## 
## Quantile residuals:
##     Min      1Q  Median      3Q     Max 
## -0.8377 -0.8377 -0.4467  0.6217  3.2396 
## 
## Coefficients (mean model with logit link):
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -2.24396    0.09879  -22.71   &lt;2e-16 ***
## 
## Phi coefficients (precision model with log link):
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    1.796      0.123    14.6   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Type of estimator: ML (maximum likelihood)
## Log-likelihood: 239.4 on 2 Df
## Number of iterations in BFGS optimization: 9</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="visualización-de-la-distribución.html#cb57-1" tabindex="-1"></a><span class="fu">summary</span>(sa_stress)</span></code></pre></div>
<pre><code>## 
## Call:
## betareg(formula = anxiety ~ stress | stress, data = StressAnxiety, hessian = TRUE)
## 
## Quantile residuals:
##     Min      1Q  Median      3Q     Max 
## -2.0119 -0.7953 -0.1833  0.5658  3.1141 
## 
## Coefficients (mean model with logit link):
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -4.0237     0.1442  -27.90   &lt;2e-16 ***
## stress        4.9414     0.4409   11.21   &lt;2e-16 ***
## 
## Phi coefficients (precision model with log link):
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   3.9608     0.2511  15.776  &lt; 2e-16 ***
## stress       -4.2733     0.7532  -5.674  1.4e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Type of estimator: ML (maximum likelihood)
## Log-likelihood:   302 on 4 Df
## Pseudo R-squared: 0.4748
## Number of iterations in BFGS optimization: 16</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="visualización-de-la-distribución.html#cb59-1" tabindex="-1"></a><span class="fu">AIC</span>(sa_null, sa_stress)</span></code></pre></div>
<pre><code>##           df       AIC
## sa_null    2 -474.8960
## sa_stress  4 -595.9202</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="visualización-de-la-distribución.html#cb61-1" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">as.vector</span>(<span class="fu">logLik</span>(sa_null)<span class="sc">/</span><span class="fu">logLik</span>(sa_stress))</span></code></pre></div>
<pre><code>## [1] 0.207021</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="visualización-de-la-distribución.html#cb63-1" tabindex="-1"></a><span class="do">## visualization</span></span>
<span id="cb63-2"><a href="visualización-de-la-distribución.html#cb63-2" tabindex="-1"></a><span class="fu">attach</span>(StressAnxiety)</span>
<span id="cb63-3"><a href="visualización-de-la-distribución.html#cb63-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">jitter</span>(anxiety) <span class="sc">~</span> <span class="fu">jitter</span>(stress),</span>
<span id="cb63-4"><a href="visualización-de-la-distribución.html#cb63-4" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Stress&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Anxiety&quot;</span>,</span>
<span id="cb63-5"><a href="visualización-de-la-distribución.html#cb63-5" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb63-6"><a href="visualización-de-la-distribución.html#cb63-6" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(anxiety <span class="sc">~</span> stress))</span>
<span id="cb63-7"><a href="visualización-de-la-distribución.html#cb63-7" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">fitted</span>(sa_stress) <span class="sc">~</span> stress, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb63-8"><a href="visualización-de-la-distribución.html#cb63-8" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">fitted</span>(<span class="fu">lm</span>(anxiety <span class="sc">~</span> stress)) <span class="sc">~</span> stress, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb63-9"><a href="visualización-de-la-distribución.html#cb63-9" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;lowess&quot;</span>, <span class="st">&quot;betareg&quot;</span>, <span class="st">&quot;lm&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="visualización-de-la-distribución.html#cb64-1" tabindex="-1"></a><span class="fu">detach</span>(StressAnxiety)</span></code></pre></div>
<p>For an excellent new step by step use of the beta regression and why it is usefull see this website.</p>
<p><a href="https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/" class="uri">https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/</a></p>
<blockquote>
<p>“Activities reported in this website was supported by the National Institute of General Medical Sciences of the National Institutes of Health under Award Number R25GM121270. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health.”</p>
</blockquote>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="beta-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="auto-regressive-vectorial-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/RaymondLTremblay/Quantitative_Agricultural_Economics/edit/main/19-Beta_Regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/RaymondLTremblay/Quantitative_Agricultural_Economics/blob/main/19-Beta_Regression.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
